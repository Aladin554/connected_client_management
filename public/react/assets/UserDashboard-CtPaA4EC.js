import{u as j,r as a,j as e,L as y,d as N,i as v}from"./index-Co5bbTuF.js";import{L as w}from"./Loader-DqOQTjZz.js";import{S as C}from"./search-DxjjfhKn.js";import"./createLucideIcon-D0rn2eoO.js";function L(t){return Array.isArray(t)?t:typeof t=="object"&&t!==null&&Array.isArray(t.data)?t.data:[]}function G(){const t=j(),[n,d]=a.useState([]),[o,g]=a.useState(null),[f,c]=a.useState(!0),[x,m]=a.useState(null),[h,b]=a.useState("");a.useEffect(()=>{(async()=>{try{c(!0),m(null);const[r,i]=await Promise.all([N.get("/cities"),v()]);d(L(r.data)),g(i)}catch(r){console.error("Failed to load user dashboard",r),m("Could not load dashboard data. Please refresh the page.")}finally{c(!1)}})()},[]);const l=h.trim().toLowerCase(),u=a.useMemo(()=>l?n.map(s=>{const i=s.name.toLowerCase().includes(l)?s.boards:s.boards.filter(p=>p.name.toLowerCase().includes(l));return{...s,boards:i}}).filter(s=>s.boards.length>0):n,[n,l]);return f?e.jsx(w,{message:"Loading dashboard..."}):e.jsxs("div",{className:"h-screen bg-gray-50/70 flex flex-col text-gray-800",children:[e.jsxs("header",{className:"h-14 bg-white/80 backdrop-blur-sm border-b flex items-center px-4 gap-4 z-10",children:[e.jsx("div",{className:"flex items-center gap-3",children:e.jsx("button",{type:"button",onClick:()=>t("/"),className:"h-7 flex items-center cursor-pointer",title:"Go to home",children:e.jsx("img",{src:"/images/logo/connected_logo.png",alt:"Connected Logo",className:"h-7 w-auto object-contain"})})}),e.jsx("div",{className:"flex-1 flex justify-center px-6",children:e.jsxs("div",{className:"relative w-full max-w-2xl",children:[e.jsx(C,{className:"absolute left-3.5 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{placeholder:"Search boards...",value:h,onChange:s=>b(s.target.value),className:"w-full pl-10 pr-4 py-2 bg-gray-100/70 border rounded-lg focus:bg-white focus:ring-2 focus:ring-blue-200 transition"})]})}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("button",{type:"button",onClick:()=>t("/profile"),className:"h-8 px-3 rounded-full bg-gradient-to-r from-blue-600 to-indigo-600 text-white text-sm font-semibold flex items-center justify-center shadow-sm hover:opacity-95",title:"Edit profile",children:(o==null?void 0:o.first_name)||"User"})})]}),e.jsx("div",{className:"flex flex-1 overflow-hidden",children:e.jsx("main",{className:"flex-1 px-6 md:px-12 py-10 overflow-y-auto",children:e.jsxs("div",{className:"flex flex-col gap-12 max-w-7xl mx-auto",children:[e.jsxs("section",{className:"rounded-2xl border border-gray-200 bg-white px-6 py-5 shadow-sm",children:[e.jsxs("h1",{className:"text-2xl font-extrabold text-gray-900",children:["Hi ",(o==null?void 0:o.first_name)||"User"]}),e.jsx("p",{className:"mt-1 text-sm text-gray-600",children:"Get started below with your designated workspace."})]}),x&&e.jsx("div",{className:"rounded-xl border border-rose-200 bg-rose-50 px-4 py-3 text-sm text-rose-700",children:x}),u.length===0?e.jsxs("div",{className:"text-center py-20 text-gray-600 bg-white rounded-2xl shadow-sm border",children:[e.jsx("p",{className:"text-xl font-semibold mb-3",children:l?"No matching boards found":"No cities available yet"}),e.jsx("p",{className:"text-gray-500",children:l?"Try another board or city name":"Contact your administrator or create your first city"})]}):u.map(s=>e.jsxs("section",{className:"space-y-5",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-green-500 to-teal-600 text-white rounded-lg flex items-center justify-center font-bold text-xl shadow-sm",children:s.name.charAt(0).toUpperCase()}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:s.name}),e.jsxs("p",{className:"text-sm text-gray-500",children:[s.boards.length," board",s.boards.length!==1?"s":""]})]})]})}),s.boards.length>0?e.jsx("div",{className:"grid gap-6",style:{gridTemplateColumns:"repeat(4, minmax(0, 1fr))"},children:s.boards.map(r=>e.jsx(y,{to:`/boards/${r.id}`,children:e.jsx(S,{title:r.name,backgroundGradient:r.background_gradient||null})},r.id))}):e.jsxs("div",{className:"text-center py-16 text-gray-500 bg-gray-50/70 rounded-2xl border border-dashed",children:["No boards created in this city yet",e.jsx("div",{className:"mt-3 text-sm",children:"Ask your admin to add boards"})]})]},s.id))]})})})]})}function S({title:t,backgroundGradient:n}){return e.jsxs("div",{className:"h-40 rounded-2xl overflow-hidden shadow border hover:shadow-lg transition-all duration-200 group bg-white",children:[e.jsx("div",{className:"h-24",style:{background:n||"linear-gradient(135deg, #667eea, #764ba2)"}}),e.jsx("div",{className:"p-4 font-medium text-gray-800 group-hover:text-blue-700 transition-colors",children:t})]})}export{G as default};
