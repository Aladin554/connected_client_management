import{r as n,j as e,i as P,d as y,y as d}from"./index-Co5bbTuF.js";import{c as A}from"./createLucideIcon-D0rn2eoO.js";import{X as S}from"./x-kujMzfW9.js";import{P as k}from"./plus-Do2C2VgG.js";import{S as C}from"./save-CVf5GBF9.js";/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],z=A("shield-check",_),E=l=>{const p=/^(?:(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)\.){3}(?:25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)$/,u=/^[0-9A-Fa-f:]+$/;return p.test(l)||l.includes(":")&&u.test(l)};function q(){const[l,p]=n.useState(null),[u,v]=n.useState(!0),[m,x]=n.useState(!1),[i,c]=n.useState([]),[f,g]=n.useState(""),j=((l==null?void 0:l.role_id)??0)===1;n.useEffect(()=>{(async()=>{var t,o,a;try{const r=await P();if(p(r),r.role_id!==1)return;const h=await y.get("/ip-access/config"),N=Array.isArray((t=h.data)==null?void 0:t.allowed_ips)?h.data.allowed_ips:[];c(N.filter(Boolean))}catch(r){d.error(((a=(o=r==null?void 0:r.response)==null?void 0:o.data)==null?void 0:a.message)||"Failed to load IP access config")}finally{v(!1)}})()},[]);const b=()=>{const s=f.trim();if(s){if(!E(s)){d.error("Please enter a valid IP address");return}c(t=>t.includes(s)?t:[...t,s]),g("")}},I=s=>{c(t=>t.filter(o=>o!==s))},w=async()=>{var s,t,o;if(i.length===0){d.error("At least one IP is required");return}x(!0);try{const a=await y.patch("/ip-access/config",{allowed_ips:i}),r=Array.isArray((s=a.data)==null?void 0:s.allowed_ips)?a.data.allowed_ips:i;c(r),d.success("IP access updated for all roles 2, 3 and 4")}catch(a){d.error(((o=(t=a==null?void 0:a.response)==null?void 0:t.data)==null?void 0:o.message)||"Failed to update IP access")}finally{x(!1)}};return u?e.jsx("div",{className:"p-6 text-gray-500",children:"Loading IP access settings..."}):j?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"rounded-2xl border border-gray-200 bg-white p-5",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-900",children:[e.jsx(z,{size:18}),e.jsx("h1",{className:"text-xl font-semibold",children:"IP Access Control"})]}),e.jsx("p",{className:"mt-1 text-sm text-gray-600",children:"Single global IP allowlist for all users."})]}),e.jsxs("div",{className:"rounded-2xl border border-gray-200 bg-white p-5",children:[e.jsx("label",{className:"mb-2 block text-sm font-medium text-gray-700",children:"Allowed IPs"}),e.jsx("div",{className:"flex flex-wrap items-center gap-2",children:i.map(s=>e.jsxs("span",{className:"inline-flex items-center gap-1 rounded-md bg-blue-50 px-2 py-1 text-xs font-medium text-blue-800",children:[s,e.jsx("button",{type:"button",onClick:()=>I(s),className:"text-blue-700 hover:text-blue-900",children:e.jsx(S,{size:12})})]},s))}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[e.jsx("input",{value:f,onChange:s=>g(s.target.value),onKeyDown:s=>{s.key==="Enter"&&(s.preventDefault(),b())},placeholder:"Add IP address",className:"h-10 min-w-[280px] flex-1 rounded-lg border border-gray-300 px-3 text-sm focus:border-blue-500 focus:outline-none"}),e.jsxs("button",{type:"button",onClick:b,className:"inline-flex h-10 items-center gap-1 rounded-lg border border-gray-300 px-3 text-sm font-medium text-gray-700 hover:bg-gray-50",children:[e.jsx(k,{size:14}),"Add"]}),e.jsxs("button",{type:"button",onClick:()=>void w(),disabled:m,className:"inline-flex h-10 items-center gap-1 rounded-lg bg-blue-600 px-3 text-sm font-medium text-white hover:bg-blue-700 disabled:cursor-not-allowed disabled:opacity-60",children:[e.jsx(C,{size:14}),m?"Saving...":"Save"]})]})]})]}):e.jsx("div",{className:"rounded-xl border border-red-200 bg-red-50 p-6 text-red-700",children:"Only superadmin can manage IP access."})}export{q as default};
