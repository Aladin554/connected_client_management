const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index.es-BVvuPAKE.js","assets/index-BkDEBjE8.js","assets/index-Dc0oyXuo.css","assets/index-CtPPEvZU.js"])))=>i.map(i=>d[i]);
import{r as o,R as X,d as U,j as r,_ as Fr,m as Pr,u as Br,i as Ur}from"./index-BkDEBjE8.js";import{r as Et}from"./index-CtPPEvZU.js";import{L as Vr}from"./Loader-DmWhfnO9.js";import{c as Je}from"./createLucideIcon-3adLFeee.js";import{X as ot}from"./x-DqPZ4nVi.js";import{P as Sn}from"./plus-BGK2cbvf.js";import{S as rr}from"./square-pen-C4tonUcb.js";import{S as Kr}from"./search-kO-FRy60.js";import{L as Wr}from"./layout-grid-CVscFb-y.js";/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xr=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],Bn=Je("activity",Xr);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yr=[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]],sr=Je("archive",Yr);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hr=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],qr=Je("calendar",Hr);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gr=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],Jr=Je("chart-column",Gr);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qr=[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]],Un=Je("credit-card",Qr);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zr=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]],es=Je("ellipsis",Zr);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ts=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],ns=Je("funnel",ts);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rs=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]],ir=Je("message-square",rs);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ss=[["path",{d:"m16 6-8.414 8.586a2 2 0 0 0 2.829 2.829l8.414-8.586a4 4 0 1 0-5.657-5.657l-8.379 8.551a6 6 0 1 0 8.485 8.485l8.379-8.551",key:"1miecu"}]],Vn=Je("paperclip",ss);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const is=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],as=Je("rotate-ccw",is);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const os=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],ls=Je("tag",os);function cs(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return o.useMemo(()=>s=>{t.forEach(a=>a(s))},t)}const sn=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function wt(e){const t=Object.prototype.toString.call(e);return t==="[object Window]"||t==="[object global]"}function En(e){return"nodeType"in e}function ve(e){var t,n;return e?wt(e)?e:En(e)&&(t=(n=e.ownerDocument)==null?void 0:n.defaultView)!=null?t:window:window}function Mn(e){const{Document:t}=ve(e);return e instanceof t}function zt(e){return wt(e)?!1:e instanceof ve(e).HTMLElement}function ar(e){return e instanceof ve(e).SVGElement}function Nt(e){return e?wt(e)?e.document:En(e)?Mn(e)?e:zt(e)||ar(e)?e.ownerDocument:document:document:document}const qe=sn?o.useLayoutEffect:o.useEffect;function an(e){const t=o.useRef(e);return qe(()=>{t.current=e}),o.useCallback(function(){for(var n=arguments.length,s=new Array(n),a=0;a<n;a++)s[a]=arguments[a];return t.current==null?void 0:t.current(...s)},[])}function ds(){const e=o.useRef(null),t=o.useCallback((s,a)=>{e.current=setInterval(s,a)},[]),n=o.useCallback(()=>{e.current!==null&&(clearInterval(e.current),e.current=null)},[]);return[t,n]}function It(e,t){t===void 0&&(t=[e]);const n=o.useRef(e);return qe(()=>{n.current!==e&&(n.current=e)},t),n}function Ft(e,t){const n=o.useRef();return o.useMemo(()=>{const s=e(n.current);return n.current=s,s},[...t])}function Qt(e){const t=an(e),n=o.useRef(null),s=o.useCallback(a=>{a!==n.current&&(t==null||t(a,n.current)),n.current=a},[]);return[n,s]}function Zt(e){const t=o.useRef();return o.useEffect(()=>{t.current=e},[e]),t.current}let vn={};function Pt(e,t){return o.useMemo(()=>{if(t)return t;const n=vn[e]==null?0:vn[e]+1;return vn[e]=n,e+"-"+n},[e,t])}function or(e){return function(t){for(var n=arguments.length,s=new Array(n>1?n-1:0),a=1;a<n;a++)s[a-1]=arguments[a];return s.reduce((l,d)=>{const u=Object.entries(d);for(const[h,m]of u){const g=l[h];g!=null&&(l[h]=g+e*m)}return l},{...t})}}const vt=or(1),en=or(-1);function us(e){return"clientX"in e&&"clientY"in e}function on(e){if(!e)return!1;const{KeyboardEvent:t}=ve(e.target);return t&&e instanceof t}function fs(e){if(!e)return!1;const{TouchEvent:t}=ve(e.target);return t&&e instanceof t}function tn(e){if(fs(e)){if(e.touches&&e.touches.length){const{clientX:t,clientY:n}=e.touches[0];return{x:t,y:n}}else if(e.changedTouches&&e.changedTouches.length){const{clientX:t,clientY:n}=e.changedTouches[0];return{x:t,y:n}}}return us(e)?{x:e.clientX,y:e.clientY}:null}const mt=Object.freeze({Translate:{toString(e){if(!e)return;const{x:t,y:n}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(n?Math.round(n):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;const{scaleX:t,scaleY:n}=e;return"scaleX("+t+") scaleY("+n+")"}},Transform:{toString(e){if(e)return[mt.Translate.toString(e),mt.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:n,easing:s}=e;return t+" "+n+"ms "+s}}}),Kn="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function hs(e){return e.matches(Kn)?e:e.querySelector(Kn)}const ms={display:"none"};function gs(e){let{id:t,value:n}=e;return X.createElement("div",{id:t,style:ms},n)}function xs(e){let{id:t,announcement:n,ariaLiveType:s="assertive"}=e;const a={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return X.createElement("div",{id:t,style:a,role:"status","aria-live":s,"aria-atomic":!0},n)}function ps(){const[e,t]=o.useState("");return{announce:o.useCallback(s=>{s!=null&&t(s)},[]),announcement:e}}const lr=o.createContext(null);function bs(e){const t=o.useContext(lr);o.useEffect(()=>{if(!t)throw new Error("useDndMonitor must be used within a children of <DndContext>");return t(e)},[e,t])}function ys(){const[e]=o.useState(()=>new Set),t=o.useCallback(s=>(e.add(s),()=>e.delete(s)),[e]);return[o.useCallback(s=>{let{type:a,event:l}=s;e.forEach(d=>{var u;return(u=d[a])==null?void 0:u.call(d,l)})},[e]),t]}const vs={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},ws={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was moved over droppable area "+n.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was dropped over droppable area "+n.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function Ns(e){let{announcements:t=ws,container:n,hiddenTextDescribedById:s,screenReaderInstructions:a=vs}=e;const{announce:l,announcement:d}=ps(),u=Pt("DndLiveRegion"),[h,m]=o.useState(!1);if(o.useEffect(()=>{m(!0)},[]),bs(o.useMemo(()=>({onDragStart(p){let{active:N}=p;l(t.onDragStart({active:N}))},onDragMove(p){let{active:N,over:v}=p;t.onDragMove&&l(t.onDragMove({active:N,over:v}))},onDragOver(p){let{active:N,over:v}=p;l(t.onDragOver({active:N,over:v}))},onDragEnd(p){let{active:N,over:v}=p;l(t.onDragEnd({active:N,over:v}))},onDragCancel(p){let{active:N,over:v}=p;l(t.onDragCancel({active:N,over:v}))}}),[l,t])),!h)return null;const g=X.createElement(X.Fragment,null,X.createElement(gs,{id:s,value:a.draggable}),X.createElement(xs,{id:u,announcement:d}));return n?Et.createPortal(g,n):g}var ie;(function(e){e.DragStart="dragStart",e.DragMove="dragMove",e.DragEnd="dragEnd",e.DragCancel="dragCancel",e.DragOver="dragOver",e.RegisterDroppable="registerDroppable",e.SetDroppableDisabled="setDroppableDisabled",e.UnregisterDroppable="unregisterDroppable"})(ie||(ie={}));function nn(){}function js(e,t){return o.useMemo(()=>({sensor:e,options:t??{}}),[e,t])}function Cs(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return o.useMemo(()=>[...t].filter(s=>s!=null),[...t])}const Ge=Object.freeze({x:0,y:0});function Ss(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function ks(e,t){const n=tn(e);if(!n)return"0 0";const s={x:(n.x-t.left)/t.width*100,y:(n.y-t.top)/t.height*100};return s.x+"% "+s.y+"%"}function Ds(e,t){let{data:{value:n}}=e,{data:{value:s}}=t;return n-s}function As(e,t){let{data:{value:n}}=e,{data:{value:s}}=t;return s-n}function _s(e){let{left:t,top:n,height:s,width:a}=e;return[{x:t,y:n},{x:t+a,y:n},{x:t,y:n+s},{x:t+a,y:n+s}]}function Rs(e,t){if(!e||e.length===0)return null;const[n]=e;return n[t]}function Es(e,t){const n=Math.max(t.top,e.top),s=Math.max(t.left,e.left),a=Math.min(t.left+t.width,e.left+e.width),l=Math.min(t.top+t.height,e.top+e.height),d=a-s,u=l-n;if(s<a&&n<l){const h=t.width*t.height,m=e.width*e.height,g=d*u,p=g/(h+m-g);return Number(p.toFixed(4))}return 0}const Ms=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:s}=e;const a=[];for(const l of s){const{id:d}=l,u=n.get(d);if(u){const h=Es(u,t);h>0&&a.push({id:d,data:{droppableContainer:l,value:h}})}}return a.sort(As)};function Ls(e,t){const{top:n,left:s,bottom:a,right:l}=t;return n<=e.y&&e.y<=a&&s<=e.x&&e.x<=l}const Ts=e=>{let{droppableContainers:t,droppableRects:n,pointerCoordinates:s}=e;if(!s)return[];const a=[];for(const l of t){const{id:d}=l,u=n.get(d);if(u&&Ls(s,u)){const m=_s(u).reduce((p,N)=>p+Ss(s,N),0),g=Number((m/4).toFixed(4));a.push({id:d,data:{droppableContainer:l,value:g}})}}return a.sort(Ds)};function $s(e,t,n){return{...e,scaleX:t&&n?t.width/n.width:1,scaleY:t&&n?t.height/n.height:1}}function cr(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:Ge}function Is(e){return function(n){for(var s=arguments.length,a=new Array(s>1?s-1:0),l=1;l<s;l++)a[l-1]=arguments[l];return a.reduce((d,u)=>({...d,top:d.top+e*u.y,bottom:d.bottom+e*u.y,left:d.left+e*u.x,right:d.right+e*u.x}),{...n})}}const Os=Is(1);function dr(e){if(e.startsWith("matrix3d(")){const t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}else if(e.startsWith("matrix(")){const t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}function zs(e,t,n){const s=dr(t);if(!s)return e;const{scaleX:a,scaleY:l,x:d,y:u}=s,h=e.left-d-(1-a)*parseFloat(n),m=e.top-u-(1-l)*parseFloat(n.slice(n.indexOf(" ")+1)),g=a?e.width/a:e.width,p=l?e.height/l:e.height;return{width:g,height:p,top:m,right:h+g,bottom:m+p,left:h}}const Fs={ignoreTransform:!1};function jt(e,t){t===void 0&&(t=Fs);let n=e.getBoundingClientRect();if(t.ignoreTransform){const{transform:m,transformOrigin:g}=ve(e).getComputedStyle(e);m&&(n=zs(n,m,g))}const{top:s,left:a,width:l,height:d,bottom:u,right:h}=n;return{top:s,left:a,width:l,height:d,bottom:u,right:h}}function Wn(e){return jt(e,{ignoreTransform:!0})}function Ps(e){const t=e.innerWidth,n=e.innerHeight;return{top:0,left:0,right:t,bottom:n,width:t,height:n}}function Bs(e,t){return t===void 0&&(t=ve(e).getComputedStyle(e)),t.position==="fixed"}function Us(e,t){t===void 0&&(t=ve(e).getComputedStyle(e));const n=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(a=>{const l=t[a];return typeof l=="string"?n.test(l):!1})}function Ln(e,t){const n=[];function s(a){if(t!=null&&n.length>=t||!a)return n;if(Mn(a)&&a.scrollingElement!=null&&!n.includes(a.scrollingElement))return n.push(a.scrollingElement),n;if(!zt(a)||ar(a)||n.includes(a))return n;const l=ve(e).getComputedStyle(a);return a!==e&&Us(a,l)&&n.push(a),Bs(a,l)?n:s(a.parentNode)}return e?s(e):n}function ur(e){const[t]=Ln(e,1);return t??null}function wn(e){return!sn||!e?null:wt(e)?e:En(e)?Mn(e)||e===Nt(e).scrollingElement?window:zt(e)?e:null:null}function fr(e){return wt(e)?e.scrollX:e.scrollLeft}function hr(e){return wt(e)?e.scrollY:e.scrollTop}function kn(e){return{x:fr(e),y:hr(e)}}var le;(function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"})(le||(le={}));function mr(e){return!sn||!e?!1:e===document.scrollingElement}function gr(e){const t={x:0,y:0},n=mr(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},s={x:e.scrollWidth-n.width,y:e.scrollHeight-n.height},a=e.scrollTop<=t.y,l=e.scrollLeft<=t.x,d=e.scrollTop>=s.y,u=e.scrollLeft>=s.x;return{isTop:a,isLeft:l,isBottom:d,isRight:u,maxScroll:s,minScroll:t}}const Vs={x:.2,y:.2};function Ks(e,t,n,s,a){let{top:l,left:d,right:u,bottom:h}=n;s===void 0&&(s=10),a===void 0&&(a=Vs);const{isTop:m,isBottom:g,isLeft:p,isRight:N}=gr(e),v={x:0,y:0},k={x:0,y:0},j={height:t.height*a.y,width:t.width*a.x};return!m&&l<=t.top+j.height?(v.y=le.Backward,k.y=s*Math.abs((t.top+j.height-l)/j.height)):!g&&h>=t.bottom-j.height&&(v.y=le.Forward,k.y=s*Math.abs((t.bottom-j.height-h)/j.height)),!N&&u>=t.right-j.width?(v.x=le.Forward,k.x=s*Math.abs((t.right-j.width-u)/j.width)):!p&&d<=t.left+j.width&&(v.x=le.Backward,k.x=s*Math.abs((t.left+j.width-d)/j.width)),{direction:v,speed:k}}function Ws(e){if(e===document.scrollingElement){const{innerWidth:l,innerHeight:d}=window;return{top:0,left:0,right:l,bottom:d,width:l,height:d}}const{top:t,left:n,right:s,bottom:a}=e.getBoundingClientRect();return{top:t,left:n,right:s,bottom:a,width:e.clientWidth,height:e.clientHeight}}function xr(e){return e.reduce((t,n)=>vt(t,kn(n)),Ge)}function Xs(e){return e.reduce((t,n)=>t+fr(n),0)}function Ys(e){return e.reduce((t,n)=>t+hr(n),0)}function pr(e,t){if(t===void 0&&(t=jt),!e)return;const{top:n,left:s,bottom:a,right:l}=t(e);ur(e)&&(a<=0||l<=0||n>=window.innerHeight||s>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}const Hs=[["x",["left","right"],Xs],["y",["top","bottom"],Ys]];class Tn{constructor(t,n){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const s=Ln(n),a=xr(s);this.rect={...t},this.width=t.width,this.height=t.height;for(const[l,d,u]of Hs)for(const h of d)Object.defineProperty(this,h,{get:()=>{const m=u(s),g=a[l]-m;return this.rect[h]+g},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class Mt{constructor(t){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(n=>{var s;return(s=this.target)==null?void 0:s.removeEventListener(...n)})},this.target=t}add(t,n,s){var a;(a=this.target)==null||a.addEventListener(t,n,s),this.listeners.push([t,n,s])}}function qs(e){const{EventTarget:t}=ve(e);return e instanceof t?e:Nt(e)}function Nn(e,t){const n=Math.abs(e.x),s=Math.abs(e.y);return typeof t=="number"?Math.sqrt(n**2+s**2)>t:"x"in t&&"y"in t?n>t.x&&s>t.y:"x"in t?n>t.x:"y"in t?s>t.y:!1}var Ve;(function(e){e.Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange"})(Ve||(Ve={}));function Xn(e){e.preventDefault()}function Gs(e){e.stopPropagation()}var z;(function(e){e.Space="Space",e.Down="ArrowDown",e.Right="ArrowRight",e.Left="ArrowLeft",e.Up="ArrowUp",e.Esc="Escape",e.Enter="Enter",e.Tab="Tab"})(z||(z={}));const br={start:[z.Space,z.Enter],cancel:[z.Esc],end:[z.Space,z.Enter,z.Tab]},Js=(e,t)=>{let{currentCoordinates:n}=t;switch(e.code){case z.Right:return{...n,x:n.x+25};case z.Left:return{...n,x:n.x-25};case z.Down:return{...n,y:n.y+25};case z.Up:return{...n,y:n.y-25}}};class yr{constructor(t){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=t;const{event:{target:n}}=t;this.props=t,this.listeners=new Mt(Nt(n)),this.windowListeners=new Mt(ve(n)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(Ve.Resize,this.handleCancel),this.windowListeners.add(Ve.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(Ve.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:t,onStart:n}=this.props,s=t.node.current;s&&pr(s),n(Ge)}handleKeyDown(t){if(on(t)){const{active:n,context:s,options:a}=this.props,{keyboardCodes:l=br,coordinateGetter:d=Js,scrollBehavior:u="smooth"}=a,{code:h}=t;if(l.end.includes(h)){this.handleEnd(t);return}if(l.cancel.includes(h)){this.handleCancel(t);return}const{collisionRect:m}=s.current,g=m?{x:m.left,y:m.top}:Ge;this.referenceCoordinates||(this.referenceCoordinates=g);const p=d(t,{active:n,context:s.current,currentCoordinates:g});if(p){const N=en(p,g),v={x:0,y:0},{scrollableAncestors:k}=s.current;for(const j of k){const C=t.code,{isTop:D,isRight:R,isLeft:_,isBottom:M,maxScroll:L,minScroll:$}=gr(j),S=Ws(j),A={x:Math.min(C===z.Right?S.right-S.width/2:S.right,Math.max(C===z.Right?S.left:S.left+S.width/2,p.x)),y:Math.min(C===z.Down?S.bottom-S.height/2:S.bottom,Math.max(C===z.Down?S.top:S.top+S.height/2,p.y))},O=C===z.Right&&!R||C===z.Left&&!_,V=C===z.Down&&!M||C===z.Up&&!D;if(O&&A.x!==p.x){const T=j.scrollLeft+N.x,re=C===z.Right&&T<=L.x||C===z.Left&&T>=$.x;if(re&&!N.y){j.scrollTo({left:T,behavior:u});return}re?v.x=j.scrollLeft-T:v.x=C===z.Right?j.scrollLeft-L.x:j.scrollLeft-$.x,v.x&&j.scrollBy({left:-v.x,behavior:u});break}else if(V&&A.y!==p.y){const T=j.scrollTop+N.y,re=C===z.Down&&T<=L.y||C===z.Up&&T>=$.y;if(re&&!N.x){j.scrollTo({top:T,behavior:u});return}re?v.y=j.scrollTop-T:v.y=C===z.Down?j.scrollTop-L.y:j.scrollTop-$.y,v.y&&j.scrollBy({top:-v.y,behavior:u});break}}this.handleMove(t,vt(en(p,this.referenceCoordinates),v))}}}handleMove(t,n){const{onMove:s}=this.props;t.preventDefault(),s(n)}handleEnd(t){const{onEnd:n}=this.props;t.preventDefault(),this.detach(),n()}handleCancel(t){const{onCancel:n}=this.props;t.preventDefault(),this.detach(),n()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}yr.activators=[{eventName:"onKeyDown",handler:(e,t,n)=>{let{keyboardCodes:s=br,onActivation:a}=t,{active:l}=n;const{code:d}=e.nativeEvent;if(s.start.includes(d)){const u=l.activatorNode.current;return u&&e.target!==u?!1:(e.preventDefault(),a==null||a({event:e.nativeEvent}),!0)}return!1}}];function Yn(e){return!!(e&&"distance"in e)}function Hn(e){return!!(e&&"delay"in e)}class $n{constructor(t,n,s){var a;s===void 0&&(s=qs(t.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=t,this.events=n;const{event:l}=t,{target:d}=l;this.props=t,this.events=n,this.document=Nt(d),this.documentListeners=new Mt(this.document),this.listeners=new Mt(s),this.windowListeners=new Mt(ve(d)),this.initialCoordinates=(a=tn(l))!=null?a:Ge,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:t,props:{options:{activationConstraint:n,bypassActivationConstraint:s}}}=this;if(this.listeners.add(t.move.name,this.handleMove,{passive:!1}),this.listeners.add(t.end.name,this.handleEnd),t.cancel&&this.listeners.add(t.cancel.name,this.handleCancel),this.windowListeners.add(Ve.Resize,this.handleCancel),this.windowListeners.add(Ve.DragStart,Xn),this.windowListeners.add(Ve.VisibilityChange,this.handleCancel),this.windowListeners.add(Ve.ContextMenu,Xn),this.documentListeners.add(Ve.Keydown,this.handleKeydown),n){if(s!=null&&s({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(Hn(n)){this.timeoutId=setTimeout(this.handleStart,n.delay),this.handlePending(n);return}if(Yn(n)){this.handlePending(n);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(t,n){const{active:s,onPending:a}=this.props;a(s,t,this.initialCoordinates,n)}handleStart(){const{initialCoordinates:t}=this,{onStart:n}=this.props;t&&(this.activated=!0,this.documentListeners.add(Ve.Click,Gs,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(Ve.SelectionChange,this.removeTextSelection),n(t))}handleMove(t){var n;const{activated:s,initialCoordinates:a,props:l}=this,{onMove:d,options:{activationConstraint:u}}=l;if(!a)return;const h=(n=tn(t))!=null?n:Ge,m=en(a,h);if(!s&&u){if(Yn(u)){if(u.tolerance!=null&&Nn(m,u.tolerance))return this.handleCancel();if(Nn(m,u.distance))return this.handleStart()}if(Hn(u)&&Nn(m,u.tolerance))return this.handleCancel();this.handlePending(u,m);return}t.cancelable&&t.preventDefault(),d(h)}handleEnd(){const{onAbort:t,onEnd:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleCancel(){const{onAbort:t,onCancel:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleKeydown(t){t.code===z.Esc&&this.handleCancel()}removeTextSelection(){var t;(t=this.document.getSelection())==null||t.removeAllRanges()}}const Qs={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class In extends $n{constructor(t){const{event:n}=t,s=Nt(n.target);super(t,Qs,s)}}In.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:s}=t;return!n.isPrimary||n.button!==0?!1:(s==null||s({event:n}),!0)}}];const Zs={move:{name:"mousemove"},end:{name:"mouseup"}};var Dn;(function(e){e[e.RightClick=2]="RightClick"})(Dn||(Dn={}));class ei extends $n{constructor(t){super(t,Zs,Nt(t.event.target))}}ei.activators=[{eventName:"onMouseDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:s}=t;return n.button===Dn.RightClick?!1:(s==null||s({event:n}),!0)}}];const jn={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class ti extends $n{constructor(t){super(t,jn)}static setup(){return window.addEventListener(jn.move.name,t,{capture:!1,passive:!1}),function(){window.removeEventListener(jn.move.name,t)};function t(){}}}ti.activators=[{eventName:"onTouchStart",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:s}=t;const{touches:a}=n;return a.length>1?!1:(s==null||s({event:n}),!0)}}];var Lt;(function(e){e[e.Pointer=0]="Pointer",e[e.DraggableRect=1]="DraggableRect"})(Lt||(Lt={}));var rn;(function(e){e[e.TreeOrder=0]="TreeOrder",e[e.ReversedTreeOrder=1]="ReversedTreeOrder"})(rn||(rn={}));function ni(e){let{acceleration:t,activator:n=Lt.Pointer,canScroll:s,draggingRect:a,enabled:l,interval:d=5,order:u=rn.TreeOrder,pointerCoordinates:h,scrollableAncestors:m,scrollableAncestorRects:g,delta:p,threshold:N}=e;const v=si({delta:p,disabled:!l}),[k,j]=ds(),C=o.useRef({x:0,y:0}),D=o.useRef({x:0,y:0}),R=o.useMemo(()=>{switch(n){case Lt.Pointer:return h?{top:h.y,bottom:h.y,left:h.x,right:h.x}:null;case Lt.DraggableRect:return a}},[n,a,h]),_=o.useRef(null),M=o.useCallback(()=>{const $=_.current;if(!$)return;const S=C.current.x*D.current.x,A=C.current.y*D.current.y;$.scrollBy(S,A)},[]),L=o.useMemo(()=>u===rn.TreeOrder?[...m].reverse():m,[u,m]);o.useEffect(()=>{if(!l||!m.length||!R){j();return}for(const $ of L){if((s==null?void 0:s($))===!1)continue;const S=m.indexOf($),A=g[S];if(!A)continue;const{direction:O,speed:V}=Ks($,A,R,t,N);for(const T of["x","y"])v[T][O[T]]||(V[T]=0,O[T]=0);if(V.x>0||V.y>0){j(),_.current=$,k(M,d),C.current=V,D.current=O;return}}C.current={x:0,y:0},D.current={x:0,y:0},j()},[t,M,s,j,l,d,JSON.stringify(R),JSON.stringify(v),k,m,L,g,JSON.stringify(N)])}const ri={x:{[le.Backward]:!1,[le.Forward]:!1},y:{[le.Backward]:!1,[le.Forward]:!1}};function si(e){let{delta:t,disabled:n}=e;const s=Zt(t);return Ft(a=>{if(n||!s||!a)return ri;const l={x:Math.sign(t.x-s.x),y:Math.sign(t.y-s.y)};return{x:{[le.Backward]:a.x[le.Backward]||l.x===-1,[le.Forward]:a.x[le.Forward]||l.x===1},y:{[le.Backward]:a.y[le.Backward]||l.y===-1,[le.Forward]:a.y[le.Forward]||l.y===1}}},[n,t,s])}function ii(e,t){const n=t!=null?e.get(t):void 0,s=n?n.node.current:null;return Ft(a=>{var l;return t==null?null:(l=s??a)!=null?l:null},[s,t])}function ai(e,t){return o.useMemo(()=>e.reduce((n,s)=>{const{sensor:a}=s,l=a.activators.map(d=>({eventName:d.eventName,handler:t(d.handler,s)}));return[...n,...l]},[]),[e,t])}var Ot;(function(e){e[e.Always=0]="Always",e[e.BeforeDragging=1]="BeforeDragging",e[e.WhileDragging=2]="WhileDragging"})(Ot||(Ot={}));var An;(function(e){e.Optimized="optimized"})(An||(An={}));const qn=new Map;function oi(e,t){let{dragging:n,dependencies:s,config:a}=t;const[l,d]=o.useState(null),{frequency:u,measure:h,strategy:m}=a,g=o.useRef(e),p=C(),N=It(p),v=o.useCallback(function(D){D===void 0&&(D=[]),!N.current&&d(R=>R===null?D:R.concat(D.filter(_=>!R.includes(_))))},[N]),k=o.useRef(null),j=Ft(D=>{if(p&&!n)return qn;if(!D||D===qn||g.current!==e||l!=null){const R=new Map;for(let _ of e){if(!_)continue;if(l&&l.length>0&&!l.includes(_.id)&&_.rect.current){R.set(_.id,_.rect.current);continue}const M=_.node.current,L=M?new Tn(h(M),M):null;_.rect.current=L,L&&R.set(_.id,L)}return R}return D},[e,l,n,p,h]);return o.useEffect(()=>{g.current=e},[e]),o.useEffect(()=>{p||v()},[n,p]),o.useEffect(()=>{l&&l.length>0&&d(null)},[JSON.stringify(l)]),o.useEffect(()=>{p||typeof u!="number"||k.current!==null||(k.current=setTimeout(()=>{v(),k.current=null},u))},[u,p,v,...s]),{droppableRects:j,measureDroppableContainers:v,measuringScheduled:l!=null};function C(){switch(m){case Ot.Always:return!1;case Ot.BeforeDragging:return n;default:return!n}}}function On(e,t){return Ft(n=>e?n||(typeof t=="function"?t(e):e):null,[t,e])}function li(e,t){return On(e,t)}function ci(e){let{callback:t,disabled:n}=e;const s=an(t),a=o.useMemo(()=>{if(n||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:l}=window;return new l(s)},[s,n]);return o.useEffect(()=>()=>a==null?void 0:a.disconnect(),[a]),a}function ln(e){let{callback:t,disabled:n}=e;const s=an(t),a=o.useMemo(()=>{if(n||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:l}=window;return new l(s)},[n]);return o.useEffect(()=>()=>a==null?void 0:a.disconnect(),[a]),a}function di(e){return new Tn(jt(e),e)}function Gn(e,t,n){t===void 0&&(t=di);const[s,a]=o.useState(null);function l(){a(h=>{if(!e)return null;if(e.isConnected===!1){var m;return(m=h??n)!=null?m:null}const g=t(e);return JSON.stringify(h)===JSON.stringify(g)?h:g})}const d=ci({callback(h){if(e)for(const m of h){const{type:g,target:p}=m;if(g==="childList"&&p instanceof HTMLElement&&p.contains(e)){l();break}}}}),u=ln({callback:l});return qe(()=>{l(),e?(u==null||u.observe(e),d==null||d.observe(document.body,{childList:!0,subtree:!0})):(u==null||u.disconnect(),d==null||d.disconnect())},[e]),s}function ui(e){const t=On(e);return cr(e,t)}const Jn=[];function fi(e){const t=o.useRef(e),n=Ft(s=>e?s&&s!==Jn&&e&&t.current&&e.parentNode===t.current.parentNode?s:Ln(e):Jn,[e]);return o.useEffect(()=>{t.current=e},[e]),n}function hi(e){const[t,n]=o.useState(null),s=o.useRef(e),a=o.useCallback(l=>{const d=wn(l.target);d&&n(u=>u?(u.set(d,kn(d)),new Map(u)):null)},[]);return o.useEffect(()=>{const l=s.current;if(e!==l){d(l);const u=e.map(h=>{const m=wn(h);return m?(m.addEventListener("scroll",a,{passive:!0}),[m,kn(m)]):null}).filter(h=>h!=null);n(u.length?new Map(u):null),s.current=e}return()=>{d(e),d(l)};function d(u){u.forEach(h=>{const m=wn(h);m==null||m.removeEventListener("scroll",a)})}},[a,e]),o.useMemo(()=>e.length?t?Array.from(t.values()).reduce((l,d)=>vt(l,d),Ge):xr(e):Ge,[e,t])}function Qn(e,t){t===void 0&&(t=[]);const n=o.useRef(null);return o.useEffect(()=>{n.current=null},t),o.useEffect(()=>{const s=e!==Ge;s&&!n.current&&(n.current=e),!s&&n.current&&(n.current=null)},[e]),n.current?en(e,n.current):Ge}function mi(e){o.useEffect(()=>{if(!sn)return;const t=e.map(n=>{let{sensor:s}=n;return s.setup==null?void 0:s.setup()});return()=>{for(const n of t)n==null||n()}},e.map(t=>{let{sensor:n}=t;return n}))}function gi(e,t){return o.useMemo(()=>e.reduce((n,s)=>{let{eventName:a,handler:l}=s;return n[a]=d=>{l(d,t)},n},{}),[e,t])}function vr(e){return o.useMemo(()=>e?Ps(e):null,[e])}const Zn=[];function xi(e,t){t===void 0&&(t=jt);const[n]=e,s=vr(n?ve(n):null),[a,l]=o.useState(Zn);function d(){l(()=>e.length?e.map(h=>mr(h)?s:new Tn(t(h),h)):Zn)}const u=ln({callback:d});return qe(()=>{u==null||u.disconnect(),d(),e.forEach(h=>u==null?void 0:u.observe(h))},[e]),a}function wr(e){if(!e)return null;if(e.children.length>1)return e;const t=e.children[0];return zt(t)?t:e}function pi(e){let{measure:t}=e;const[n,s]=o.useState(null),a=o.useCallback(m=>{for(const{target:g}of m)if(zt(g)){s(p=>{const N=t(g);return p?{...p,width:N.width,height:N.height}:N});break}},[t]),l=ln({callback:a}),d=o.useCallback(m=>{const g=wr(m);l==null||l.disconnect(),g&&(l==null||l.observe(g)),s(g?t(g):null)},[t,l]),[u,h]=Qt(d);return o.useMemo(()=>({nodeRef:u,rect:n,setRef:h}),[n,u,h])}const bi=[{sensor:In,options:{}},{sensor:yr,options:{}}],yi={current:{}},Jt={draggable:{measure:Wn},droppable:{measure:Wn,strategy:Ot.WhileDragging,frequency:An.Optimized},dragOverlay:{measure:jt}};class Tt extends Map{get(t){var n;return t!=null&&(n=super.get(t))!=null?n:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(t=>{let{disabled:n}=t;return!n})}getNodeFor(t){var n,s;return(n=(s=this.get(t))==null?void 0:s.node.current)!=null?n:void 0}}const vi={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new Tt,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:nn},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:Jt,measureDroppableContainers:nn,windowRect:null,measuringScheduled:!1},Nr={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:nn,draggableNodes:new Map,over:null,measureDroppableContainers:nn},Bt=o.createContext(Nr),jr=o.createContext(vi);function wi(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new Tt}}}function Ni(e,t){switch(t.type){case ie.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case ie.DragMove:return e.draggable.active==null?e:{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}};case ie.DragEnd:case ie.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case ie.RegisterDroppable:{const{element:n}=t,{id:s}=n,a=new Tt(e.droppable.containers);return a.set(s,n),{...e,droppable:{...e.droppable,containers:a}}}case ie.SetDroppableDisabled:{const{id:n,key:s,disabled:a}=t,l=e.droppable.containers.get(n);if(!l||s!==l.key)return e;const d=new Tt(e.droppable.containers);return d.set(n,{...l,disabled:a}),{...e,droppable:{...e.droppable,containers:d}}}case ie.UnregisterDroppable:{const{id:n,key:s}=t,a=e.droppable.containers.get(n);if(!a||s!==a.key)return e;const l=new Tt(e.droppable.containers);return l.delete(n),{...e,droppable:{...e.droppable,containers:l}}}default:return e}}function ji(e){let{disabled:t}=e;const{active:n,activatorEvent:s,draggableNodes:a}=o.useContext(Bt),l=Zt(s),d=Zt(n==null?void 0:n.id);return o.useEffect(()=>{if(!t&&!s&&l&&d!=null){if(!on(l)||document.activeElement===l.target)return;const u=a.get(d);if(!u)return;const{activatorNode:h,node:m}=u;if(!h.current&&!m.current)return;requestAnimationFrame(()=>{for(const g of[h.current,m.current]){if(!g)continue;const p=hs(g);if(p){p.focus();break}}})}},[s,t,a,d,l]),null}function Cr(e,t){let{transform:n,...s}=t;return e!=null&&e.length?e.reduce((a,l)=>l({transform:a,...s}),n):n}function Ci(e){return o.useMemo(()=>({draggable:{...Jt.draggable,...e==null?void 0:e.draggable},droppable:{...Jt.droppable,...e==null?void 0:e.droppable},dragOverlay:{...Jt.dragOverlay,...e==null?void 0:e.dragOverlay}}),[e==null?void 0:e.draggable,e==null?void 0:e.droppable,e==null?void 0:e.dragOverlay])}function Si(e){let{activeNode:t,measure:n,initialRect:s,config:a=!0}=e;const l=o.useRef(!1),{x:d,y:u}=typeof a=="boolean"?{x:a,y:a}:a;qe(()=>{if(!d&&!u||!t){l.current=!1;return}if(l.current||!s)return;const m=t==null?void 0:t.node.current;if(!m||m.isConnected===!1)return;const g=n(m),p=cr(g,s);if(d||(p.x=0),u||(p.y=0),l.current=!0,Math.abs(p.x)>0||Math.abs(p.y)>0){const N=ur(m);N&&N.scrollBy({top:p.y,left:p.x})}},[t,d,u,s,n])}const cn=o.createContext({...Ge,scaleX:1,scaleY:1});var ht;(function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"})(ht||(ht={}));const ki=o.memo(function(t){var n,s,a,l;let{id:d,accessibility:u,autoScroll:h=!0,children:m,sensors:g=bi,collisionDetection:p=Ms,measuring:N,modifiers:v,...k}=t;const j=o.useReducer(Ni,void 0,wi),[C,D]=j,[R,_]=ys(),[M,L]=o.useState(ht.Uninitialized),$=M===ht.Initialized,{draggable:{active:S,nodes:A,translate:O},droppable:{containers:V}}=C,T=S!=null?A.get(S):null,re=o.useRef({initial:null,translated:null}),te=o.useMemo(()=>{var H;return S!=null?{id:S,data:(H=T==null?void 0:T.data)!=null?H:yi,rect:re}:null},[S,T]),ce=o.useRef(null),[Qe,we]=o.useState(null),[K,ze]=o.useState(null),Q=It(k,Object.values(k)),Ne=Pt("DndDescribedBy",d),je=o.useMemo(()=>V.getEnabled(),[V]),se=Ci(N),{droppableRects:de,measureDroppableContainers:ue,measuringScheduled:Ce}=oi(je,{dragging:$,dependencies:[O.x,O.y],config:se.droppable}),G=ii(A,S),Fe=o.useMemo(()=>K?tn(K):null,[K]),Se=at(),ge=li(G,se.draggable.measure);Si({activeNode:S!=null?A.get(S):null,config:Se.layoutShiftCompensation,initialRect:ge,measure:se.draggable.measure});const I=Gn(G,se.draggable.measure,ge),ke=Gn(G?G.parentElement:null),J=o.useRef({activatorEvent:null,active:null,activeNode:G,collisionRect:null,collisions:null,droppableRects:de,draggableNodes:A,draggingNode:null,draggingNodeRect:null,droppableContainers:V,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),Ke=V.getNodeFor((n=J.current.over)==null?void 0:n.id),fe=pi({measure:se.dragOverlay.measure}),Re=(s=fe.nodeRef.current)!=null?s:G,be=$?(a=fe.rect)!=null?a:I:null,gt=!!(fe.nodeRef.current&&fe.rect),Pe=ui(gt?null:I),nt=vr(Re?ve(Re):null),Y=fi($?Ke??G:null),We=xi(Y),Ee=Cr(v,{transform:{x:O.x-Pe.x,y:O.y-Pe.y,scaleX:1,scaleY:1},activatorEvent:K,active:te,activeNodeRect:I,containerNodeRect:ke,draggingNodeRect:be,over:J.current.over,overlayNodeRect:fe.rect,scrollableAncestors:Y,scrollableAncestorRects:We,windowRect:nt}),lt=Fe?vt(Fe,O):null,Me=hi(Y),xt=Qn(Me),Be=Qn(Me,[I]),Ue=vt(Ee,xt),Xe=be?Os(be,Ee):null,Le=te&&Xe?p({active:te,collisionRect:Xe,droppableRects:de,droppableContainers:je,pointerCoordinates:lt}):null,rt=Rs(Le,"id"),[Te,Ye]=o.useState(null),bt=gt?Ee:vt(Ee,Be),st=$s(bt,(l=Te==null?void 0:Te.rect)!=null?l:null,I),ct=o.useRef(null),dt=o.useCallback((H,W)=>{let{sensor:F,options:ne}=W;if(ce.current==null)return;const B=A.get(ce.current);if(!B)return;const ae=H.nativeEvent,he=new F({active:ce.current,activeNode:B,event:ae,options:ne,context:J,onAbort(P){if(!A.get(P))return;const{onDragAbort:De}=Q.current,Ie={id:P};De==null||De(Ie),R({type:"onDragAbort",event:Ie})},onPending(P,$e,De,Ie){if(!A.get(P))return;const{onDragPending:ye}=Q.current,Ae={id:P,constraint:$e,initialCoordinates:De,offset:Ie};ye==null||ye(Ae),R({type:"onDragPending",event:Ae})},onStart(P){const $e=ce.current;if($e==null)return;const De=A.get($e);if(!De)return;const{onDragStart:Ie}=Q.current,et={activatorEvent:ae,active:{id:$e,data:De.data,rect:re}};Et.unstable_batchedUpdates(()=>{Ie==null||Ie(et),L(ht.Initializing),D({type:ie.DragStart,initialCoordinates:P,active:$e}),R({type:"onDragStart",event:et}),we(ct.current),ze(ae)})},onMove(P){D({type:ie.DragMove,coordinates:P})},onEnd:Ze(ie.DragEnd),onCancel:Ze(ie.DragCancel)});ct.current=he;function Ze(P){return async function(){const{active:De,collisions:Ie,over:et,scrollAdjustedTranslate:ye}=J.current;let Ae=null;if(De&&ye){const{cancelDrop:tt}=Q.current;Ae={activatorEvent:ae,active:De,collisions:Ie,delta:ye,over:et},P===ie.DragEnd&&typeof tt=="function"&&await Promise.resolve(tt(Ae))&&(P=ie.DragCancel)}ce.current=null,Et.unstable_batchedUpdates(()=>{D({type:P}),L(ht.Uninitialized),Ye(null),we(null),ze(null),ct.current=null;const tt=P===ie.DragEnd?"onDragEnd":"onDragCancel";if(Ae){const ut=Q.current[tt];ut==null||ut(Ae),R({type:tt,event:Ae})}})}}},[A]),yt=o.useCallback((H,W)=>(F,ne)=>{const B=F.nativeEvent,ae=A.get(ne);if(ce.current!==null||!ae||B.dndKit||B.defaultPrevented)return;const he={active:ae};H(F,W.options,he)===!0&&(B.dndKit={capturedBy:W.sensor},ce.current=ne,dt(F,W))},[A,dt]),it=ai(g,yt);mi(g),qe(()=>{I&&M===ht.Initializing&&L(ht.Initialized)},[I,M]),o.useEffect(()=>{const{onDragMove:H}=Q.current,{active:W,activatorEvent:F,collisions:ne,over:B}=J.current;if(!W||!F)return;const ae={active:W,activatorEvent:F,collisions:ne,delta:{x:Ue.x,y:Ue.y},over:B};Et.unstable_batchedUpdates(()=>{H==null||H(ae),R({type:"onDragMove",event:ae})})},[Ue.x,Ue.y]),o.useEffect(()=>{const{active:H,activatorEvent:W,collisions:F,droppableContainers:ne,scrollAdjustedTranslate:B}=J.current;if(!H||ce.current==null||!W||!B)return;const{onDragOver:ae}=Q.current,he=ne.get(rt),Ze=he&&he.rect.current?{id:he.id,rect:he.rect.current,data:he.data,disabled:he.disabled}:null,P={active:H,activatorEvent:W,collisions:F,delta:{x:B.x,y:B.y},over:Ze};Et.unstable_batchedUpdates(()=>{Ye(Ze),ae==null||ae(P),R({type:"onDragOver",event:P})})},[rt]),qe(()=>{J.current={activatorEvent:K,active:te,activeNode:G,collisionRect:Xe,collisions:Le,droppableRects:de,draggableNodes:A,draggingNode:Re,draggingNodeRect:be,droppableContainers:V,over:Te,scrollableAncestors:Y,scrollAdjustedTranslate:Ue},re.current={initial:be,translated:Xe}},[te,G,Le,Xe,A,Re,be,de,V,Te,Y,Ue]),ni({...Se,delta:O,draggingRect:Xe,pointerCoordinates:lt,scrollableAncestors:Y,scrollableAncestorRects:We});const pt=o.useMemo(()=>({active:te,activeNode:G,activeNodeRect:I,activatorEvent:K,collisions:Le,containerNodeRect:ke,dragOverlay:fe,draggableNodes:A,droppableContainers:V,droppableRects:de,over:Te,measureDroppableContainers:ue,scrollableAncestors:Y,scrollableAncestorRects:We,measuringConfiguration:se,measuringScheduled:Ce,windowRect:nt}),[te,G,I,K,Le,ke,fe,A,V,de,Te,ue,Y,We,se,Ce,nt]),He=o.useMemo(()=>({activatorEvent:K,activators:it,active:te,activeNodeRect:I,ariaDescribedById:{draggable:Ne},dispatch:D,draggableNodes:A,over:Te,measureDroppableContainers:ue}),[K,it,te,I,D,Ne,A,Te,ue]);return X.createElement(lr.Provider,{value:_},X.createElement(Bt.Provider,{value:He},X.createElement(jr.Provider,{value:pt},X.createElement(cn.Provider,{value:st},m)),X.createElement(ji,{disabled:(u==null?void 0:u.restoreFocus)===!1})),X.createElement(Ns,{...u,hiddenTextDescribedById:Ne}));function at(){const H=(Qe==null?void 0:Qe.autoScrollEnabled)===!1,W=typeof h=="object"?h.enabled===!1:h===!1,F=$&&!H&&!W;return typeof h=="object"?{...h,enabled:F}:{enabled:F}}}),Di=o.createContext(null),er="button",Ai="Draggable";function _i(e){let{id:t,data:n,disabled:s=!1,attributes:a}=e;const l=Pt(Ai),{activators:d,activatorEvent:u,active:h,activeNodeRect:m,ariaDescribedById:g,draggableNodes:p,over:N}=o.useContext(Bt),{role:v=er,roleDescription:k="draggable",tabIndex:j=0}=a??{},C=(h==null?void 0:h.id)===t,D=o.useContext(C?cn:Di),[R,_]=Qt(),[M,L]=Qt(),$=gi(d,t),S=It(n);qe(()=>(p.set(t,{id:t,key:l,node:R,activatorNode:M,data:S}),()=>{const O=p.get(t);O&&O.key===l&&p.delete(t)}),[p,t]);const A=o.useMemo(()=>({role:v,tabIndex:j,"aria-disabled":s,"aria-pressed":C&&v===er?!0:void 0,"aria-roledescription":k,"aria-describedby":g.draggable}),[s,v,j,C,k,g.draggable]);return{active:h,activatorEvent:u,activeNodeRect:m,attributes:A,isDragging:C,listeners:s?void 0:$,node:R,over:N,setNodeRef:_,setActivatorNodeRef:L,transform:D}}function Sr(){return o.useContext(jr)}const Ri="Droppable",Ei={timeout:25};function kr(e){let{data:t,disabled:n=!1,id:s,resizeObserverConfig:a}=e;const l=Pt(Ri),{active:d,dispatch:u,over:h,measureDroppableContainers:m}=o.useContext(Bt),g=o.useRef({disabled:n}),p=o.useRef(!1),N=o.useRef(null),v=o.useRef(null),{disabled:k,updateMeasurementsFor:j,timeout:C}={...Ei,...a},D=It(j??s),R=o.useCallback(()=>{if(!p.current){p.current=!0;return}v.current!=null&&clearTimeout(v.current),v.current=setTimeout(()=>{m(Array.isArray(D.current)?D.current:[D.current]),v.current=null},C)},[C]),_=ln({callback:R,disabled:k||!d}),M=o.useCallback((A,O)=>{_&&(O&&(_.unobserve(O),p.current=!1),A&&_.observe(A))},[_]),[L,$]=Qt(M),S=It(t);return o.useEffect(()=>{!_||!L.current||(_.disconnect(),p.current=!1,_.observe(L.current))},[L,_]),o.useEffect(()=>(u({type:ie.RegisterDroppable,element:{id:s,key:l,disabled:n,node:L,rect:N,data:S}}),()=>u({type:ie.UnregisterDroppable,key:l,id:s})),[s]),o.useEffect(()=>{n!==g.current.disabled&&(u({type:ie.SetDroppableDisabled,id:s,key:l,disabled:n}),g.current.disabled=n)},[s,l,n,u]),{active:d,rect:N,isOver:(h==null?void 0:h.id)===s,node:L,over:h,setNodeRef:$}}function Mi(e){let{animation:t,children:n}=e;const[s,a]=o.useState(null),[l,d]=o.useState(null),u=Zt(n);return!n&&!s&&u&&a(u),qe(()=>{if(!l)return;const h=s==null?void 0:s.key,m=s==null?void 0:s.props.id;if(h==null||m==null){a(null);return}Promise.resolve(t(m,l)).then(()=>{a(null)})},[t,s,l]),X.createElement(X.Fragment,null,n,s?o.cloneElement(s,{ref:d}):null)}const Li={x:0,y:0,scaleX:1,scaleY:1};function Ti(e){let{children:t}=e;return X.createElement(Bt.Provider,{value:Nr},X.createElement(cn.Provider,{value:Li},t))}const $i={position:"fixed",touchAction:"none"},Ii=e=>on(e)?"transform 250ms ease":void 0,Oi=o.forwardRef((e,t)=>{let{as:n,activatorEvent:s,adjustScale:a,children:l,className:d,rect:u,style:h,transform:m,transition:g=Ii}=e;if(!u)return null;const p=a?m:{...m,scaleX:1,scaleY:1},N={...$i,width:u.width,height:u.height,top:u.top,left:u.left,transform:mt.Transform.toString(p),transformOrigin:a&&s?ks(s,u):void 0,transition:typeof g=="function"?g(s):g,...h};return X.createElement(n,{className:d,style:N,ref:t},l)}),zi=e=>t=>{let{active:n,dragOverlay:s}=t;const a={},{styles:l,className:d}=e;if(l!=null&&l.active)for(const[u,h]of Object.entries(l.active))h!==void 0&&(a[u]=n.node.style.getPropertyValue(u),n.node.style.setProperty(u,h));if(l!=null&&l.dragOverlay)for(const[u,h]of Object.entries(l.dragOverlay))h!==void 0&&s.node.style.setProperty(u,h);return d!=null&&d.active&&n.node.classList.add(d.active),d!=null&&d.dragOverlay&&s.node.classList.add(d.dragOverlay),function(){for(const[h,m]of Object.entries(a))n.node.style.setProperty(h,m);d!=null&&d.active&&n.node.classList.remove(d.active)}},Fi=e=>{let{transform:{initial:t,final:n}}=e;return[{transform:mt.Transform.toString(t)},{transform:mt.Transform.toString(n)}]},Pi={duration:250,easing:"ease",keyframes:Fi,sideEffects:zi({styles:{active:{opacity:"0"}}})};function Bi(e){let{config:t,draggableNodes:n,droppableContainers:s,measuringConfiguration:a}=e;return an((l,d)=>{if(t===null)return;const u=n.get(l);if(!u)return;const h=u.node.current;if(!h)return;const m=wr(d);if(!m)return;const{transform:g}=ve(d).getComputedStyle(d),p=dr(g);if(!p)return;const N=typeof t=="function"?t:Ui(t);return pr(h,a.draggable.measure),N({active:{id:l,data:u.data,node:h,rect:a.draggable.measure(h)},draggableNodes:n,dragOverlay:{node:d,rect:a.dragOverlay.measure(m)},droppableContainers:s,measuringConfiguration:a,transform:p})})}function Ui(e){const{duration:t,easing:n,sideEffects:s,keyframes:a}={...Pi,...e};return l=>{let{active:d,dragOverlay:u,transform:h,...m}=l;if(!t)return;const g={x:u.rect.left-d.rect.left,y:u.rect.top-d.rect.top},p={scaleX:h.scaleX!==1?d.rect.width*h.scaleX/u.rect.width:1,scaleY:h.scaleY!==1?d.rect.height*h.scaleY/u.rect.height:1},N={x:h.x-g.x,y:h.y-g.y,...p},v=a({...m,active:d,dragOverlay:u,transform:{initial:h,final:N}}),[k]=v,j=v[v.length-1];if(JSON.stringify(k)===JSON.stringify(j))return;const C=s==null?void 0:s({active:d,dragOverlay:u,...m}),D=u.node.animate(v,{duration:t,easing:n,fill:"forwards"});return new Promise(R=>{D.onfinish=()=>{C==null||C(),R()}})}}let tr=0;function Vi(e){return o.useMemo(()=>{if(e!=null)return tr++,tr},[e])}const Ki=X.memo(e=>{let{adjustScale:t=!1,children:n,dropAnimation:s,style:a,transition:l,modifiers:d,wrapperElement:u="div",className:h,zIndex:m=999}=e;const{activatorEvent:g,active:p,activeNodeRect:N,containerNodeRect:v,draggableNodes:k,droppableContainers:j,dragOverlay:C,over:D,measuringConfiguration:R,scrollableAncestors:_,scrollableAncestorRects:M,windowRect:L}=Sr(),$=o.useContext(cn),S=Vi(p==null?void 0:p.id),A=Cr(d,{activatorEvent:g,active:p,activeNodeRect:N,containerNodeRect:v,draggingNodeRect:C.rect,over:D,overlayNodeRect:C.rect,scrollableAncestors:_,scrollableAncestorRects:M,transform:$,windowRect:L}),O=On(N),V=Bi({config:s,draggableNodes:k,droppableContainers:j,measuringConfiguration:R}),T=O?C.setRef:void 0;return X.createElement(Ti,null,X.createElement(Mi,{animation:V},p&&S?X.createElement(Oi,{key:S,id:p.id,ref:T,as:u,activatorEvent:g,adjustScale:t,className:h,transition:l,rect:O,style:{zIndex:m,...a},transform:A},n):null))});function Dr(e,t,n){const s=e.slice();return s.splice(n<0?s.length+n:n,0,s.splice(t,1)[0]),s}function Wi(e,t){return e.reduce((n,s,a)=>{const l=t.get(s);return l&&(n[a]=l),n},Array(e.length))}function qt(e){return e!==null&&e>=0}function Xi(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function Yi(e){return typeof e=="boolean"?{draggable:e,droppable:e}:e}const Ar=e=>{let{rects:t,activeIndex:n,overIndex:s,index:a}=e;const l=Dr(t,s,n),d=t[a],u=l[a];return!u||!d?null:{x:u.left-d.left,y:u.top-d.top,scaleX:u.width/d.width,scaleY:u.height/d.height}},Gt={scaleX:1,scaleY:1},Hi=e=>{var t;let{activeIndex:n,activeNodeRect:s,index:a,rects:l,overIndex:d}=e;const u=(t=l[n])!=null?t:s;if(!u)return null;if(a===n){const m=l[d];return m?{x:0,y:n<d?m.top+m.height-(u.top+u.height):m.top-u.top,...Gt}:null}const h=qi(l,a,n);return a>n&&a<=d?{x:0,y:-u.height-h,...Gt}:a<n&&a>=d?{x:0,y:u.height+h,...Gt}:{x:0,y:0,...Gt}};function qi(e,t,n){const s=e[t],a=e[t-1],l=e[t+1];return s?n<t?a?s.top-(a.top+a.height):l?l.top-(s.top+s.height):0:l?l.top-(s.top+s.height):a?s.top-(a.top+a.height):0:0}const _r="Sortable",Rr=X.createContext({activeIndex:-1,containerId:_r,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:Ar,disabled:{draggable:!1,droppable:!1}});function Gi(e){let{children:t,id:n,items:s,strategy:a=Ar,disabled:l=!1}=e;const{active:d,dragOverlay:u,droppableRects:h,over:m,measureDroppableContainers:g}=Sr(),p=Pt(_r,n),N=u.rect!==null,v=o.useMemo(()=>s.map($=>typeof $=="object"&&"id"in $?$.id:$),[s]),k=d!=null,j=d?v.indexOf(d.id):-1,C=m?v.indexOf(m.id):-1,D=o.useRef(v),R=!Xi(v,D.current),_=C!==-1&&j===-1||R,M=Yi(l);qe(()=>{R&&k&&g(v)},[R,v,k,g]),o.useEffect(()=>{D.current=v},[v]);const L=o.useMemo(()=>({activeIndex:j,containerId:p,disabled:M,disableTransforms:_,items:v,overIndex:C,useDragOverlay:N,sortedRects:Wi(v,h),strategy:a}),[j,p,M.draggable,M.droppable,_,v,C,h,N,a]);return X.createElement(Rr.Provider,{value:L},t)}const Ji=e=>{let{id:t,items:n,activeIndex:s,overIndex:a}=e;return Dr(n,s,a).indexOf(t)},Qi=e=>{let{containerId:t,isSorting:n,wasDragging:s,index:a,items:l,newIndex:d,previousItems:u,previousContainerId:h,transition:m}=e;return!m||!s||u!==l&&a===d?!1:n?!0:d!==a&&t===h},Zi={duration:200,easing:"ease"},Er="transform",ea=mt.Transition.toString({property:Er,duration:0,easing:"linear"}),ta={roleDescription:"sortable"};function na(e){let{disabled:t,index:n,node:s,rect:a}=e;const[l,d]=o.useState(null),u=o.useRef(n);return qe(()=>{if(!t&&n!==u.current&&s.current){const h=a.current;if(h){const m=jt(s.current,{ignoreTransform:!0}),g={x:h.left-m.left,y:h.top-m.top,scaleX:h.width/m.width,scaleY:h.height/m.height};(g.x||g.y)&&d(g)}}n!==u.current&&(u.current=n)},[t,n,s,a]),o.useEffect(()=>{l&&d(null)},[l]),l}function ra(e){let{animateLayoutChanges:t=Qi,attributes:n,disabled:s,data:a,getNewIndex:l=Ji,id:d,strategy:u,resizeObserverConfig:h,transition:m=Zi}=e;const{items:g,containerId:p,activeIndex:N,disabled:v,disableTransforms:k,sortedRects:j,overIndex:C,useDragOverlay:D,strategy:R}=o.useContext(Rr),_=sa(s,v),M=g.indexOf(d),L=o.useMemo(()=>({sortable:{containerId:p,index:M,items:g},...a}),[p,a,M,g]),$=o.useMemo(()=>g.slice(g.indexOf(d)),[g,d]),{rect:S,node:A,isOver:O,setNodeRef:V}=kr({id:d,data:L,disabled:_.droppable,resizeObserverConfig:{updateMeasurementsFor:$,...h}}),{active:T,activatorEvent:re,activeNodeRect:te,attributes:ce,setNodeRef:Qe,listeners:we,isDragging:K,over:ze,setActivatorNodeRef:Q,transform:Ne}=_i({id:d,data:L,attributes:{...ta,...n},disabled:_.draggable}),je=cs(V,Qe),se=!!T,de=se&&!k&&qt(N)&&qt(C),ue=!D&&K,Ce=ue&&de?Ne:null,Fe=de?Ce??(u??R)({rects:j,activeNodeRect:te,activeIndex:N,overIndex:C,index:M}):null,Se=qt(N)&&qt(C)?l({id:d,items:g,activeIndex:N,overIndex:C}):M,ge=T==null?void 0:T.id,I=o.useRef({activeId:ge,items:g,newIndex:Se,containerId:p}),ke=g!==I.current.items,J=t({active:T,containerId:p,isDragging:K,isSorting:se,id:d,index:M,items:g,newIndex:I.current.newIndex,previousItems:I.current.items,previousContainerId:I.current.containerId,transition:m,wasDragging:I.current.activeId!=null}),Ke=na({disabled:!J,index:M,node:A,rect:S});return o.useEffect(()=>{se&&I.current.newIndex!==Se&&(I.current.newIndex=Se),p!==I.current.containerId&&(I.current.containerId=p),g!==I.current.items&&(I.current.items=g)},[se,Se,p,g]),o.useEffect(()=>{if(ge===I.current.activeId)return;if(ge!=null&&I.current.activeId==null){I.current.activeId=ge;return}const Re=setTimeout(()=>{I.current.activeId=ge},50);return()=>clearTimeout(Re)},[ge]),{active:T,activeIndex:N,attributes:ce,data:L,rect:S,index:M,newIndex:Se,items:g,isOver:O,isSorting:se,isDragging:K,listeners:we,node:A,overIndex:C,over:ze,setNodeRef:je,setActivatorNodeRef:Q,setDroppableNodeRef:V,setDraggableNodeRef:Qe,transform:Ke??Fe,transition:fe()};function fe(){if(Ke||ke&&I.current.newIndex===M)return ea;if(!(ue&&!on(re)||!m)&&(se||J))return mt.Transition.toString({...m,property:Er})}}function sa(e,t){var n,s;return typeof e=="boolean"?{draggable:e,droppable:!1}:{draggable:(n=e==null?void 0:e.draggable)!=null?n:t.draggable,droppable:(s=e==null?void 0:e.droppable)!=null?s:t.droppable}}z.Down,z.Right,z.Up,z.Left;const nr=["bg-sky-600","bg-emerald-600","bg-violet-600","bg-rose-600","bg-amber-600"];function $t(e){if(!e)return"No date set";const t=new Date(e);if(isNaN(t.getTime()))return"Invalid date";const n=t.getDate(),s=t.toLocaleString("en-US",{month:"long"}),a=t.getFullYear();let l="th";return n===1||n===21||n===31?l="st":n===2||n===22?l="nd":(n===3||n===23)&&(l="rd"),`${n}${l} ${s} ${a}`}function Cn(e){return e?typeof e=="string"?/^\d{4}-\d{2}-\d{2}$/.test(e)?e:e.includes("T")?e.split("T")[0]:"":e instanceof Date&&!isNaN(e.getTime())?e.toISOString().split("T")[0]:"":""}function _n(e){return new Date(e).toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}function Rn(e){return!e||e<=0?"":e<1024?`${e} B`:e<1024*1024?`${(e/1024).toFixed(1)} KB`:`${(e/(1024*1024)).toFixed(1)} MB`}function ia(e){if(!e)return null;const n=e.trim().slice(0,10).match(/^(\d{4})-(\d{2})-(\d{2})$/);if(!n)return null;const s=Number(n[1]),a=Number(n[2])-1,l=Number(n[3]);return new Date(s,a,l)}function aa(e){const t=(e.first_name||"").trim().charAt(0),n=(e.last_name||"").trim().charAt(0),s=(e.email||"").trim().charAt(0);return(`${t}${n}`.trim()||s||"U").toUpperCase()}const Rt=["Student's Phone Number:","Student's Email:","Emergency Phone Number:","","Education Background (Grades & Stream):","Gap explanation if applicable:","English Proficiency:","","Intended Level of Study:","Interested Program Of Study:","Institution/City Preference:","Maximum Budget:","","Funding Details:","Sponsor:","Source of Income:","Funds Breakdown:"].join(`
`),oa=o.lazy(()=>Fr(()=>import("./index.es-BVvuPAKE.js"),__vite__mapDeps([0,1,2,3])));function la({card:e,listTitle:t,profile:n,onClose:s,setSelectedCard:a,fetchBoard:l}){var Dt;const[d,u]=o.useState(!1),[h,m]=o.useState([]),[g,p]=o.useState(null),[N,v]=o.useState([]),[k,j]=o.useState("country"),[C,D]=o.useState([]),[R,_]=o.useState([]),[M,L]=o.useState([]),[$,S]=o.useState(!1),[A,O]=o.useState(!1),[V,T]=o.useState((Dt=e.description)!=null&&Dt.trim()?e.description:Rt),[re,te]=o.useState(!1),ce=o.useRef(null),[Qe,we]=o.useState(!1),[K,ze]=o.useState(Cn(e.due_date)),[Q,Ne]=o.useState(!1),[je,se]=o.useState(!!e.payment_done),[de,ue]=o.useState(!!e.dependant_payment_done),[Ce,G]=o.useState(!1),[Fe,Se]=o.useState(!1),[ge,I]=o.useState(!1),[ke,J]=o.useState(!1),[Ke,fe]=o.useState(!1),Re=o.useRef(null),[be,gt]=o.useState([]),[Pe,nt]=o.useState(""),[Y,We]=o.useState(null),[Ee,lt]=o.useState(0),[Me,xt]=o.useState(!1),[Be,Ue]=o.useState(null),[Xe,Le]=o.useState(!1),[rt,Te]=o.useState(!1),[Ye,bt]=o.useState(!1),[st,ct]=o.useState([]),[dt,yt]=o.useState([]),[it,pt]=o.useState([]),[He,at]=o.useState(""),[H,W]=o.useState(null),F=Number(n==null?void 0:n.role_id)===1||Number(n==null?void 0:n.role_id)===2;o.useEffect(()=>{var i;const c=Array.isArray(e.country_label_ids)?e.country_label_ids:e.country_label_id!=null?[e.country_label_id]:[];m(c),p(e.intake_label_id??null);const y=Array.isArray(e.service_area_ids)?e.service_area_ids:e.service_area_id!=null?[e.service_area_id]:[];v(y),j("country"),T((i=e.description)!=null&&i.trim()?e.description:Rt),ze(Cn(e.due_date)),se(!!e.payment_done),ue(!!e.dependant_payment_done),J(!1),fe(!1),Le(!1),ct([]),yt([]),pt([]),at(""),W(null),ne(),P()},[e]),o.useEffect(()=>{if(!A||!ce.current)return;const c=ce.current;c.style.height="0px",c.style.height=`${c.scrollHeight}px`},[A,V]),o.useEffect(()=>{Promise.all([tt(),ut(),Ut()])},[e.id]),o.useEffect(()=>{const c=y=>{if(y.key==="Escape"){if(ke){J(!1);return}y.preventDefault(),s()}};return window.addEventListener("keydown",c),()=>window.removeEventListener("keydown",c)},[s,ke]),o.useEffect(()=>{if(!ke)return;const c=y=>{Re.current&&(Re.current.contains(y.target)||J(!1))};return document.addEventListener("mousedown",c),()=>document.removeEventListener("mousedown",c)},[ke]);const ne=async()=>{try{const c=await U.get(`/cards/${e.id}/activities`);gt(c.data||[])}catch(c){console.error("Failed to fetch activities:",c)}},B=async()=>{if(!(!Pe.trim()&&!Y)){xt(!0);try{const c=new FormData;Pe.trim()&&c.append("details",Pe.trim()),Y&&c.append("attachment",Y),await U.post(`/cards/${e.id}/activities`,c),nt(""),We(null),lt(y=>y+1),await ne()}catch(c){console.error("Failed to post comment:",c),alert("Could not post comment / attachment.")}finally{xt(!1)}}},ae=async c=>{try{Ue(c.id);const y=await U.get(`/activities/${c.id}/attachment`,{responseType:"blob"}),i=new Blob([y.data],{type:c.attachment_mime||y.headers["content-type"]||"application/octet-stream"}),f=URL.createObjectURL(i);if(!window.open(f,"_blank","noopener,noreferrer")){const b=document.createElement("a");b.href=f,b.download=c.attachment_name||"attachment",document.body.appendChild(b),b.click(),document.body.removeChild(b)}window.setTimeout(()=>URL.revokeObjectURL(f),6e4)}catch(y){console.error("Failed to open attachment:",y),alert("Could not open attachment.")}finally{Ue(null)}},he=c=>`${c.first_name||""} ${c.last_name||""}`.trim()||c.email||`User #${c.id}`,Ze=c=>{const y=(c.first_name||"").trim().charAt(0),i=(c.last_name||"").trim().charAt(0),f=(c.email||"").trim().charAt(0);return(`${y}${i}`.trim()||f||"U").toUpperCase()},P=async()=>{var c,y;Te(!0),W(null);try{const i=await U.get(`/cards/${e.id}/members`),f=((c=i.data)==null?void 0:c.members)||[],x=Array.isArray((y=i.data)==null?void 0:y.options)?i.data.options:[],b=x.length>0?x:f;yt(f),pt(f.map(w=>w.id)),ct(b)}catch(i){console.error("Failed to fetch card members:",i),W("Could not load members.")}finally{Te(!1)}},$e=async()=>{Le(!0),await P()},De=c=>{!F||Ye||pt(y=>y.includes(c)?y.filter(i=>i!==c):[...y,c])},Ie=async()=>{var c,y;if(F){bt(!0),W(null);try{await U.put(`/cards/${e.id}/members`,{user_ids:it}),await P(),await ne(),await l(),Le(!1)}catch(i){console.error("Failed to save members:",i),W(((y=(c=i==null?void 0:i.response)==null?void 0:c.data)==null?void 0:y.message)||"Could not save members.")}finally{bt(!1)}}},et=o.useMemo(()=>{const c=He.trim().toLowerCase();return c?st.filter(y=>`${y.first_name||""} ${y.last_name||""} ${y.email||""}`.toLowerCase().includes(c)):st},[st,He]),ye=o.useMemo(()=>{var y;const c={total:be.length,comments:0,attachments:0,labelUpdates:0,paymentUpdates:0,latestAt:((y=be[0])==null?void 0:y.created_at)||null};for(const i of be)i.action==="commented"&&(c.comments+=1),(i.attachment_path||i.attachment_url)&&(c.attachments+=1),i.action.includes("label")&&(c.labelUpdates+=1),i.action.includes("payment")&&(c.paymentUpdates+=1);return c},[be]),Ae=c=>Array.isArray(c==null?void 0:c.data)?c.data:Array.isArray(c)?c:[],tt=async()=>{S(!0);try{const c=await U.get("/country-labels");D(Ae(c.data))}catch(c){console.error("Failed to load country labels",c),alert("Could not load country labels.")}finally{S(!1)}},ut=async()=>{S(!0);try{const c=await U.get("/intake-labels");_(Ae(c.data))}catch(c){console.error("Failed to load intake labels",c),alert("Could not load intake labels.")}finally{S(!1)}},Ut=async()=>{S(!0);try{const c=await U.get("/service-areas");L(Ae(c.data))}catch(c){console.error("Failed to load service areas",c),alert("Could not load service areas.")}finally{S(!1)}},ft=async c=>{j(c),u(!0),c==="country"?await tt():c==="intake"?await ut():await Ut()},Vt=(c,y)=>{y(i=>i.includes(c)?i.filter(f=>f!==c):[...i,c])},dn=async()=>{try{const c=[...new Set(h)],y=[...new Set(N)],i={country_label_id:c[0]??null,country_label_ids:c,intake_label_id:g??null,service_area_id:y[0]??null,service_area_ids:y};await U.put(`/cards/${e.id}/labels`,i),a(f=>f&&f.id===e.id?{...f,...i}:f),await l(),await ne(),u(!1)}catch(c){console.error("Failed to save labels:",c),alert("Could not save labels. Please try again.")}},Kt=async()=>{const c=V.trim();if(c===(e.description||"")){O(!1);return}te(!0);try{await U.put(`/cards/${e.id}/description`,{description:c||null}),a(y=>y&&y.id===e.id?{...y,description:c||void 0}:y),await l(),await ne(),O(!1)}catch(y){console.error("Failed to save description:",y),alert("Could not save description.")}finally{te(!1)}},Wt=()=>{var c;T((c=e.description)!=null&&c.trim()?e.description:Rt),O(!0)},Ct=async()=>{Ne(!0);try{const c=K.trim()||null;await U.put(`/cards/${e.id}/due-date`,{due_date:c}),a(y=>y&&y.id===e.id?{...y,due_date:c??void 0}:y),await l(),await ne(),we(!1)}catch(c){console.error("Failed to save due date:",c),alert("Could not save due date."),await l()}finally{Ne(!1)}},un=()=>{we(!0)},St=async()=>{var y,i;if(Ce)return;G(!0);const c=!je;try{await U.put(`/cards/${e.id}/payment`,{payment_done:c}),se(c),a(f=>f&&f.id===e.id?{...f,payment_done:c}:f),await l(),await ne()}catch(f){console.error("Failed to update payment status:",f),alert(((i=(y=f==null?void 0:f.response)==null?void 0:y.data)==null?void 0:i.message)||"Could not update payment status."),await l()}finally{G(!1)}},fn=async()=>{var y,i;if(Fe)return;Se(!0);const c=!de;try{await U.put(`/cards/${e.id}/dependant-payment`,{dependant_payment_done:c}),ue(c),a(f=>f&&f.id===e.id?{...f,dependant_payment_done:c}:f),await l(),await ne()}catch(f){console.error("Failed to update dependant payment status:",f),alert(((i=(y=f==null?void 0:f.response)==null?void 0:y.data)==null?void 0:i.message)||"Could not update dependant payment status."),await l()}finally{Se(!1)}},Xt=async()=>{var y,i;if(ge)return;I(!0);const c=!e.is_archived;try{if(await U.put(`/cards/${e.id}/archive`,{is_archived:c}),a(f=>f&&f.id===e.id?{...f,is_archived:c}:f),await l(),c){s();return}await ne()}catch(f){console.error("Failed to update archive status:",f),alert(((i=(y=f==null?void 0:f.response)==null?void 0:y.data)==null?void 0:i.message)||"Could not update archive status.")}finally{I(!1)}},hn=()=>{if(h.length===0)return"Country";const c=h.map(y=>{var i;return(i=C.find(f=>f.id===y))==null?void 0:i.name}).filter(y=>!!y);return c.length>0?c.join(", "):"Country"},mn=()=>{var c;return((c=R.find(y=>y.id===g))==null?void 0:c.name)||"Intake"},gn=()=>{if(N.length===0)return"Service";const c=N.map(y=>{var i;return(i=M.find(f=>f.id===y))==null?void 0:i.name}).filter(y=>!!y);return c.length>0?c.join(", "):"Service"},xn=/((?:https?:\/\/|www\.)[^\s]+)/gi,Yt=c=>/^(?:https?:\/\/|www\.)[^\s]+$/i.test(c),Ht=c=>/^https?:\/\//i.test(c)?c:`https://${c}`,kt=c=>{if(!c)return null;const y=c.split(/\r?\n/);return y.map((i,f)=>r.jsxs(X.Fragment,{children:[i.split(xn).map((x,b)=>{if(!x)return null;if(!Yt(x))return r.jsx(X.Fragment,{children:x},`text-${f}-${b}`);const w=x.match(/^(.*?)([.,!?)]*)$/),oe=(w==null?void 0:w[1])||x,xe=(w==null?void 0:w[2])||"";return r.jsxs(X.Fragment,{children:[r.jsx("a",{href:Ht(oe),target:"_blank",rel:"noopener noreferrer",className:"text-indigo-600 hover:text-indigo-700 underline break-all",children:oe}),xe]},`link-${f}-${b}`)}),f<y.length-1?r.jsx("br",{}):null]},`line-${f}`))};return r.jsxs("div",{className:"fixed inset-0 bg-black/65 backdrop-blur-sm z-50 flex items-center justify-center p-4 sm:p-6",children:[r.jsxs("div",{className:"bg-white w-full max-w-6xl rounded-2xl shadow-2xl overflow-hidden max-h-[92vh] flex flex-col border border-gray-200/50",children:[r.jsxs("div",{className:"px-6 py-4 border-b bg-gradient-to-r from-indigo-50/60 to-white flex items-start justify-between gap-6",children:[r.jsx("div",{className:"flex-1 min-w-0 space-y-1",children:r.jsx("div",{className:"inline-flex items-center gap-2 px-4 py-1.5 bg-indigo-100/80 text-indigo-800 rounded-lg text-sm font-semibold border border-indigo-200 shadow-sm",children:t})}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsxs("div",{className:"relative",ref:Re,children:[r.jsx("button",{type:"button",onClick:()=>J(c=>!c),className:"h-9 w-9 flex items-center justify-center rounded-lg border border-gray-200 bg-white hover:bg-gray-50",children:r.jsx(es,{size:17,className:"text-gray-600"})}),ke&&r.jsxs("div",{className:"absolute right-0 mt-2 w-60 rounded-lg border border-gray-200 bg-white shadow-lg p-1.5 z-20",children:[r.jsxs("button",{type:"button",onClick:()=>{J(!1),St()},disabled:Ce,className:`w-full flex items-center gap-2 rounded-md px-3 py-2 text-sm text-left transition ${Ce?"text-gray-400 cursor-not-allowed":je?"text-emerald-700 hover:bg-emerald-50":"text-rose-700 hover:bg-rose-50"}`,children:[r.jsx(Un,{size:15}),Ce?"Saving...":je?"Visa Payment Done":"Mark Visa Payment Done"]}),r.jsxs("button",{type:"button",onClick:()=>{J(!1),fn()},disabled:Fe,className:`w-full flex items-center gap-2 rounded-md px-3 py-2 text-sm text-left transition ${Fe?"text-gray-400 cursor-not-allowed":de?"text-emerald-700 hover:bg-emerald-50":"text-amber-700 hover:bg-amber-50"}`,children:[r.jsx(Un,{size:15}),Fe?"Saving...":de?"Dependant Payment Done":"Mark Dependant Payment Done"]}),r.jsx("div",{className:"my-1 border-t border-gray-100"}),r.jsxs("button",{type:"button",onClick:()=>{J(!1),Xt()},disabled:ge,className:`w-full flex items-center gap-2 rounded-md px-3 py-2 text-sm text-left transition ${ge?"text-gray-400 cursor-not-allowed":"text-amber-700 hover:bg-amber-50"}`,children:[r.jsx(sr,{size:15}),ge?"Saving...":e.is_archived?"Restore Card":"Archive Card"]})]})]}),r.jsx("button",{onClick:s,className:"h-9 w-9 flex items-center justify-center rounded-lg border border-red-200 bg-red-50 text-red-600 hover:bg-red-100",children:r.jsx(ot,{size:18})})]})]}),r.jsxs("div",{className:"flex flex-1 overflow-hidden",children:[r.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-7 bg-white",children:[r.jsx("div",{className:"flex items-start gap-3",children:r.jsxs("h2",{className:"text-2xl font-bold text-gray-900 truncate leading-tight",children:[e.invoice||`ID-${e.id}`," ",e.first_name," ",e.last_name,"  ",$t(e.created_at)]})}),r.jsxs("div",{className:"flex flex-wrap gap-1",children:[r.jsx("button",{type:"button",onClick:()=>void ft("country"),className:"h-10 px-3 rounded-md bg-[#8f53c6] text-white text-sm font-medium border border-[#8f53c6] hover:brightness-95 transition",children:hn()}),r.jsx("button",{type:"button",onClick:()=>void ft("intake"),className:"h-10 px-3 rounded-md bg-[#f2b205] text-[#4a2b00] text-sm font-medium border border-[#f2b205] hover:brightness-95 transition",children:mn()}),r.jsx("button",{type:"button",onClick:()=>void ft("serviceArea"),className:"h-10 px-3 rounded-md bg-[#d63a3a] text-white text-sm font-medium border border-[#d63a3a] hover:brightness-95 transition",children:gn()}),r.jsxs("button",{onClick:un,className:"h-10 px-3 rounded-md bg-[#4f46e5] text-white text-sm font-medium border border-[#4f46e5] hover:brightness-95 transition flex items-center gap-1.5",children:[r.jsx(qr,{size:16,className:"text-white/90"}),e.due_date?$t(e.due_date):"Due Dates"]})]}),r.jsx("div",{className:"space-y-6",children:r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-semibold text-gray-700 mb-2.5",children:"Members"}),r.jsxs("div",{className:"flex items-center gap-2",children:[dt.slice(0,3).map(c=>r.jsx("button",{type:"button",onClick:$e,title:he(c),className:"h-10 w-10 rounded-full bg-sky-600 text-white text-sm font-bold flex items-center justify-center hover:brightness-110 transition",children:Ze(c)},c.id)),r.jsx("button",{type:"button",onClick:$e,className:"h-10 w-10 rounded-full bg-gray-200 text-gray-700 text-xl flex items-center justify-center hover:bg-gray-300 transition",title:"Manage members",children:r.jsx(Sn,{size:18})})]})]})}),r.jsxs("div",{className:"bg-gray-50/70 border border-gray-200 rounded-xl overflow-hidden",children:[r.jsxs("div",{className:"flex items-center justify-between px-5 py-3.5 border-b bg-white/60",children:[r.jsxs("div",{className:"flex items-center gap-2.5",children:[r.jsx(ir,{size:18,className:"text-indigo-600"}),r.jsx("h3",{className:"font-semibold text-gray-800",children:"Description"})]}),A?r.jsxs("div",{className:"flex gap-3",children:[r.jsx("button",{onClick:()=>{var c;O(!1),T((c=e.description)!=null&&c.trim()?e.description:Rt)},className:"px-4 py-1.5 text-sm text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded",disabled:re,children:"Cancel"}),r.jsx("button",{onClick:Kt,className:`px-5 py-1.5 text-sm font-medium rounded text-white ${re?"bg-indigo-400 cursor-not-allowed":"bg-indigo-600 hover:bg-indigo-700"}`,disabled:re,children:re?"Saving...":"Save"})]}):r.jsxs("button",{onClick:Wt,className:"flex items-center gap-1.5 text-sm text-indigo-600 hover:text-indigo-800 font-medium transition",children:[r.jsx(rr,{size:14}),"Edit"]})]}),A?r.jsx("div",{className:"p-5",children:r.jsx("textarea",{ref:ce,value:V,onChange:c=>T(c.target.value),className:"w-full border border-gray-300 rounded-lg px-4 py-3 text-sm resize-none overflow-hidden min-h-[180px] focus:outline-none focus:ring-2 focus:ring-indigo-400 transition",placeholder:"Fill student profile details...",autoFocus:!0})}):r.jsx("div",{onClick:Wt,className:"px-5 py-5 text-sm text-gray-800 space-y-2 leading-relaxed cursor-pointer hover:bg-white/40 transition",title:"Click to edit description",children:e.description&&e.description.trim()?e.description.split(`
`).map((c,y)=>r.jsx("p",{children:c},y)):Rt.split(`
`).map((c,y)=>r.jsx("p",{className:"text-gray-500",children:c||""},y))})]})]}),r.jsxs("div",{className:"w-full sm:w-[360px] bg-gray-50 border-l border-gray-200 flex flex-col overflow-hidden",children:[r.jsxs("div",{className:"px-5 py-4 border-b bg-white/80 flex items-center justify-between",children:[r.jsx("h3",{className:"font-semibold text-gray-800",children:"Comments & Activity"}),r.jsxs("button",{type:"button",onClick:()=>fe(!0),className:"inline-flex items-center gap-1.5 text-sm px-3 py-1.5 bg-white border border-gray-200 rounded-lg hover:bg-gray-50 transition",children:[r.jsx(Jr,{size:14}),"Activity Summary"]})]}),r.jsxs("div",{className:"flex-1 p-5 space-y-6 overflow-y-auto overflow-x-hidden",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx("textarea",{value:Pe,onChange:c=>nt(c.target.value),placeholder:"Write a comment...",className:"w-full border border-gray-300 rounded-lg px-4 py-3 text-sm resize-none h-28 focus:outline-none focus:ring-2 focus:ring-indigo-400 focus:border-indigo-400 transition"}),r.jsxs("div",{className:"flex items-center justify-between gap-3",children:[r.jsxs("label",{className:"inline-flex items-center gap-2 px-3 py-2 text-sm border border-gray-300 rounded-lg bg-white hover:bg-gray-50 cursor-pointer",children:[r.jsx(Vn,{size:14,className:"text-gray-600"}),r.jsx("span",{children:"Attach file"}),r.jsx("input",{type:"file",className:"hidden",onChange:c=>{var i;const y=((i=c.target.files)==null?void 0:i[0])||null;We(y)}},Ee)]}),Y&&r.jsx("button",{type:"button",onClick:()=>{We(null),lt(c=>c+1)},className:"text-xs text-red-600 hover:underline",children:"Remove file"})]}),Y&&r.jsxs("div",{className:"text-xs text-gray-600 bg-white border border-gray-200 rounded-lg px-3 py-2",children:[r.jsx("span",{className:"font-medium",children:Y.name}),r.jsx("span",{className:"ml-2 text-gray-500",children:Rn(Y.size)})]}),r.jsx("button",{onClick:B,disabled:Me||!Pe.trim()&&!Y,className:`w-full py-2 text-sm font-medium rounded-lg text-white ${Me?"bg-indigo-400 cursor-not-allowed":"bg-indigo-600 hover:bg-indigo-700"}`,children:Me?"Posting...":"Post Update"})]}),r.jsx("div",{className:"space-y-6",children:be.length===0?r.jsx("p",{className:"text-center text-gray-500",children:"No activities yet"}):be.map(c=>r.jsxs("div",{className:"flex gap-3",children:[r.jsx("div",{className:"w-9 h-9 bg-teal-600 text-white rounded-full flex items-center justify-center font-bold text-sm shrink-0",children:(c.user_name||"U").charAt(0).toUpperCase()}),r.jsxs("div",{className:"flex-1 space-y-1.5",children:[r.jsxs("p",{className:"text-sm leading-relaxed",children:[r.jsx("strong",{className:"text-gray-900",children:c.user_name||"User"})," ",c.action,c.details&&c.action!=="commented"?r.jsxs(r.Fragment,{children:[" ",kt(c.details)]}):null]}),r.jsx("p",{className:"text-xs text-gray-500",children:_n(c.created_at)}),c.action==="commented"&&c.details&&r.jsx("div",{className:"mt-2 bg-white border border-gray-200 rounded-lg p-3 text-sm text-gray-700 whitespace-pre-wrap break-words",children:kt(c.details)}),(c.attachment_path||c.attachment_url)&&r.jsxs("button",{type:"button",onClick:()=>void ae(c),disabled:Be===c.id,className:"mt-2 inline-flex items-center gap-2 bg-white border border-gray-200 rounded-lg px-3 py-2 text-sm text-indigo-700 hover:bg-indigo-50 disabled:opacity-60",children:[r.jsx(Vn,{size:14}),r.jsx("span",{children:Be===c.id?"Opening...":c.attachment_name||"Attachment"}),c.attachment_size?r.jsxs("span",{className:"text-xs text-gray-500",children:["(",Rn(c.attachment_size),")"]}):null]}),r.jsx("button",{className:"text-xs text-gray-500 hover:text-gray-700 underline mt-1 transition",children:"Reply"})]})]},c.id))})]})]})]})]}),Ke&&r.jsx("div",{className:"fixed inset-0 bg-black/45 z-[65] flex items-center justify-center p-4",children:r.jsxs("div",{className:"w-full max-w-md rounded-2xl border border-gray-200 bg-white shadow-2xl overflow-hidden",children:[r.jsxs("div",{className:"px-5 py-4 border-b bg-gray-50 flex items-center justify-between",children:[r.jsx("h4",{className:"text-base font-semibold text-gray-900",children:"Activity Summary"}),r.jsx("button",{type:"button",onClick:()=>fe(!1),className:"h-8 w-8 rounded-md border border-gray-200 bg-white text-gray-600 hover:bg-gray-100 flex items-center justify-center",children:r.jsx(ot,{size:16})})]}),r.jsxs("div",{className:"p-5 space-y-3 text-sm text-gray-700",children:[r.jsxs("p",{children:[r.jsx("span",{className:"font-semibold text-gray-900",children:"Total activities:"})," ",ye.total]}),r.jsxs("p",{children:[r.jsx("span",{className:"font-semibold text-gray-900",children:"Comments:"})," ",ye.comments]}),r.jsxs("p",{children:[r.jsx("span",{className:"font-semibold text-gray-900",children:"Attachments:"})," ",ye.attachments]}),r.jsxs("p",{children:[r.jsx("span",{className:"font-semibold text-gray-900",children:"Label updates:"})," ",ye.labelUpdates]}),r.jsxs("p",{children:[r.jsx("span",{className:"font-semibold text-gray-900",children:"Payment updates:"})," ",ye.paymentUpdates]}),r.jsxs("p",{children:[r.jsx("span",{className:"font-semibold text-gray-900",children:"Last activity:"})," ",ye.latestAt?_n(ye.latestAt):"No activity yet"]})]}),r.jsx("div",{className:"px-5 py-4 border-t bg-gray-50 flex justify-end",children:r.jsx("button",{type:"button",onClick:()=>fe(!1),className:"px-4 py-2 rounded-lg bg-indigo-600 text-white text-sm font-medium hover:bg-indigo-700",children:"Close"})})]})}),Qe&&r.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[60] p-4",children:r.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md p-6",children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Select Due Date"}),r.jsx("button",{onClick:()=>we(!1),className:"text-gray-500 hover:text-gray-700",children:r.jsx(ot,{size:20})})]}),r.jsx(o.Suspense,{fallback:r.jsx("div",{className:"py-8 text-center text-gray-500",children:"Loading calendar..."}),children:r.jsx("div",{className:"flex justify-center mb-4",children:r.jsx(oa,{inline:!0,selected:K?new Date(K):null,onChange:c=>{ze(c?c.toISOString().split("T")[0]:"")},dateFormat:"yyyy-MM-dd"})})}),K?r.jsx("div",{className:"mb-4 text-sm text-gray-600",children:`Selected: ${$t(K)}`}):null,r.jsxs("div",{className:"flex justify-end gap-3",children:[r.jsx("button",{onClick:()=>ze(""),className:"px-5 py-2 text-sm text-gray-700 hover:bg-gray-100 rounded-lg",disabled:Q,children:"Clear"}),r.jsx("button",{onClick:()=>{we(!1),ze(Cn(e.due_date))},className:"px-5 py-2 text-sm text-gray-700 hover:bg-gray-100 rounded-lg",disabled:Q,children:"Cancel"}),r.jsx("button",{onClick:Ct,className:`px-6 py-2 text-sm font-medium text-white rounded-lg ${Q?"bg-indigo-400 cursor-not-allowed":"bg-indigo-600 hover:bg-indigo-700"}`,disabled:Q,children:Q?"Saving...":"Save Date"})]})]})}),Xe&&r.jsx("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-[60] p-4",children:r.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-xl max-h-[85vh] overflow-hidden flex flex-col",children:[r.jsxs("div",{className:"p-6 border-b flex items-center justify-between",children:[r.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Card Members"}),r.jsx("button",{onClick:()=>Le(!1),className:"text-gray-500 hover:text-gray-700",children:r.jsx(ot,{size:24})})]}),r.jsxs("div",{className:"p-6 space-y-4 flex-1 overflow-y-auto",children:[r.jsx("p",{className:"text-sm text-gray-600",children:"If no members are selected, everyone with board access can see this card."}),F&&r.jsx("input",{value:He,onChange:c=>at(c.target.value),placeholder:"Search user by name or email...",className:"w-full h-10 rounded-lg border border-gray-300 px-3 text-sm focus:outline-none focus:ring-2 focus:ring-indigo-400"}),H&&r.jsx("div",{className:"text-sm text-red-600 bg-red-50 border border-red-200 rounded-lg px-3 py-2",children:H}),rt?r.jsx("div",{className:"text-center py-10 text-gray-500",children:"Loading members..."}):r.jsx("div",{className:"border border-gray-200 rounded-xl overflow-hidden",children:et.length===0?r.jsx("div",{className:"py-8 text-center text-sm text-gray-500",children:"No users found for roles 2, 3, and 4."}):r.jsx("div",{className:"max-h-[330px] overflow-y-auto divide-y",children:et.map(c=>{const y=it.includes(c.id);return r.jsxs("label",{className:`flex items-center gap-3 px-4 py-3 ${F?"cursor-pointer hover:bg-gray-50":""}`,children:[r.jsx("input",{type:"checkbox",checked:y,disabled:!F||Ye,onChange:()=>De(c.id),className:"h-4 w-4 rounded text-indigo-600"}),r.jsxs("div",{className:"min-w-0",children:[r.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:he(c)}),c.email?r.jsx("p",{className:"text-xs text-gray-500 truncate",children:c.email}):null]})]},c.id)})})})]}),r.jsxs("div",{className:"p-5 border-t flex justify-end gap-3",children:[r.jsx("button",{onClick:()=>Le(!1),className:"px-5 py-2.5 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:"Close"}),F&&r.jsx("button",{onClick:Ie,disabled:Ye||rt,className:`px-6 py-2.5 rounded-lg text-white font-medium ${Ye||rt?"bg-indigo-400 cursor-not-allowed":"bg-indigo-600 hover:bg-indigo-700"}`,children:Ye?"Saving...":"Save Members"})]})]})}),d&&r.jsx("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-[60] p-4",children:r.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-lg max-h-[85vh] overflow-hidden flex flex-col",children:[r.jsxs("div",{className:"p-6 border-b flex items-center justify-between",children:[r.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Select Labels"}),r.jsx("button",{onClick:()=>u(!1),className:"text-gray-500 hover:text-gray-700",children:r.jsx(ot,{size:24})})]}),r.jsx("div",{className:"p-6 flex-1 overflow-y-auto space-y-8",children:$?r.jsx("div",{className:"text-center py-10 text-gray-500",children:"Loading labels..."}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("button",{type:"button",onClick:()=>void ft("country"),className:`px-3 py-1.5 rounded-md text-sm font-semibold border transition ${k==="country"?"bg-[#8f53c6] text-white border-[#8f53c6]":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:"Country"}),r.jsx("button",{type:"button",onClick:()=>void ft("intake"),className:`px-3 py-1.5 rounded-md text-sm font-semibold border transition ${k==="intake"?"bg-[#f2b205] text-[#4a2b00] border-[#f2b205]":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:"Intake"}),r.jsx("button",{type:"button",onClick:()=>void ft("serviceArea"),className:`px-3 py-1.5 rounded-md text-sm font-semibold border transition ${k==="serviceArea"?"bg-[#d63a3a] text-white border-[#d63a3a]":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:"Service Area"})]}),k==="country"?r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Country (multi-select)"}),r.jsx("div",{className:"max-h-64 overflow-y-auto border border-gray-200 rounded-lg divide-y",children:C.length===0?r.jsx("div",{className:"px-4 py-6 text-sm text-gray-500 text-center",children:"No countries found"}):C.map(c=>{const y=h.includes(c.id);return r.jsxs("label",{className:"flex items-center gap-3 px-4 py-2.5 hover:bg-gray-50 cursor-pointer",children:[r.jsx("input",{type:"checkbox",checked:y,onChange:()=>Vt(c.id,m),className:"h-4 w-4 rounded text-indigo-600"}),r.jsx("span",{className:"text-sm text-gray-800",children:c.name})]},c.id)})})]}):k==="intake"?r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Intake / Semester"}),r.jsxs("select",{value:g??"",onChange:c=>p(c.target.value?Number(c.target.value):null),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",children:[r.jsx("option",{value:"",children:"Select an intake"}),R.map(c=>r.jsx("option",{value:c.id,children:c.name},c.id))]})]}):r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Service Area (multi-select)"}),r.jsx("div",{className:"max-h-64 overflow-y-auto border border-gray-200 rounded-lg divide-y",children:M.length===0?r.jsx("div",{className:"px-4 py-6 text-sm text-gray-500 text-center",children:"No service areas found"}):M.map(c=>{const y=N.includes(c.id);return r.jsxs("label",{className:"flex items-center gap-3 px-4 py-2.5 hover:bg-gray-50 cursor-pointer",children:[r.jsx("input",{type:"checkbox",checked:y,onChange:()=>Vt(c.id,v),className:"h-4 w-4 rounded text-indigo-600"}),r.jsx("span",{className:"text-sm text-gray-800",children:c.name})]},c.id)})})]})]})}),r.jsxs("div",{className:"p-5 border-t flex justify-end gap-4",children:[r.jsx("button",{onClick:()=>u(!1),className:"px-6 py-2.5 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:"Cancel"}),r.jsx("button",{onClick:dn,className:"px-6 py-2.5 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 font-medium",children:"Save"})]})]})})]})}function ca({card:e,onClick:t,labelBadges:n=[],dragDisabled:s=!1}){const{setNodeRef:a,attributes:l,listeners:d,transform:u,transition:h}=ra({id:e.id,disabled:s}),m={transform:mt.Transform.toString(u),transition:h},p=`${e.invoice||`ID-${e.id}`} ${e.first_name||""} ${e.last_name||""}`.trim(),N=n.filter(v=>v.kind==="country"||v.kind==="intake");return r.jsxs("div",{ref:a,style:m,...l,...d,onClick:()=>t(e),className:`relative bg-white rounded-xl border border-gray-200 px-3 py-2.5 shadow-sm transition-shadow select-none ${s?"cursor-default":"cursor-pointer hover:shadow-md"}`,children:[r.jsx("button",{className:"absolute right-2.5 top-2.5 p-1.5 rounded-md hover:bg-gray-100 shrink-0",children:r.jsx(rr,{size:16,className:"text-gray-600"})}),r.jsxs("div",{className:"min-w-0",children:[r.jsx("div",{className:"pr-9",children:r.jsx("p",{className:"text-sm font-bold text-indigo-700",children:p})}),(N.length>0||e.members&&e.members.length>0)&&r.jsxs("div",{className:"mt-2 flex w-full items-start gap-2",children:[N.length>0?r.jsxs("div",{className:"flex min-w-0 flex-1 flex-wrap items-center gap-1.5",children:[r.jsx(ls,{size:12,className:"text-gray-500"}),N.map((v,k)=>r.jsx("span",{className:`px-2 py-0.5 rounded-md text-[10px] font-semibold ${v.kind==="country"?"bg-[#8f53c6] text-white":"bg-[#f2b205] text-[#4a2b00]"}`,children:v.name},`${v.kind}-${v.name}-${k}`))]}):r.jsx("div",{className:"flex-1"}),e.members&&e.members.length>0?r.jsxs("div",{className:"ml-auto -mr-1 flex shrink-0 flex-row-reverse items-center justify-end -space-x-1 space-x-reverse",children:[e.members.slice(0,3).map((v,k)=>r.jsx("div",{className:`h-5 w-5 rounded-full border border-white text-white text-[9px] font-semibold flex items-center justify-center ${nr[(v.id+k)%nr.length]}`,title:`${v.first_name||""} ${v.last_name||""}`.trim()||"Member",children:aa(v)},`card-${e.id}-member-${v.id}`)),e.members.length>3&&r.jsxs("div",{className:"mr-1 text-[10px] font-semibold text-gray-500",children:["+",e.members.length-3]})]}):null]})]})]})}function da({list:e,children:t}){const{setNodeRef:n}=kr({id:`list-${e.id}`});return r.jsx("div",{ref:n,className:"w-80 bg-white/90 backdrop-blur-sm rounded-xl border border-gray-200 shadow-md flex flex-col min-h-[120px]",children:t})}function va(){const{boardId:e}=Pr(),t=Br(),[n,s]=o.useState(null),[a,l]=o.useState(!0),[d,u]=o.useState(null),[h,m]=o.useState(null),[g,p]=o.useState(null),[N,v]=o.useState(!1),[k,j]=o.useState(""),[C,D]=o.useState(0),[R,_]=o.useState(null),[M,L]=o.useState(""),[$,S]=o.useState(""),[A,O]=o.useState(""),[V,T]=o.useState(null),[re,te]=o.useState(""),[ce,Qe]=o.useState(null),[we,K]=o.useState(""),[ze,Q]=o.useState(null),[Ne,je]=o.useState(!1),[se,de]=o.useState(!1),[ue,Ce]=o.useState(!1),[G,Fe]=o.useState("all"),[Se,ge]=o.useState([]),[I,ke]=o.useState(!1),[J,Ke]=o.useState(null),[fe,Re]=o.useState([]),[be,gt]=o.useState(!1),[Pe,nt]=o.useState(null),[Y,We]=o.useState([]),[Ee,lt]=o.useState([]),[Me,xt]=o.useState([]),[Be,Ue]=o.useState("all"),[Xe,Le]=o.useState([]),[rt,Te]=o.useState([]),[Ye,bt]=o.useState([]),[st,ct]=o.useState({}),[dt,yt]=o.useState({}),[it,pt]=o.useState({}),He=o.useRef(null),at=o.useRef(null),H=o.useRef(null),W=o.useDeferredValue(we.trim().toLowerCase()),F=W.length>0,ne=W==="*",B=Y.length>0||Ee.length>0||Me.length>0||Be!=="all",ae=ne||B,he=(i,f)=>{f(x=>x.includes(i)?x.filter(b=>b!==i):[...x,i])},Ze=Cs(js(In,{activationConstraint:{distance:6}})),P=async()=>{try{const i=await U.get(`/boards/${e}`,{params:{with:"lists.cards"}}),f=i.data.data||i.data;f.lists=[...f.lists||[]].sort((x,b)=>x.position-b.position),f.lists.forEach(x=>{x.cards=[...x.cards||[]].sort((b,w)=>b.position-w.position)}),s(f)}catch(i){console.error("Fetch board failed",i)}},$e=async()=>{if(e){gt(!0);try{const i=await U.get(`/boards/${e}/archived-cards`);Re(Array.isArray(i.data)?i.data:[])}catch(i){console.error("Fetch archived cards failed",i),alert("Could not load archived cards.")}finally{gt(!1)}}},De=async()=>{de(!0),await $e()},Ie=async(i=G)=>{var f;if(e){ke(!0);try{const x=await U.get(`/boards/${e}/activities`,{params:{tab:i,limit:300}}),b=Array.isArray((f=x.data)==null?void 0:f.data)?x.data.data:Array.isArray(x.data)?x.data:[];ge(b)}catch(x){console.error("Fetch board activities failed",x),alert("Could not load board activities.")}finally{ke(!1)}}},et=()=>{Ce(!0)},ye=async i=>{nt(i);try{await U.put(`/cards/${i}/archive`,{is_archived:!1}),Re(f=>f.filter(x=>x.id!==i)),await P()}catch(f){console.error("Restore archived card failed",f),alert("Could not restore card.")}finally{nt(null)}};o.useEffect(()=>{(async()=>{l(!0);try{const[,f]=await Promise.all([P(),Ur()]);u(f)}finally{l(!1)}})()},[e]),o.useEffect(()=>{(async()=>{try{const[f,x,b]=await Promise.all([U.get("/country-labels"),U.get("/intake-labels"),U.get("/service-areas")]),w=q=>Array.isArray(q==null?void 0:q.data)?q.data:Array.isArray(q)?q:[],oe=w(f.data),xe=w(x.data),pe=w(b.data);Le(oe),Te(xe),bt(pe),ct(oe.reduce((q,Oe)=>(q[Oe.id]=Oe.name,q),{})),yt(xe.reduce((q,Oe)=>(q[Oe.id]=Oe.name,q),{})),pt(pe.reduce((q,Oe)=>(q[Oe.id]=Oe.name,q),{}))}catch(f){console.error("Failed to load label maps",f)}})()},[]),o.useEffect(()=>{const i=()=>{window.setTimeout(()=>{var b,w;(b=at.current)==null||b.focus(),(w=at.current)==null||w.select()},0)},f=b=>{if(!(b instanceof HTMLElement))return!1;const w=b.tagName.toLowerCase();return w==="input"||w==="textarea"||w==="select"||b.isContentEditable},x=b=>{var xe,pe;const w=b.key.toLowerCase(),oe=f(b.target);if((b.ctrlKey||b.metaKey)&&w==="k"){b.preventDefault(),(xe=He.current)==null||xe.focus(),(pe=He.current)==null||pe.select();return}if(b.key==="Escape"&&document.activeElement===He.current){K("");return}if(b.key==="Escape"&&ue){Ce(!1);return}if(b.key==="Escape"&&Ne){je(!1);return}if(!(b.ctrlKey||b.metaKey||b.altKey)){if(!oe&&w==="f"){b.preventDefault(),je(!0),i();return}if(b.key==="*"||b.code==="NumpadMultiply"){if(oe&&document.activeElement!==at.current)return;b.preventDefault(),je(!0),K("*"),i()}}};return window.addEventListener("keydown",x),()=>window.removeEventListener("keydown",x)},[ue,Ne]),o.useEffect(()=>{if(!Ne)return;const i=f=>{H.current&&(H.current.contains(f.target)||je(!1))};return document.addEventListener("mousedown",i),()=>document.removeEventListener("mousedown",i)},[Ne]),o.useEffect(()=>{ue&&Ie(G)},[ue,G,e]);const Ae=i=>{if(!n)return"Unknown";const f=n.lists.find(x=>x.id===i.board_list_id);return(f==null?void 0:f.title)||"Unknown"},tt=i=>{const f=[];return(Array.isArray(i.country_label_ids)&&i.country_label_ids.length>0?i.country_label_ids:i.country_label_id!=null?[i.country_label_id]:[]).forEach(w=>{f.push({name:st[w]||`Country #${w}`,kind:"country"})}),i.intake_label_id!=null&&f.push({name:dt[i.intake_label_id]||`Intake #${i.intake_label_id}`,kind:"intake"}),(Array.isArray(i.service_area_ids)&&i.service_area_ids.length>0?i.service_area_ids:i.service_area_id!=null?[i.service_area_id]:[]).forEach(w=>{f.push({name:it[w]||`Service Area #${w}`,kind:"serviceArea"})}),f},ut=i=>{var w;const f=i.card;if(!f)return i.card_id?`Card #${i.card_id}`:"Card";const x=`${f.first_name||""} ${f.last_name||""}`.trim(),b=((w=f.invoice)==null?void 0:w.trim())||"";return b&&x?`${b} ${x}`:b||x||`Card #${f.id}`},Ut=i=>{var f,x,b,w,oe;return(f=i.list)!=null&&f.title?i.list.title:(b=(x=i.card)==null?void 0:x.boardList)!=null&&b.title?i.card.boardList.title:(oe=(w=i.card)==null?void 0:w.board_list)!=null&&oe.title?i.card.board_list.title:i.list_id?`List #${i.list_id}`:"Board"},ft=/((?:https?:\/\/|www\.)[^\s]+)/gi,Vt=i=>/^(?:https?:\/\/|www\.)[^\s]+$/i.test(i),dn=i=>/^https?:\/\//i.test(i)?i:`https://${i}`,Kt=i=>{if(!i)return null;const f=i.split(/\r?\n/);return f.map((x,b)=>r.jsxs("span",{children:[x.split(ft).map((w,oe)=>{if(!w)return null;if(!Vt(w))return r.jsx("span",{children:w},`activity-text-${b}-${oe}`);const xe=w.match(/^(.*?)([.,!?)]*)$/),pe=(xe==null?void 0:xe[1])||w,q=(xe==null?void 0:xe[2])||"";return r.jsxs("span",{children:[r.jsx("a",{href:dn(pe),target:"_blank",rel:"noopener noreferrer",className:"text-indigo-600 hover:text-indigo-700 underline break-all",children:pe}),q]},`activity-link-${b}-${oe}`)}),b<f.length-1?r.jsx("br",{}):null]},`activity-line-${b}`))},Wt=async i=>{if(!(!i.attachment_path&&!i.attachment_url))try{Ke(i.id);const f=await U.get(`/activities/${i.id}/attachment`,{responseType:"blob"}),x=new Blob([f.data],{type:i.attachment_mime||f.headers["content-type"]||"application/octet-stream"}),b=window.URL.createObjectURL(x),w=document.createElement("a");w.href=b,w.target="_blank",i.attachment_name&&(w.download=i.attachment_name),document.body.appendChild(w),w.click(),w.remove(),window.URL.revokeObjectURL(b)}catch(f){console.error("Open board activity attachment failed",f),alert("Could not open attachment.")}finally{Ke(null)}},Ct=async(i,f,x,b)=>{try{await U.post("/activities",{card_id:x??null,list_id:b??null,action:i,details:f})}catch(w){console.error("Failed to log activity:",w)}},un=async()=>{if(!k.trim()||!n)return;const i=n.lists.length+1,f={id:Date.now(),board_id:n.id,title:k.trim(),category:C,position:i,created_at:new Date().toISOString(),updated_at:new Date().toISOString(),cards:[]};s(x=>x?{...x,lists:[...x.lists,f]}:null),j(""),D(0),v(!1);try{const b=(await U.post(`/boards/${n.id}/lists`,{title:f.title,category:f.category??0,position:i})).data.id;await Ct("created list",`List: ${f.title}`,void 0,b),await P()}catch(x){console.error("Create list failed",x),await P()}},St=Number(d==null?void 0:d.role_id)===1,fn=i=>{!St||ce!==null||(T(i.id),te(i.title))},Xt=async i=>{if(!n)return;const f=re.trim();if(!f){te(i.title),T(null);return}if(f===i.title){T(null);return}Qe(i.id);try{await U.put(`/boards/${n.id}/lists/${i.id}`,{title:f}),s(x=>x&&{...x,lists:x.lists.map(b=>b.id===i.id?{...b,title:f}:b)}),T(null)}catch(x){console.error("Update list title failed",x),alert("Could not update list title."),te(i.title)}finally{Qe(null)}},hn=async i=>{if(!M.trim()){alert("Invoice is required.");return}const f={invoice:M.trim(),first_name:$.trim()||void 0,last_name:A.trim()||void 0};try{const b=(await U.post(`/board-lists/${i}/cards`,f)).data.id;await Ct("created card",`Card: ${f.invoice} ${f.first_name||""} ${f.last_name||""}`.trim(),b),L(""),S(""),O(""),_(null),await P()}catch(x){console.error("Create card failed",x),alert("Could not create card. Please check invoice uniqueness.")}},mn=()=>{L(""),S(""),O(""),_(null)},gn=i=>{if(F||B||!n)return;const f=Number(i.active.id);for(const x of n.lists){const b=x.cards.find(w=>w.id===f);if(b){p(b);break}}},xn=async i=>{var q,Oe;if(F||B||(p(null),!n||!i.over))return;const f=Number(i.active.id);let x,b;for(const me of n.lists){const _e=me.cards.find(At=>At.id===f);if(_e){x=me,b=_e;break}}if(!x||!b)return;let w;if(String(i.over.id).startsWith("list-")){const me=Number(String(i.over.id).replace("list-",""));w=n.lists.find(_e=>_e.id===me)}else w=n.lists.find(me=>me.cards.some(_e=>_e.id===Number(i.over.id)));if(!w||x.id===w.id)return;if((w.category??0)===1&&!b.payment_done){Q("This card is unpaid. Mark visa payment as done before moving it to Visa.");return}if((w.category??0)===2&&!b.dependant_payment_done){Q("Dependant payment is pending. Mark dependant payment as done before moving it to Dependant Visa.");return}const pe={...n,lists:n.lists.map(me=>({...me,cards:me.cards.map(_e=>({..._e}))}))};x.cards=x.cards.filter(me=>me.id!==b.id),b.position=w.cards.length+1,w.cards.push(b),s({...n});try{await U.post("/cards/move",{card_id:b.id,to_list_id:w.id,position:b.position}),await Ct("moved card",`from ${x.title} to ${w.title}`,b.id),await P()}catch(me){s(pe);const _e=(Oe=(q=me==null?void 0:me.response)==null?void 0:q.data)==null?void 0:Oe.message;typeof _e=="string"&&_e.toLowerCase().includes("payment")&&Q(_e)}},{admissionLists:Yt,visaLists:Ht,dependantVisaLists:kt,totalMatchedCards:Dt}=o.useMemo(()=>{if(!n)return{admissionLists:[],visaLists:[],dependantVisaLists:[],totalMatchedCards:0};const i=new Date,f=new Date(i.getFullYear(),i.getMonth(),i.getDate()),b=(f.getDay()+6)%7,w=new Date(f);w.setDate(f.getDate()-b);const oe=new Date(w);oe.setDate(w.getDate()+6);const pe=F&&!(W==="*"),q=pe?W.split(/\s+/).filter(Boolean):[],Oe=q.some(E=>["paid","done","unpaid","pending"].includes(E)),me=E=>{if(Be==="all")return!0;const Z=ia(E.due_date);return Z?Be==="today"?Z.toDateString()===f.toDateString():Be==="this_week"?Z>=w&&Z<=oe:Be==="overdue"?Z<f:!0:!1},_e=E=>{const Z=Array.isArray(E.country_label_ids)&&E.country_label_ids.length>0?E.country_label_ids:E.country_label_id!=null?[E.country_label_id]:[],_t=Array.isArray(E.service_area_ids)&&E.service_area_ids.length>0?E.service_area_ids:E.service_area_id!=null?[E.service_area_id]:[];if(Y.length>0&&!Z.some(ee=>Y.includes(ee))||Ee.length>0&&(E.intake_label_id==null||!Ee.includes(E.intake_label_id))||Me.length>0&&!_t.some(ee=>Me.includes(ee))||!me(E))return!1;if(!pe)return!0;const pn=Z.map(ee=>st[ee]||"").filter(Boolean).join(" "),bn=E.intake_label_id!=null&&dt[E.intake_label_id]||"",yn=_t.map(ee=>it[ee]||"").filter(Boolean).join(" "),Ir=E.payment_done?"visa payment paid done":"visa payment unpaid pending",Or=E.dependant_payment_done?"dependant payment dependant-paid dependant-done":"dependant payment dependant-unpaid dependant-pending",zr=[E.invoice,E.first_name,E.last_name,E.title,E.description,pn,bn,yn,Ir,Or].filter(ee=>!!ee).join(" ").toLowerCase();return q.every(ee=>ee==="paid"||ee==="done"?E.payment_done===!0:ee==="unpaid"||ee==="pending"?E.payment_done!==!0:ee==="dependant-paid"||ee==="dependent-paid"||ee==="dependant-done"?E.dependant_payment_done===!0:ee==="dependant-unpaid"||ee==="dependent-unpaid"||ee==="dependant-pending"?E.dependant_payment_done!==!0:zr.includes(ee))},At=E=>E.map(Z=>{const _t=Z.cards.length;if(!pe&&!B)return{...Z,cards:[...Z.cards],totalCards:_t,matchedByTitle:!1};const pn=pe&&!B&&!Oe&&Z.title.toLowerCase().includes(W),bn=Z.cards.filter(yn=>_e(yn));return{...Z,cards:bn,totalCards:_t,matchedByTitle:pn}}).filter(Z=>!pe&&!B?!0:B?Z.cards.length>0:Z.matchedByTitle||Z.cards.length>0),Mr=n.lists.filter(E=>(E.category??0)===0),Lr=n.lists.filter(E=>E.category===1),Tr=n.lists.filter(E=>E.category===2),zn=At(Mr),Fn=At(Lr),Pn=At(Tr),$r=[...zn,...Fn,...Pn];return{admissionLists:zn,visaLists:Fn,dependantVisaLists:Pn,totalMatchedCards:$r.reduce((E,Z)=>E+Z.cards.length,0)}},[n,W,F,B,Be,Y,Ee,Me,st,dt,it]),c=o.useMemo(()=>{if(!n||n.lists.length===0)return null;const i=[...n.lists].filter(f=>(f.category??0)===0).sort((f,x)=>f.position-x.position)[0];return(i==null?void 0:i.id)??null},[n]);if(a)return r.jsx(Vr,{message:"Loading board..."});if(!n)return null;const y=(i,f)=>r.jsxs(da,{list:i,children:[r.jsxs("div",{className:"p-4 pb-2",children:[r.jsxs("div",{className:"flex justify-between items-center gap-2 mb-3",children:[V===i.id?r.jsx("input",{autoFocus:!0,value:re,onChange:x=>te(x.target.value),onBlur:()=>void Xt(i),onKeyDown:x=>{x.key==="Enter"&&(x.preventDefault(),Xt(i)),x.key==="Escape"&&(te(i.title),T(null))},disabled:ce===i.id,className:"h-9 w-full rounded-md border border-indigo-300 bg-white px-3 text-base font-semibold text-gray-900 focus:outline-none focus:ring-2 focus:ring-indigo-400"}):r.jsx("h3",{className:`font-semibold text-lg truncate ${St?"cursor-text hover:underline underline-offset-4":""} ${F&&i.matchedByTitle?"text-indigo-700":""}`,onClick:()=>fn(i),title:St?"Click to edit list title":void 0,children:i.title}),r.jsx("div",{className:"flex items-center gap-2 shrink-0",children:ae&&r.jsxs("span",{className:"px-2 py-0.5 rounded-full bg-indigo-50 text-indigo-700 text-xs font-semibold whitespace-nowrap",children:[i.cards.length," ",i.cards.length===1?"card":"cards"," match"]})})]}),r.jsx(Gi,{items:i.cards.map(x=>x.id),strategy:Hi,children:r.jsx("div",{className:"space-y-3",children:i.cards.map(x=>r.jsx(ca,{card:x,onClick:()=>m(x),labelBadges:tt(x),dragDisabled:F||B},x.id))})})]}),f?r.jsx("div",{className:"p-3 pt-0",children:R===i.id?r.jsxs("div",{className:"bg-white rounded-lg border p-3 shadow-sm",children:[r.jsx("input",{value:M,onChange:x=>L(x.target.value),placeholder:"Invoice",className:"w-full border rounded-md px-3 py-2 text-sm focus:ring-2 focus:ring-indigo-400 outline-none mb-3"}),r.jsxs("div",{className:"grid grid-cols-2 gap-2 mb-3",children:[r.jsx("input",{value:$,onChange:x=>S(x.target.value),placeholder:"First name",className:"w-full border rounded-md px-3 py-2 text-sm focus:ring-2 focus:ring-indigo-400 outline-none"}),r.jsx("input",{value:A,onChange:x=>O(x.target.value),placeholder:"Last name",className:"w-full border rounded-md px-3 py-2 text-sm focus:ring-2 focus:ring-indigo-400 outline-none"})]}),r.jsxs("div",{className:"flex gap-3 mt-4",children:[r.jsx("button",{onClick:()=>hn(i.id),className:"flex-1 bg-indigo-600 text-white py-2 rounded-md text-sm font-medium",children:"Add card"}),r.jsx("button",{onClick:mn,className:"flex-1 bg-gray-200 text-gray-800 py-2 rounded-md text-sm font-medium hover:bg-gray-300",children:"Cancel"})]})]}):r.jsxs("button",{onClick:()=>_(i.id),className:"w-full flex items-center gap-2 text-gray-600 hover:bg-gray-100 rounded-lg px-2 py-2 text-sm",children:[r.jsx(Sn,{size:16})," Add a card"]})}):r.jsx("div",{className:"h-12"})]},i.id);return r.jsxs("div",{className:"h-screen flex flex-col bg-gray-50 overflow-hidden",children:[r.jsxs("header",{className:"h-14 bg-white border-b shadow-sm flex items-center justify-between px-4 gap-4",children:[r.jsx("div",{className:"flex items-center gap-4",children:r.jsx("button",{type:"button",onClick:()=>t("/"),className:"h-8 flex items-center cursor-pointer",title:"Go to home",children:r.jsx("img",{src:"/images/logo/connected_logo.png",alt:"Connected Logo",className:"h-8 w-auto object-contain"})})}),r.jsx("div",{className:"flex-1 max-w-2xl mx-6",children:r.jsxs("div",{className:"relative",children:[r.jsx(Kr,{size:15,className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 pointer-events-none"}),r.jsx("input",{ref:He,value:we,onChange:i=>K(i.target.value),placeholder:"Search cards, invoice, student, list title (Ctrl+K)",className:"w-full h-9 pl-9 pr-9 rounded-lg bg-gray-100 border text-sm focus:ring-2 focus:ring-indigo-400/40 outline-none"}),we&&r.jsx("button",{type:"button",onClick:()=>{var i;K(""),(i=He.current)==null||i.focus()},className:"absolute right-2.5 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600","aria-label":"Clear search",children:r.jsx(ot,{size:14})})]})}),r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsxs("div",{className:"relative",ref:H,children:[r.jsxs("button",{type:"button",onClick:()=>je(i=>!i),className:`flex items-center gap-1.5 px-3 py-1.5 border rounded-lg text-sm font-medium transition ${B?"bg-indigo-50 border-indigo-300 text-indigo-700":"bg-white border-gray-300 text-gray-700 hover:bg-gray-50"}`,children:[r.jsx(ns,{size:15}),"Filter"]}),Ne&&r.jsxs("div",{className:"absolute right-0 mt-2 w-80 rounded-xl border border-gray-200 bg-white shadow-xl p-4 z-50 space-y-3",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("p",{className:"text-sm font-semibold text-gray-800",children:"Card Filters"}),r.jsx("button",{type:"button",onClick:()=>{K(""),We([]),lt([]),xt([]),Ue("all")},className:"text-xs text-indigo-600 hover:text-indigo-800 font-medium",children:"Reset"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Search"}),r.jsx("input",{ref:at,value:we,onChange:i=>K(i.target.value),placeholder:"Type to filter cards, use * for all cards",className:"h-9 w-full rounded-md border border-gray-300 px-2.5 text-sm text-gray-800 focus:outline-none focus:ring-2 focus:ring-indigo-300"})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:["Country (",Y.length,")"]}),r.jsx("div",{className:"max-h-28 overflow-y-auto rounded-md border border-gray-300 bg-white",children:Xe.length===0?r.jsx("div",{className:"px-2.5 py-2 text-xs text-gray-500",children:"No options"}):Xe.map(i=>r.jsxs("label",{className:"flex items-center gap-2 px-2.5 py-1.5 text-sm text-gray-800 hover:bg-gray-50 cursor-pointer",children:[r.jsx("input",{type:"checkbox",checked:Y.includes(i.id),onChange:()=>he(i.id,We),className:"h-3.5 w-3.5 rounded text-indigo-600"}),r.jsx("span",{children:i.name})]},`country-filter-${i.id}`))})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:["Intake (",Ee.length,")"]}),r.jsx("div",{className:"max-h-28 overflow-y-auto rounded-md border border-gray-300 bg-white",children:rt.length===0?r.jsx("div",{className:"px-2.5 py-2 text-xs text-gray-500",children:"No options"}):rt.map(i=>r.jsxs("label",{className:"flex items-center gap-2 px-2.5 py-1.5 text-sm text-gray-800 hover:bg-gray-50 cursor-pointer",children:[r.jsx("input",{type:"checkbox",checked:Ee.includes(i.id),onChange:()=>he(i.id,lt),className:"h-3.5 w-3.5 rounded text-indigo-600"}),r.jsx("span",{children:i.name})]},`intake-filter-${i.id}`))})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:["Service (",Me.length,")"]}),r.jsx("div",{className:"max-h-28 overflow-y-auto rounded-md border border-gray-300 bg-white",children:Ye.length===0?r.jsx("div",{className:"px-2.5 py-2 text-xs text-gray-500",children:"No options"}):Ye.map(i=>r.jsxs("label",{className:"flex items-center gap-2 px-2.5 py-1.5 text-sm text-gray-800 hover:bg-gray-50 cursor-pointer",children:[r.jsx("input",{type:"checkbox",checked:Me.includes(i.id),onChange:()=>he(i.id,xt),className:"h-3.5 w-3.5 rounded text-indigo-600"}),r.jsx("span",{children:i.name})]},`service-filter-${i.id}`))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Due Date"}),r.jsxs("select",{value:Be,onChange:i=>Ue(i.target.value),className:"h-9 w-full rounded-md border border-gray-300 px-2.5 text-sm text-gray-800 focus:outline-none focus:ring-2 focus:ring-indigo-300",children:[r.jsx("option",{value:"all",children:"Select"}),r.jsx("option",{value:"this_week",children:"This Week"}),r.jsx("option",{value:"today",children:"Today"}),r.jsx("option",{value:"overdue",children:"Overdue"})]})]}),ae&&r.jsxs("div",{className:"pt-1 text-xs font-medium text-gray-600",children:[Dt," ",Dt===1?"card":"cards"," match current filters"]})]})]}),r.jsxs("button",{type:"button",onClick:et,className:`flex items-center gap-1.5 px-3 py-1.5 border rounded-lg text-sm font-medium transition ${ue?"bg-indigo-50 border-indigo-300 text-indigo-700":"bg-white border-gray-300 text-gray-700 hover:bg-gray-50"}`,children:[r.jsx(Bn,{size:15}),"Activity"]}),r.jsxs("button",{type:"button",onClick:()=>void De(),className:"flex items-center gap-1.5 px-3 py-1.5 border border-gray-300 bg-white rounded-lg text-sm font-medium text-gray-700 hover:bg-gray-50 transition",children:[r.jsx(sr,{size:15}),"Archived"]}),r.jsxs("button",{onClick:()=>v(!0),className:"flex items-center gap-1.5 px-4 py-1.5 bg-gradient-to-r from-indigo-600 to-blue-600 text-white text-sm rounded-lg shadow-md",children:[r.jsx(Sn,{size:16})," New List"]}),r.jsx("button",{type:"button",onClick:()=>t("/profile"),className:"h-8 px-3 rounded-full bg-gradient-to-r from-blue-600 to-indigo-600 text-white text-sm font-semibold flex items-center justify-center shadow-sm hover:opacity-95",title:"Edit profile",children:(d==null?void 0:d.first_name)||"User"})]})]}),r.jsxs("main",{className:"flex-1 flex flex-col overflow-hidden bg-gradient-to-br from-indigo-50 via-purple-50 to-pink-50 rounded-xl shadow-inner m-4",children:[r.jsx("div",{className:"h-16 bg-gradient-to-r from-purple-700 via-indigo-700 to-purple-800 text-white flex items-center justify-between px-6 rounded-t-xl",children:r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsx(Wr,{size:20}),r.jsx("h1",{className:"text-xl font-bold",children:n.name})]})}),r.jsxs(ki,{sensors:Ze,collisionDetection:Ts,onDragStart:gn,onDragEnd:xn,children:[r.jsx("div",{className:"flex-1 min-h-0 overflow-x-auto overflow-y-auto",children:r.jsxs("div",{className:"min-h-full p-6 flex gap-6 min-w-max",children:[r.jsxs("div",{className:"min-h-0 flex gap-6",children:[r.jsxs("div",{className:"min-w-[420px] flex flex-col gap-3",children:[r.jsx("div",{className:"inline-flex items-center gap-2 px-3 py-1 rounded-full bg-emerald-100 text-emerald-800 text-xs font-semibold uppercase tracking-wide",children:"Admission"}),r.jsx("div",{className:"flex-1",children:r.jsx("div",{className:"flex gap-6 min-w-max items-start pb-2 pr-2",children:Yt.length>0?Yt.map(i=>y(i,i.id===c)):r.jsx("div",{className:"w-80 h-28 rounded-xl border border-dashed border-emerald-300 bg-emerald-50/50 text-emerald-800 text-sm flex items-center justify-center",children:F||B?"No matching cards in admission":"No admission lists"})})})]}),r.jsx("div",{className:"self-stretch border-l-2 border-dotted border-indigo-300/70"}),r.jsxs("div",{className:"min-w-[420px] flex flex-col gap-3",children:[r.jsx("div",{className:"inline-flex items-center gap-2 px-3 py-1 rounded-full bg-amber-100 text-amber-800 text-xs font-semibold uppercase tracking-wide",children:"Visa"}),r.jsx("div",{className:"flex-1",children:r.jsx("div",{className:"flex gap-6 min-w-max items-start pb-2 pr-2",children:Ht.length>0?Ht.map(i=>y(i,i.id===c)):r.jsx("div",{className:"w-80 h-28 rounded-xl border border-dashed border-amber-300 bg-amber-50/50 text-amber-800 text-sm flex items-center justify-center",children:F||B?"No matching cards in visa":"No visa lists"})})})]}),r.jsx("div",{className:"self-stretch border-l-2 border-dotted border-indigo-300/70"}),r.jsxs("div",{className:"min-w-[420px] flex flex-col gap-3",children:[r.jsx("div",{className:"inline-flex items-center gap-2 px-3 py-1 rounded-full bg-rose-100 text-rose-800 text-xs font-semibold uppercase tracking-wide",children:"Dependant Visa"}),r.jsx("div",{className:"flex-1",children:r.jsx("div",{className:"flex gap-6 min-w-max items-start pb-2 pr-2",children:kt.length>0?kt.map(i=>y(i,i.id===c)):r.jsx("div",{className:"w-80 h-28 rounded-xl border border-dashed border-rose-300 bg-rose-50/50 text-rose-800 text-sm flex items-center justify-center",children:F||B?"No matching cards in dependant visa":"No dependant visa lists"})})})]})]}),N&&r.jsx("div",{className:"w-80 shrink-0 self-start",children:r.jsxs("div",{className:"bg-white rounded-xl p-4 border shadow-md",children:[r.jsxs("div",{className:"grid grid-cols-3 gap-2 mb-3",children:[r.jsx("button",{type:"button",onClick:()=>D(0),className:`h-9 rounded-md text-sm font-semibold border transition ${C===0?"bg-emerald-600 text-white border-emerald-600":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:"Admission"}),r.jsx("button",{type:"button",onClick:()=>D(1),className:`h-9 rounded-md text-sm font-semibold border transition ${C===1?"bg-amber-600 text-white border-amber-600":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:"Visa"}),r.jsx("button",{type:"button",onClick:()=>D(2),className:`h-9 rounded-md text-sm font-semibold border transition ${C===2?"bg-rose-600 text-white border-rose-600":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:"Dependant"})]}),r.jsx("input",{autoFocus:!0,value:k,onChange:i=>j(i.target.value),placeholder:"Enter list title...",className:"w-full border rounded-md px-3 py-2 text-sm"}),r.jsxs("div",{className:"flex gap-3 mt-3",children:[r.jsx("button",{onClick:un,className:"bg-indigo-600 text-white px-4 py-1.5 rounded-md",children:"Add list"}),r.jsx("button",{onClick:()=>{v(!1),j(""),D(0)},className:"text-sm text-gray-600 hover:underline",children:"Cancel"})]})]})})]})}),r.jsx(Ki,{children:g&&r.jsxs("div",{className:"w-80 bg-white rounded-xl p-3 shadow-2xl border border-gray-200",children:[r.jsxs("p",{className:"text-sm font-bold text-indigo-700",children:[g.invoice||`ID-${g.id}`," ",g.first_name||""," ",g.last_name||""]}),r.jsx("p",{className:"text-xs text-gray-500 mt-1",children:$t(g.created_at)})]})})]}),h&&r.jsx(la,{card:h,listTitle:Ae(h),profile:d,onClose:()=>m(null),setSelectedCard:m,fetchBoard:P}),se&&r.jsx("div",{className:"fixed inset-0 z-[70] bg-black/50 flex items-center justify-center p-4",children:r.jsxs("div",{className:"w-full max-w-3xl bg-white rounded-2xl shadow-2xl border border-gray-200 overflow-hidden",children:[r.jsxs("div",{className:"flex items-center justify-between px-5 py-4 border-b bg-gray-50",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Archived Cards"}),r.jsx("button",{onClick:()=>de(!1),className:"h-8 w-8 rounded-lg border border-gray-200 bg-white text-gray-600 hover:bg-gray-100 flex items-center justify-center",children:r.jsx(ot,{size:16})})]}),r.jsx("div",{className:"max-h-[60vh] overflow-y-auto p-4",children:be?r.jsx("div",{className:"py-10 text-center text-sm text-gray-500",children:"Loading archived cards..."}):fe.length===0?r.jsx("div",{className:"py-10 text-center text-sm text-gray-500",children:"No archived cards found."}):r.jsx("div",{className:"space-y-3",children:fe.map(i=>{var b,w;const f=((b=i.boardList)==null?void 0:b.title)||((w=i.board_list)==null?void 0:w.title)||"Unknown List",x=`${i.invoice||`ID-${i.id}`} ${i.first_name||""} ${i.last_name||""}`.trim();return r.jsxs("div",{className:"flex items-center justify-between gap-4 rounded-xl border border-gray-200 bg-white p-4",children:[r.jsxs("div",{className:"min-w-0",children:[r.jsx("p",{className:"text-sm font-semibold text-gray-900 truncate",children:x}),r.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[f,"  Archived on ",$t(i.updated_at)]})]}),r.jsxs("button",{type:"button",onClick:()=>void ye(i.id),disabled:Pe===i.id,className:`inline-flex items-center gap-1.5 px-3 py-1.5 rounded-lg text-sm font-medium border transition ${Pe===i.id?"bg-gray-100 text-gray-400 border-gray-200 cursor-not-allowed":"bg-emerald-50 text-emerald-700 border-emerald-200 hover:bg-emerald-100"}`,children:[r.jsx(as,{size:14}),Pe===i.id?"Restoring...":"Restore"]})]},i.id)})})}),r.jsx("div",{className:"px-5 py-4 border-t bg-gray-50 flex justify-end",children:r.jsx("button",{onClick:()=>de(!1),className:"px-4 py-2 rounded-lg bg-indigo-600 text-white text-sm font-medium hover:bg-indigo-700",children:"Close"})})]})}),ue&&r.jsx("div",{className:"fixed inset-0 z-[72] bg-black/50 flex items-center justify-center p-4",children:r.jsxs("div",{className:"w-full max-w-5xl bg-white rounded-2xl shadow-2xl border border-gray-200 overflow-hidden",children:[r.jsxs("div",{className:"flex items-center justify-between px-5 py-4 border-b bg-gray-50",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(Bn,{size:18,className:"text-indigo-600"}),r.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Board Activity"})]}),r.jsx("button",{type:"button",onClick:()=>Ce(!1),className:"h-8 w-8 rounded-lg border border-gray-200 bg-white text-gray-600 hover:bg-gray-100 flex items-center justify-center",children:r.jsx(ot,{size:16})})]}),r.jsx("div",{className:"px-5 pt-4 pb-3 border-b bg-white",children:r.jsxs("div",{className:"inline-flex rounded-lg border border-gray-200 bg-gray-50 p-1",children:[r.jsx("button",{type:"button",onClick:()=>Fe("all"),className:`px-3 py-1.5 rounded-md text-sm font-medium transition ${G==="all"?"bg-white text-gray-900 shadow-sm border border-gray-200":"text-gray-600 hover:text-gray-800"}`,children:"All"}),r.jsx("button",{type:"button",onClick:()=>Fe("comment"),className:`px-3 py-1.5 rounded-md text-sm font-medium transition ${G==="comment"?"bg-white text-gray-900 shadow-sm border border-gray-200":"text-gray-600 hover:text-gray-800"}`,children:"Comment"})]})}),r.jsx("div",{className:"max-h-[65vh] overflow-y-auto px-5 py-4",children:I?r.jsx("div",{className:"py-12 text-center text-sm text-gray-500",children:"Loading activity..."}):Se.length===0?r.jsxs("div",{className:"py-12 text-center text-sm text-gray-500",children:["No ",G==="comment"?"comments":"activities"," found."]}):r.jsx("div",{className:"space-y-3",children:Se.map(i=>r.jsx("div",{className:"rounded-xl border border-gray-200 bg-white p-4",children:r.jsxs("div",{className:"flex gap-3",children:[r.jsx("div",{className:"h-8 w-8 rounded-full bg-indigo-100 text-indigo-700 text-xs font-semibold flex items-center justify-center shrink-0",children:(i.user_name||"U").charAt(0).toUpperCase()}),r.jsxs("div",{className:"min-w-0 flex-1",children:[r.jsxs("div",{className:"text-sm text-gray-800",children:[r.jsx("strong",{className:"text-gray-900",children:i.user_name||"User"})," ",i.action]}),i.details?r.jsx("div",{className:`mt-1 text-sm leading-relaxed ${i.action==="commented"?"rounded-lg border border-gray-200 bg-gray-50 p-3 text-gray-700":"text-gray-700"}`,children:i.action==="commented"?r.jsxs("div",{className:"flex items-start gap-2",children:[r.jsx(ir,{size:14,className:"mt-0.5 text-gray-500 shrink-0"}),r.jsx("div",{className:"min-w-0",children:Kt(i.details)})]}):Kt(i.details)}):null,r.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-2 text-xs text-gray-500",children:[r.jsx("span",{children:_n(i.created_at)}),i.card_id?r.jsx("span",{className:"px-2 py-0.5 rounded-full bg-indigo-50 text-indigo-700 border border-indigo-100",children:ut(i)}):null,r.jsx("span",{className:"px-2 py-0.5 rounded-full bg-gray-100 text-gray-700 border border-gray-200",children:Ut(i)})]}),(i.attachment_path||i.attachment_url)&&r.jsxs("button",{type:"button",onClick:()=>void Wt(i),disabled:J===i.id,className:`mt-2 inline-flex items-center gap-1 rounded-md border px-2 py-1 text-xs transition ${J===i.id?"bg-gray-100 text-gray-400 border-gray-200 cursor-not-allowed":"bg-white text-indigo-700 border-indigo-200 hover:bg-indigo-50"}`,children:[J===i.id?"Opening...":i.attachment_name||"Attachment",i.attachment_size?r.jsxs("span",{className:"text-gray-500",children:["(",Rn(i.attachment_size),")"]}):null]})]})]})},i.id))})})]})}),ze&&r.jsx("div",{className:"fixed inset-0 z-[70] bg-black/50 flex items-center justify-center p-4",children:r.jsxs("div",{className:"w-full max-w-md bg-white rounded-2xl shadow-2xl border border-gray-200 overflow-hidden",children:[r.jsxs("div",{className:"flex items-center justify-between px-5 py-4 border-b bg-rose-50",children:[r.jsx("h3",{className:"text-lg font-semibold text-rose-800",children:"Move Blocked"}),r.jsx("button",{onClick:()=>Q(null),className:"h-8 w-8 rounded-lg border border-rose-200 bg-white text-rose-600 hover:bg-rose-100 flex items-center justify-center",children:r.jsx(ot,{size:16})})]}),r.jsx("div",{className:"px-5 py-4 text-sm text-gray-700",children:ze}),r.jsx("div",{className:"px-5 py-4 border-t bg-gray-50 flex justify-end",children:r.jsx("button",{onClick:()=>Q(null),className:"px-4 py-2 rounded-lg bg-indigo-600 text-white text-sm font-medium hover:bg-indigo-700",children:"OK"})})]})})]})]})}export{va as default};
