const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index.es-CTFh76Hg.js","assets/index-Co5bbTuF.js","assets/index-DQ5_dydk.css","assets/index-lxeEX4QK.js"])))=>i.map(i=>d[i]);
import{r as o,R as q,d as W,j as r,_ as bs,m as ys,u as vs,i as ws}from"./index-Co5bbTuF.js";import{r as Ht}from"./index-lxeEX4QK.js";import{L as Ns}from"./Loader-DqOQTjZz.js";import{c as Ke}from"./createLucideIcon-D0rn2eoO.js";import{X as bt}from"./x-kujMzfW9.js";import{P as bn}from"./plus-Do2C2VgG.js";import{S as Tr}from"./square-pen-CeJ8qFct.js";import{S as js}from"./search-DxjjfhKn.js";import{L as Cs}from"./layout-grid-BCF2Qhbv.js";/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ss=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],br=Ke("activity",Ss);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ks=[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]],Or=Ke("archive",ks);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ds=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]],As=Ke("calendar-days",Ds);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _s=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],Rs=Ke("chart-column",_s);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Es=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],yr=Ke("chevron-down",Es);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ms=[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]],vr=Ke("credit-card",Ms);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ls=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]],Is=Ke("ellipsis",Ls);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $s=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],Ts=Ke("funnel",$s);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Os=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],zs=Ke("globe",Os);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fs=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]],zr=Ke("message-square",Fs);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ps=[["path",{d:"m16 6-8.414 8.586a2 2 0 0 0 2.829 2.829l8.414-8.586a4 4 0 1 0-5.657-5.657l-8.379 8.551a6 6 0 1 0 8.485 8.485l8.379-8.551",key:"1miecu"}]],wr=Ke("paperclip",Ps);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bs=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],Us=Ke("rotate-ccw",Bs);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ws=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],Fr=Ke("tag",Ws);function Vs(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return o.useMemo(()=>s=>{t.forEach(i=>i(s))},t)}const Sn=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function Pt(e){const t=Object.prototype.toString.call(e);return t==="[object Window]"||t==="[object global]"}function sr(e){return"nodeType"in e}function Me(e){var t,n;return e?Pt(e)?e:sr(e)&&(t=(n=e.ownerDocument)==null?void 0:n.defaultView)!=null?t:window:window}function ir(e){const{Document:t}=Me(e);return e instanceof t}function Zt(e){return Pt(e)?!1:e instanceof Me(e).HTMLElement}function Pr(e){return e instanceof Me(e).SVGElement}function Bt(e){return e?Pt(e)?e.document:sr(e)?ir(e)?e:Zt(e)||Pr(e)?e.ownerDocument:document:document:document}const lt=Sn?o.useLayoutEffect:o.useEffect;function kn(e){const t=o.useRef(e);return lt(()=>{t.current=e}),o.useCallback(function(){for(var n=arguments.length,s=new Array(n),i=0;i<n;i++)s[i]=arguments[i];return t.current==null?void 0:t.current(...s)},[])}function Xs(){const e=o.useRef(null),t=o.useCallback((s,i)=>{e.current=setInterval(s,i)},[]),n=o.useCallback(()=>{e.current!==null&&(clearInterval(e.current),e.current=null)},[]);return[t,n]}function Jt(e,t){t===void 0&&(t=[e]);const n=o.useRef(e);return lt(()=>{n.current!==e&&(n.current=e)},t),n}function en(e,t){const n=o.useRef();return o.useMemo(()=>{const s=e(n.current);return n.current=s,s},[...t])}function yn(e){const t=kn(e),n=o.useRef(null),s=o.useCallback(i=>{i!==n.current&&(t==null||t(i,n.current)),n.current=i},[]);return[n,s]}function vn(e){const t=o.useRef();return o.useEffect(()=>{t.current=e},[e]),t.current}let Kn={};function tn(e,t){return o.useMemo(()=>{if(t)return t;const n=Kn[e]==null?0:Kn[e]+1;return Kn[e]=n,e+"-"+n},[e,t])}function Br(e){return function(t){for(var n=arguments.length,s=new Array(n>1?n-1:0),i=1;i<n;i++)s[i-1]=arguments[i];return s.reduce((l,d)=>{const u=Object.entries(d);for(const[f,h]of u){const m=l[f];m!=null&&(l[f]=m+e*h)}return l},{...t})}}const zt=Br(1),wn=Br(-1);function Ks(e){return"clientX"in e&&"clientY"in e}function Dn(e){if(!e)return!1;const{KeyboardEvent:t}=Me(e.target);return t&&e instanceof t}function Hs(e){if(!e)return!1;const{TouchEvent:t}=Me(e.target);return t&&e instanceof t}function Nn(e){if(Hs(e)){if(e.touches&&e.touches.length){const{clientX:t,clientY:n}=e.touches[0];return{x:t,y:n}}else if(e.changedTouches&&e.changedTouches.length){const{clientX:t,clientY:n}=e.changedTouches[0];return{x:t,y:n}}}return Ks(e)?{x:e.clientX,y:e.clientY}:null}const yt=Object.freeze({Translate:{toString(e){if(!e)return;const{x:t,y:n}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(n?Math.round(n):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;const{scaleX:t,scaleY:n}=e;return"scaleX("+t+") scaleY("+n+")"}},Transform:{toString(e){if(e)return[yt.Translate.toString(e),yt.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:n,easing:s}=e;return t+" "+n+"ms "+s}}}),Nr="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function Ys(e){return e.matches(Nr)?e:e.querySelector(Nr)}const qs={display:"none"};function Gs(e){let{id:t,value:n}=e;return q.createElement("div",{id:t,style:qs},n)}function Js(e){let{id:t,announcement:n,ariaLiveType:s="assertive"}=e;const i={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return q.createElement("div",{id:t,style:i,role:"status","aria-live":s,"aria-atomic":!0},n)}function Qs(){const[e,t]=o.useState("");return{announce:o.useCallback(s=>{s!=null&&t(s)},[]),announcement:e}}const Ur=o.createContext(null);function Zs(e){const t=o.useContext(Ur);o.useEffect(()=>{if(!t)throw new Error("useDndMonitor must be used within a children of <DndContext>");return t(e)},[e,t])}function ei(){const[e]=o.useState(()=>new Set),t=o.useCallback(s=>(e.add(s),()=>e.delete(s)),[e]);return[o.useCallback(s=>{let{type:i,event:l}=s;e.forEach(d=>{var u;return(u=d[i])==null?void 0:u.call(d,l)})},[e]),t]}const ti={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},ni={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was moved over droppable area "+n.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was dropped over droppable area "+n.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function ri(e){let{announcements:t=ni,container:n,hiddenTextDescribedById:s,screenReaderInstructions:i=ti}=e;const{announce:l,announcement:d}=Qs(),u=tn("DndLiveRegion"),[f,h]=o.useState(!1);if(o.useEffect(()=>{h(!0)},[]),Zs(o.useMemo(()=>({onDragStart(x){let{active:N}=x;l(t.onDragStart({active:N}))},onDragMove(x){let{active:N,over:v}=x;t.onDragMove&&l(t.onDragMove({active:N,over:v}))},onDragOver(x){let{active:N,over:v}=x;l(t.onDragOver({active:N,over:v}))},onDragEnd(x){let{active:N,over:v}=x;l(t.onDragEnd({active:N,over:v}))},onDragCancel(x){let{active:N,over:v}=x;l(t.onDragCancel({active:N,over:v}))}}),[l,t])),!f)return null;const m=q.createElement(q.Fragment,null,q.createElement(Gs,{id:s,value:i.draggable}),q.createElement(Js,{id:u,announcement:d}));return n?Ht.createPortal(m,n):m}var pe;(function(e){e.DragStart="dragStart",e.DragMove="dragMove",e.DragEnd="dragEnd",e.DragCancel="dragCancel",e.DragOver="dragOver",e.RegisterDroppable="registerDroppable",e.SetDroppableDisabled="setDroppableDisabled",e.UnregisterDroppable="unregisterDroppable"})(pe||(pe={}));function jn(){}function si(e,t){return o.useMemo(()=>({sensor:e,options:t??{}}),[e,t])}function ii(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return o.useMemo(()=>[...t].filter(s=>s!=null),[...t])}const ct=Object.freeze({x:0,y:0});function ar(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function ai(e,t){const n=Nn(e);if(!n)return"0 0";const s={x:(n.x-t.left)/t.width*100,y:(n.y-t.top)/t.height*100};return s.x+"% "+s.y+"%"}function or(e,t){let{data:{value:n}}=e,{data:{value:s}}=t;return n-s}function oi(e,t){let{data:{value:n}}=e,{data:{value:s}}=t;return s-n}function Qn(e){let{left:t,top:n,height:s,width:i}=e;return[{x:t,y:n},{x:t+i,y:n},{x:t,y:n+s},{x:t+i,y:n+s}]}function li(e,t){if(!e||e.length===0)return null;const[n]=e;return n[t]}function jr(e,t,n){return t===void 0&&(t=e.left),n===void 0&&(n=e.top),{x:t+e.width*.5,y:n+e.height*.5}}const ci=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:s}=e;const i=jr(t,t.left,t.top),l=[];for(const d of s){const{id:u}=d,f=n.get(u);if(f){const h=ar(jr(f),i);l.push({id:u,data:{droppableContainer:d,value:h}})}}return l.sort(or)},di=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:s}=e;const i=Qn(t),l=[];for(const d of s){const{id:u}=d,f=n.get(u);if(f){const h=Qn(f),m=i.reduce((N,v,R)=>N+ar(h[R],v),0),x=Number((m/4).toFixed(4));l.push({id:u,data:{droppableContainer:d,value:x}})}}return l.sort(or)};function ui(e,t){const n=Math.max(t.top,e.top),s=Math.max(t.left,e.left),i=Math.min(t.left+t.width,e.left+e.width),l=Math.min(t.top+t.height,e.top+e.height),d=i-s,u=l-n;if(s<i&&n<l){const f=t.width*t.height,h=e.width*e.height,m=d*u,x=m/(f+h-m);return Number(x.toFixed(4))}return 0}const fi=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:s}=e;const i=[];for(const l of s){const{id:d}=l,u=n.get(d);if(u){const f=ui(u,t);f>0&&i.push({id:d,data:{droppableContainer:l,value:f}})}}return i.sort(oi)};function hi(e,t){const{top:n,left:s,bottom:i,right:l}=t;return n<=e.y&&e.y<=i&&s<=e.x&&e.x<=l}const gi=e=>{let{droppableContainers:t,droppableRects:n,pointerCoordinates:s}=e;if(!s)return[];const i=[];for(const l of t){const{id:d}=l,u=n.get(d);if(u&&hi(s,u)){const h=Qn(u).reduce((x,N)=>x+ar(s,N),0),m=Number((h/4).toFixed(4));i.push({id:d,data:{droppableContainer:l,value:m}})}}return i.sort(or)};function mi(e,t,n){return{...e,scaleX:t&&n?t.width/n.width:1,scaleY:t&&n?t.height/n.height:1}}function Wr(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:ct}function xi(e){return function(n){for(var s=arguments.length,i=new Array(s>1?s-1:0),l=1;l<s;l++)i[l-1]=arguments[l];return i.reduce((d,u)=>({...d,top:d.top+e*u.y,bottom:d.bottom+e*u.y,left:d.left+e*u.x,right:d.right+e*u.x}),{...n})}}const pi=xi(1);function Vr(e){if(e.startsWith("matrix3d(")){const t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}else if(e.startsWith("matrix(")){const t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}function bi(e,t,n){const s=Vr(t);if(!s)return e;const{scaleX:i,scaleY:l,x:d,y:u}=s,f=e.left-d-(1-i)*parseFloat(n),h=e.top-u-(1-l)*parseFloat(n.slice(n.indexOf(" ")+1)),m=i?e.width/i:e.width,x=l?e.height/l:e.height;return{width:m,height:x,top:h,right:f+m,bottom:h+x,left:f}}const yi={ignoreTransform:!1};function Ut(e,t){t===void 0&&(t=yi);let n=e.getBoundingClientRect();if(t.ignoreTransform){const{transform:h,transformOrigin:m}=Me(e).getComputedStyle(e);h&&(n=bi(n,h,m))}const{top:s,left:i,width:l,height:d,bottom:u,right:f}=n;return{top:s,left:i,width:l,height:d,bottom:u,right:f}}function Cr(e){return Ut(e,{ignoreTransform:!0})}function vi(e){const t=e.innerWidth,n=e.innerHeight;return{top:0,left:0,right:t,bottom:n,width:t,height:n}}function wi(e,t){return t===void 0&&(t=Me(e).getComputedStyle(e)),t.position==="fixed"}function Ni(e,t){t===void 0&&(t=Me(e).getComputedStyle(e));const n=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(i=>{const l=t[i];return typeof l=="string"?n.test(l):!1})}function lr(e,t){const n=[];function s(i){if(t!=null&&n.length>=t||!i)return n;if(ir(i)&&i.scrollingElement!=null&&!n.includes(i.scrollingElement))return n.push(i.scrollingElement),n;if(!Zt(i)||Pr(i)||n.includes(i))return n;const l=Me(e).getComputedStyle(i);return i!==e&&Ni(i,l)&&n.push(i),wi(i,l)?n:s(i.parentNode)}return e?s(e):n}function Xr(e){const[t]=lr(e,1);return t??null}function Hn(e){return!Sn||!e?null:Pt(e)?e:sr(e)?ir(e)||e===Bt(e).scrollingElement?window:Zt(e)?e:null:null}function Kr(e){return Pt(e)?e.scrollX:e.scrollLeft}function Hr(e){return Pt(e)?e.scrollY:e.scrollTop}function Zn(e){return{x:Kr(e),y:Hr(e)}}var je;(function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"})(je||(je={}));function Yr(e){return!Sn||!e?!1:e===document.scrollingElement}function qr(e){const t={x:0,y:0},n=Yr(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},s={x:e.scrollWidth-n.width,y:e.scrollHeight-n.height},i=e.scrollTop<=t.y,l=e.scrollLeft<=t.x,d=e.scrollTop>=s.y,u=e.scrollLeft>=s.x;return{isTop:i,isLeft:l,isBottom:d,isRight:u,maxScroll:s,minScroll:t}}const ji={x:.2,y:.2};function Ci(e,t,n,s,i){let{top:l,left:d,right:u,bottom:f}=n;s===void 0&&(s=10),i===void 0&&(i=ji);const{isTop:h,isBottom:m,isLeft:x,isRight:N}=qr(e),v={x:0,y:0},R={x:0,y:0},j={height:t.height*i.y,width:t.width*i.x};return!h&&l<=t.top+j.height?(v.y=je.Backward,R.y=s*Math.abs((t.top+j.height-l)/j.height)):!m&&f>=t.bottom-j.height&&(v.y=je.Forward,R.y=s*Math.abs((t.bottom-j.height-f)/j.height)),!N&&u>=t.right-j.width?(v.x=je.Forward,R.x=s*Math.abs((t.right-j.width-u)/j.width)):!x&&d<=t.left+j.width&&(v.x=je.Backward,R.x=s*Math.abs((t.left+j.width-d)/j.width)),{direction:v,speed:R}}function Si(e){if(e===document.scrollingElement){const{innerWidth:l,innerHeight:d}=window;return{top:0,left:0,right:l,bottom:d,width:l,height:d}}const{top:t,left:n,right:s,bottom:i}=e.getBoundingClientRect();return{top:t,left:n,right:s,bottom:i,width:e.clientWidth,height:e.clientHeight}}function Gr(e){return e.reduce((t,n)=>zt(t,Zn(n)),ct)}function ki(e){return e.reduce((t,n)=>t+Kr(n),0)}function Di(e){return e.reduce((t,n)=>t+Hr(n),0)}function Jr(e,t){if(t===void 0&&(t=Ut),!e)return;const{top:n,left:s,bottom:i,right:l}=t(e);Xr(e)&&(i<=0||l<=0||n>=window.innerHeight||s>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}const Ai=[["x",["left","right"],ki],["y",["top","bottom"],Di]];class cr{constructor(t,n){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const s=lr(n),i=Gr(s);this.rect={...t},this.width=t.width,this.height=t.height;for(const[l,d,u]of Ai)for(const f of d)Object.defineProperty(this,f,{get:()=>{const h=u(s),m=i[l]-h;return this.rect[f]+m},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class Yt{constructor(t){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(n=>{var s;return(s=this.target)==null?void 0:s.removeEventListener(...n)})},this.target=t}add(t,n,s){var i;(i=this.target)==null||i.addEventListener(t,n,s),this.listeners.push([t,n,s])}}function _i(e){const{EventTarget:t}=Me(e);return e instanceof t?e:Bt(e)}function Yn(e,t){const n=Math.abs(e.x),s=Math.abs(e.y);return typeof t=="number"?Math.sqrt(n**2+s**2)>t:"x"in t&&"y"in t?n>t.x&&s>t.y:"x"in t?n>t.x:"y"in t?s>t.y:!1}var Ze;(function(e){e.Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange"})(Ze||(Ze={}));function Sr(e){e.preventDefault()}function Ri(e){e.stopPropagation()}var V;(function(e){e.Space="Space",e.Down="ArrowDown",e.Right="ArrowRight",e.Left="ArrowLeft",e.Up="ArrowUp",e.Esc="Escape",e.Enter="Enter",e.Tab="Tab"})(V||(V={}));const Qr={start:[V.Space,V.Enter],cancel:[V.Esc],end:[V.Space,V.Enter,V.Tab]},Ei=(e,t)=>{let{currentCoordinates:n}=t;switch(e.code){case V.Right:return{...n,x:n.x+25};case V.Left:return{...n,x:n.x-25};case V.Down:return{...n,y:n.y+25};case V.Up:return{...n,y:n.y-25}}};class Zr{constructor(t){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=t;const{event:{target:n}}=t;this.props=t,this.listeners=new Yt(Bt(n)),this.windowListeners=new Yt(Me(n)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(Ze.Resize,this.handleCancel),this.windowListeners.add(Ze.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(Ze.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:t,onStart:n}=this.props,s=t.node.current;s&&Jr(s),n(ct)}handleKeyDown(t){if(Dn(t)){const{active:n,context:s,options:i}=this.props,{keyboardCodes:l=Qr,coordinateGetter:d=Ei,scrollBehavior:u="smooth"}=i,{code:f}=t;if(l.end.includes(f)){this.handleEnd(t);return}if(l.cancel.includes(f)){this.handleCancel(t);return}const{collisionRect:h}=s.current,m=h?{x:h.left,y:h.top}:ct;this.referenceCoordinates||(this.referenceCoordinates=m);const x=d(t,{active:n,context:s.current,currentCoordinates:m});if(x){const N=wn(x,m),v={x:0,y:0},{scrollableAncestors:R}=s.current;for(const j of R){const S=t.code,{isTop:I,isRight:M,isLeft:E,isBottom:T,maxScroll:O,minScroll:z}=qr(j),A=Si(j),L={x:Math.min(S===V.Right?A.right-A.width/2:A.right,Math.max(S===V.Right?A.left:A.left+A.width/2,x.x)),y:Math.min(S===V.Down?A.bottom-A.height/2:A.bottom,Math.max(S===V.Down?A.top:A.top+A.height/2,x.y))},B=S===V.Right&&!M||S===V.Left&&!E,H=S===V.Down&&!T||S===V.Up&&!I;if(B&&L.x!==x.x){const F=j.scrollLeft+N.x,ge=S===V.Right&&F<=O.x||S===V.Left&&F>=z.x;if(ge&&!N.y){j.scrollTo({left:F,behavior:u});return}ge?v.x=j.scrollLeft-F:v.x=S===V.Right?j.scrollLeft-O.x:j.scrollLeft-z.x,v.x&&j.scrollBy({left:-v.x,behavior:u});break}else if(H&&L.y!==x.y){const F=j.scrollTop+N.y,ge=S===V.Down&&F<=O.y||S===V.Up&&F>=z.y;if(ge&&!N.x){j.scrollTo({top:F,behavior:u});return}ge?v.y=j.scrollTop-F:v.y=S===V.Down?j.scrollTop-O.y:j.scrollTop-z.y,v.y&&j.scrollBy({top:-v.y,behavior:u});break}}this.handleMove(t,zt(wn(x,this.referenceCoordinates),v))}}}handleMove(t,n){const{onMove:s}=this.props;t.preventDefault(),s(n)}handleEnd(t){const{onEnd:n}=this.props;t.preventDefault(),this.detach(),n()}handleCancel(t){const{onCancel:n}=this.props;t.preventDefault(),this.detach(),n()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}Zr.activators=[{eventName:"onKeyDown",handler:(e,t,n)=>{let{keyboardCodes:s=Qr,onActivation:i}=t,{active:l}=n;const{code:d}=e.nativeEvent;if(s.start.includes(d)){const u=l.activatorNode.current;return u&&e.target!==u?!1:(e.preventDefault(),i==null||i({event:e.nativeEvent}),!0)}return!1}}];function kr(e){return!!(e&&"distance"in e)}function Dr(e){return!!(e&&"delay"in e)}class dr{constructor(t,n,s){var i;s===void 0&&(s=_i(t.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=t,this.events=n;const{event:l}=t,{target:d}=l;this.props=t,this.events=n,this.document=Bt(d),this.documentListeners=new Yt(this.document),this.listeners=new Yt(s),this.windowListeners=new Yt(Me(d)),this.initialCoordinates=(i=Nn(l))!=null?i:ct,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:t,props:{options:{activationConstraint:n,bypassActivationConstraint:s}}}=this;if(this.listeners.add(t.move.name,this.handleMove,{passive:!1}),this.listeners.add(t.end.name,this.handleEnd),t.cancel&&this.listeners.add(t.cancel.name,this.handleCancel),this.windowListeners.add(Ze.Resize,this.handleCancel),this.windowListeners.add(Ze.DragStart,Sr),this.windowListeners.add(Ze.VisibilityChange,this.handleCancel),this.windowListeners.add(Ze.ContextMenu,Sr),this.documentListeners.add(Ze.Keydown,this.handleKeydown),n){if(s!=null&&s({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(Dr(n)){this.timeoutId=setTimeout(this.handleStart,n.delay),this.handlePending(n);return}if(kr(n)){this.handlePending(n);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(t,n){const{active:s,onPending:i}=this.props;i(s,t,this.initialCoordinates,n)}handleStart(){const{initialCoordinates:t}=this,{onStart:n}=this.props;t&&(this.activated=!0,this.documentListeners.add(Ze.Click,Ri,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(Ze.SelectionChange,this.removeTextSelection),n(t))}handleMove(t){var n;const{activated:s,initialCoordinates:i,props:l}=this,{onMove:d,options:{activationConstraint:u}}=l;if(!i)return;const f=(n=Nn(t))!=null?n:ct,h=wn(i,f);if(!s&&u){if(kr(u)){if(u.tolerance!=null&&Yn(h,u.tolerance))return this.handleCancel();if(Yn(h,u.distance))return this.handleStart()}if(Dr(u)&&Yn(h,u.tolerance))return this.handleCancel();this.handlePending(u,h);return}t.cancelable&&t.preventDefault(),d(f)}handleEnd(){const{onAbort:t,onEnd:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleCancel(){const{onAbort:t,onCancel:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleKeydown(t){t.code===V.Esc&&this.handleCancel()}removeTextSelection(){var t;(t=this.document.getSelection())==null||t.removeAllRanges()}}const Mi={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class ur extends dr{constructor(t){const{event:n}=t,s=Bt(n.target);super(t,Mi,s)}}ur.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:s}=t;return!n.isPrimary||n.button!==0?!1:(s==null||s({event:n}),!0)}}];const Li={move:{name:"mousemove"},end:{name:"mouseup"}};var er;(function(e){e[e.RightClick=2]="RightClick"})(er||(er={}));class Ii extends dr{constructor(t){super(t,Li,Bt(t.event.target))}}Ii.activators=[{eventName:"onMouseDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:s}=t;return n.button===er.RightClick?!1:(s==null||s({event:n}),!0)}}];const qn={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class $i extends dr{constructor(t){super(t,qn)}static setup(){return window.addEventListener(qn.move.name,t,{capture:!1,passive:!1}),function(){window.removeEventListener(qn.move.name,t)};function t(){}}}$i.activators=[{eventName:"onTouchStart",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:s}=t;const{touches:i}=n;return i.length>1?!1:(s==null||s({event:n}),!0)}}];var qt;(function(e){e[e.Pointer=0]="Pointer",e[e.DraggableRect=1]="DraggableRect"})(qt||(qt={}));var Cn;(function(e){e[e.TreeOrder=0]="TreeOrder",e[e.ReversedTreeOrder=1]="ReversedTreeOrder"})(Cn||(Cn={}));function Ti(e){let{acceleration:t,activator:n=qt.Pointer,canScroll:s,draggingRect:i,enabled:l,interval:d=5,order:u=Cn.TreeOrder,pointerCoordinates:f,scrollableAncestors:h,scrollableAncestorRects:m,delta:x,threshold:N}=e;const v=zi({delta:x,disabled:!l}),[R,j]=Xs(),S=o.useRef({x:0,y:0}),I=o.useRef({x:0,y:0}),M=o.useMemo(()=>{switch(n){case qt.Pointer:return f?{top:f.y,bottom:f.y,left:f.x,right:f.x}:null;case qt.DraggableRect:return i}},[n,i,f]),E=o.useRef(null),T=o.useCallback(()=>{const z=E.current;if(!z)return;const A=S.current.x*I.current.x,L=S.current.y*I.current.y;z.scrollBy(A,L)},[]),O=o.useMemo(()=>u===Cn.TreeOrder?[...h].reverse():h,[u,h]);o.useEffect(()=>{if(!l||!h.length||!M){j();return}for(const z of O){if((s==null?void 0:s(z))===!1)continue;const A=h.indexOf(z),L=m[A];if(!L)continue;const{direction:B,speed:H}=Ci(z,L,M,t,N);for(const F of["x","y"])v[F][B[F]]||(H[F]=0,B[F]=0);if(H.x>0||H.y>0){j(),E.current=z,R(T,d),S.current=H,I.current=B;return}}S.current={x:0,y:0},I.current={x:0,y:0},j()},[t,T,s,j,l,d,JSON.stringify(M),JSON.stringify(v),R,h,O,m,JSON.stringify(N)])}const Oi={x:{[je.Backward]:!1,[je.Forward]:!1},y:{[je.Backward]:!1,[je.Forward]:!1}};function zi(e){let{delta:t,disabled:n}=e;const s=vn(t);return en(i=>{if(n||!s||!i)return Oi;const l={x:Math.sign(t.x-s.x),y:Math.sign(t.y-s.y)};return{x:{[je.Backward]:i.x[je.Backward]||l.x===-1,[je.Forward]:i.x[je.Forward]||l.x===1},y:{[je.Backward]:i.y[je.Backward]||l.y===-1,[je.Forward]:i.y[je.Forward]||l.y===1}}},[n,t,s])}function Fi(e,t){const n=t!=null?e.get(t):void 0,s=n?n.node.current:null;return en(i=>{var l;return t==null?null:(l=s??i)!=null?l:null},[s,t])}function Pi(e,t){return o.useMemo(()=>e.reduce((n,s)=>{const{sensor:i}=s,l=i.activators.map(d=>({eventName:d.eventName,handler:t(d.handler,s)}));return[...n,...l]},[]),[e,t])}var Qt;(function(e){e[e.Always=0]="Always",e[e.BeforeDragging=1]="BeforeDragging",e[e.WhileDragging=2]="WhileDragging"})(Qt||(Qt={}));var tr;(function(e){e.Optimized="optimized"})(tr||(tr={}));const Ar=new Map;function Bi(e,t){let{dragging:n,dependencies:s,config:i}=t;const[l,d]=o.useState(null),{frequency:u,measure:f,strategy:h}=i,m=o.useRef(e),x=S(),N=Jt(x),v=o.useCallback(function(I){I===void 0&&(I=[]),!N.current&&d(M=>M===null?I:M.concat(I.filter(E=>!M.includes(E))))},[N]),R=o.useRef(null),j=en(I=>{if(x&&!n)return Ar;if(!I||I===Ar||m.current!==e||l!=null){const M=new Map;for(let E of e){if(!E)continue;if(l&&l.length>0&&!l.includes(E.id)&&E.rect.current){M.set(E.id,E.rect.current);continue}const T=E.node.current,O=T?new cr(f(T),T):null;E.rect.current=O,O&&M.set(E.id,O)}return M}return I},[e,l,n,x,f]);return o.useEffect(()=>{m.current=e},[e]),o.useEffect(()=>{x||v()},[n,x]),o.useEffect(()=>{l&&l.length>0&&d(null)},[JSON.stringify(l)]),o.useEffect(()=>{x||typeof u!="number"||R.current!==null||(R.current=setTimeout(()=>{v(),R.current=null},u))},[u,x,v,...s]),{droppableRects:j,measureDroppableContainers:v,measuringScheduled:l!=null};function S(){switch(h){case Qt.Always:return!1;case Qt.BeforeDragging:return n;default:return!n}}}function fr(e,t){return en(n=>e?n||(typeof t=="function"?t(e):e):null,[t,e])}function Ui(e,t){return fr(e,t)}function Wi(e){let{callback:t,disabled:n}=e;const s=kn(t),i=o.useMemo(()=>{if(n||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:l}=window;return new l(s)},[s,n]);return o.useEffect(()=>()=>i==null?void 0:i.disconnect(),[i]),i}function An(e){let{callback:t,disabled:n}=e;const s=kn(t),i=o.useMemo(()=>{if(n||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:l}=window;return new l(s)},[n]);return o.useEffect(()=>()=>i==null?void 0:i.disconnect(),[i]),i}function Vi(e){return new cr(Ut(e),e)}function _r(e,t,n){t===void 0&&(t=Vi);const[s,i]=o.useState(null);function l(){i(f=>{if(!e)return null;if(e.isConnected===!1){var h;return(h=f??n)!=null?h:null}const m=t(e);return JSON.stringify(f)===JSON.stringify(m)?f:m})}const d=Wi({callback(f){if(e)for(const h of f){const{type:m,target:x}=h;if(m==="childList"&&x instanceof HTMLElement&&x.contains(e)){l();break}}}}),u=An({callback:l});return lt(()=>{l(),e?(u==null||u.observe(e),d==null||d.observe(document.body,{childList:!0,subtree:!0})):(u==null||u.disconnect(),d==null||d.disconnect())},[e]),s}function Xi(e){const t=fr(e);return Wr(e,t)}const Rr=[];function Ki(e){const t=o.useRef(e),n=en(s=>e?s&&s!==Rr&&e&&t.current&&e.parentNode===t.current.parentNode?s:lr(e):Rr,[e]);return o.useEffect(()=>{t.current=e},[e]),n}function Hi(e){const[t,n]=o.useState(null),s=o.useRef(e),i=o.useCallback(l=>{const d=Hn(l.target);d&&n(u=>u?(u.set(d,Zn(d)),new Map(u)):null)},[]);return o.useEffect(()=>{const l=s.current;if(e!==l){d(l);const u=e.map(f=>{const h=Hn(f);return h?(h.addEventListener("scroll",i,{passive:!0}),[h,Zn(h)]):null}).filter(f=>f!=null);n(u.length?new Map(u):null),s.current=e}return()=>{d(e),d(l)};function d(u){u.forEach(f=>{const h=Hn(f);h==null||h.removeEventListener("scroll",i)})}},[i,e]),o.useMemo(()=>e.length?t?Array.from(t.values()).reduce((l,d)=>zt(l,d),ct):Gr(e):ct,[e,t])}function Er(e,t){t===void 0&&(t=[]);const n=o.useRef(null);return o.useEffect(()=>{n.current=null},t),o.useEffect(()=>{const s=e!==ct;s&&!n.current&&(n.current=e),!s&&n.current&&(n.current=null)},[e]),n.current?wn(e,n.current):ct}function Yi(e){o.useEffect(()=>{if(!Sn)return;const t=e.map(n=>{let{sensor:s}=n;return s.setup==null?void 0:s.setup()});return()=>{for(const n of t)n==null||n()}},e.map(t=>{let{sensor:n}=t;return n}))}function qi(e,t){return o.useMemo(()=>e.reduce((n,s)=>{let{eventName:i,handler:l}=s;return n[i]=d=>{l(d,t)},n},{}),[e,t])}function es(e){return o.useMemo(()=>e?vi(e):null,[e])}const Mr=[];function Gi(e,t){t===void 0&&(t=Ut);const[n]=e,s=es(n?Me(n):null),[i,l]=o.useState(Mr);function d(){l(()=>e.length?e.map(f=>Yr(f)?s:new cr(t(f),f)):Mr)}const u=An({callback:d});return lt(()=>{u==null||u.disconnect(),d(),e.forEach(f=>u==null?void 0:u.observe(f))},[e]),i}function ts(e){if(!e)return null;if(e.children.length>1)return e;const t=e.children[0];return Zt(t)?t:e}function Ji(e){let{measure:t}=e;const[n,s]=o.useState(null),i=o.useCallback(h=>{for(const{target:m}of h)if(Zt(m)){s(x=>{const N=t(m);return x?{...x,width:N.width,height:N.height}:N});break}},[t]),l=An({callback:i}),d=o.useCallback(h=>{const m=ts(h);l==null||l.disconnect(),m&&(l==null||l.observe(m)),s(m?t(m):null)},[t,l]),[u,f]=yn(d);return o.useMemo(()=>({nodeRef:u,rect:n,setRef:f}),[n,u,f])}const Qi=[{sensor:ur,options:{}},{sensor:Zr,options:{}}],Zi={current:{}},pn={draggable:{measure:Cr},droppable:{measure:Cr,strategy:Qt.WhileDragging,frequency:tr.Optimized},dragOverlay:{measure:Ut}};class Gt extends Map{get(t){var n;return t!=null&&(n=super.get(t))!=null?n:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(t=>{let{disabled:n}=t;return!n})}getNodeFor(t){var n,s;return(n=(s=this.get(t))==null?void 0:s.node.current)!=null?n:void 0}}const ea={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new Gt,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:jn},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:pn,measureDroppableContainers:jn,windowRect:null,measuringScheduled:!1},ns={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:jn,draggableNodes:new Map,over:null,measureDroppableContainers:jn},nn=o.createContext(ns),rs=o.createContext(ea);function ta(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new Gt}}}function na(e,t){switch(t.type){case pe.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case pe.DragMove:return e.draggable.active==null?e:{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}};case pe.DragEnd:case pe.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case pe.RegisterDroppable:{const{element:n}=t,{id:s}=n,i=new Gt(e.droppable.containers);return i.set(s,n),{...e,droppable:{...e.droppable,containers:i}}}case pe.SetDroppableDisabled:{const{id:n,key:s,disabled:i}=t,l=e.droppable.containers.get(n);if(!l||s!==l.key)return e;const d=new Gt(e.droppable.containers);return d.set(n,{...l,disabled:i}),{...e,droppable:{...e.droppable,containers:d}}}case pe.UnregisterDroppable:{const{id:n,key:s}=t,i=e.droppable.containers.get(n);if(!i||s!==i.key)return e;const l=new Gt(e.droppable.containers);return l.delete(n),{...e,droppable:{...e.droppable,containers:l}}}default:return e}}function ra(e){let{disabled:t}=e;const{active:n,activatorEvent:s,draggableNodes:i}=o.useContext(nn),l=vn(s),d=vn(n==null?void 0:n.id);return o.useEffect(()=>{if(!t&&!s&&l&&d!=null){if(!Dn(l)||document.activeElement===l.target)return;const u=i.get(d);if(!u)return;const{activatorNode:f,node:h}=u;if(!f.current&&!h.current)return;requestAnimationFrame(()=>{for(const m of[f.current,h.current]){if(!m)continue;const x=Ys(m);if(x){x.focus();break}}})}},[s,t,i,d,l]),null}function ss(e,t){let{transform:n,...s}=t;return e!=null&&e.length?e.reduce((i,l)=>l({transform:i,...s}),n):n}function sa(e){return o.useMemo(()=>({draggable:{...pn.draggable,...e==null?void 0:e.draggable},droppable:{...pn.droppable,...e==null?void 0:e.droppable},dragOverlay:{...pn.dragOverlay,...e==null?void 0:e.dragOverlay}}),[e==null?void 0:e.draggable,e==null?void 0:e.droppable,e==null?void 0:e.dragOverlay])}function ia(e){let{activeNode:t,measure:n,initialRect:s,config:i=!0}=e;const l=o.useRef(!1),{x:d,y:u}=typeof i=="boolean"?{x:i,y:i}:i;lt(()=>{if(!d&&!u||!t){l.current=!1;return}if(l.current||!s)return;const h=t==null?void 0:t.node.current;if(!h||h.isConnected===!1)return;const m=n(h),x=Wr(m,s);if(d||(x.x=0),u||(x.y=0),l.current=!0,Math.abs(x.x)>0||Math.abs(x.y)>0){const N=Xr(h);N&&N.scrollBy({top:x.y,left:x.x})}},[t,d,u,s,n])}const _n=o.createContext({...ct,scaleX:1,scaleY:1});var kt;(function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"})(kt||(kt={}));const aa=o.memo(function(t){var n,s,i,l;let{id:d,accessibility:u,autoScroll:f=!0,children:h,sensors:m=Qi,collisionDetection:x=fi,measuring:N,modifiers:v,...R}=t;const j=o.useReducer(na,void 0,ta),[S,I]=j,[M,E]=ei(),[T,O]=o.useState(kt.Uninitialized),z=T===kt.Initialized,{draggable:{active:A,nodes:L,translate:B},droppable:{containers:H}}=S,F=A!=null?L.get(A):null,ge=o.useRef({initial:null,translated:null}),ue=o.useMemo(()=>{var te;return A!=null?{id:A,data:(te=F==null?void 0:F.data)!=null?te:Zi,rect:ge}:null},[A,F]),Ce=o.useRef(null),[Be,He]=o.useState(null),[se,Le]=o.useState(null),ie=Jt(R,Object.values(R)),et=tn("DndDescribedBy",d),Ie=o.useMemo(()=>H.getEnabled(),[H]),G=sa(N),{droppableRects:me,measureDroppableContainers:Ye,measuringScheduled:$e}=Bi(Ie,{dragging:z,dependencies:[B.x,B.y],config:G.droppable}),ae=Fi(L,A),Ue=o.useMemo(()=>se?Nn(se):null,[se]),be=$t(),Se=Ui(ae,G.draggable.measure);ia({activeNode:A!=null?L.get(A):null,config:be.layoutShiftCompensation,initialRect:Se,measure:G.draggable.measure});const P=_r(ae,G.draggable.measure,Se),We=_r(ae?ae.parentElement:null),fe=o.useRef({activatorEvent:null,active:null,activeNode:ae,collisionRect:null,collisions:null,droppableRects:me,draggableNodes:L,draggingNode:null,draggingNodeRect:null,droppableContainers:H,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),tt=H.getNodeFor((n=fe.current.over)==null?void 0:n.id),ye=Ji({measure:G.dragOverlay.measure}),Ve=(s=ye.nodeRef.current)!=null?s:ae,De=z?(i=ye.rect)!=null?i:P:null,Dt=!!(ye.nodeRef.current&&ye.rect),dt=Xi(Dt?null:P),ht=es(Ve?Me(Ve):null),le=Ki(z?tt??ae:null),nt=Gi(le),Te=ss(v,{transform:{x:B.x-dt.x,y:B.y-dt.y,scaleX:1,scaleY:1},activatorEvent:se,active:ue,activeNodeRect:P,containerNodeRect:We,draggingNodeRect:De,over:fe.current.over,overlayNodeRect:ye.rect,scrollableAncestors:le,scrollableAncestorRects:nt,windowRect:ht}),vt=Ue?zt(Ue,B):null,Oe=Hi(le),At=Er(Oe),rt=Er(Oe,[P]),qe=zt(Te,At),Ae=De?pi(De,Te):null,ze=ue&&Ae?x({active:ue,collisionRect:Ae,droppableRects:me,droppableContainers:Ie,pointerCoordinates:vt}):null,st=li(ze,"id"),[_e,Ge]=o.useState(null),Lt=Dt?Te:zt(Te,rt),gt=mi(Lt,(l=_e==null?void 0:_e.rect)!=null?l:null,P),wt=o.useRef(null),_t=o.useCallback((te,ce)=>{let{sensor:Y,options:ne}=ce;if(Ce.current==null)return;const ve=L.get(Ce.current);if(!ve)return;const he=te.nativeEvent,ke=new Y({active:Ce.current,activeNode:ve,event:he,options:ne,context:fe,onAbort(ee){if(!L.get(ee))return;const{onDragAbort:J}=ie.current,Xe={id:ee};J==null||J(Xe),M({type:"onDragAbort",event:Xe})},onPending(ee,we,J,Xe){if(!L.get(ee))return;const{onDragPending:Re}=ie.current,Ee={id:ee,constraint:we,initialCoordinates:J,offset:Xe};Re==null||Re(Ee),M({type:"onDragPending",event:Ee})},onStart(ee){const we=Ce.current;if(we==null)return;const J=L.get(we);if(!J)return;const{onDragStart:Xe}=ie.current,Q={activatorEvent:he,active:{id:we,data:J.data,rect:ge}};Ht.unstable_batchedUpdates(()=>{Xe==null||Xe(Q),O(kt.Initializing),I({type:pe.DragStart,initialCoordinates:ee,active:we}),M({type:"onDragStart",event:Q}),He(wt.current),Le(he)})},onMove(ee){I({type:pe.DragMove,coordinates:ee})},onEnd:it(pe.DragEnd),onCancel:it(pe.DragCancel)});wt.current=ke;function it(ee){return async function(){const{active:J,collisions:Xe,over:Q,scrollAdjustedTranslate:Re}=fe.current;let Ee=null;if(J&&Re){const{cancelDrop:at}=ie.current;Ee={activatorEvent:he,active:J,collisions:Xe,delta:Re,over:Q},ee===pe.DragEnd&&typeof at=="function"&&await Promise.resolve(at(Ee))&&(ee=pe.DragCancel)}Ce.current=null,Ht.unstable_batchedUpdates(()=>{I({type:ee}),O(kt.Uninitialized),Ge(null),He(null),Le(null),wt.current=null;const at=ee===pe.DragEnd?"onDragEnd":"onDragCancel";if(Ee){const Nt=ie.current[at];Nt==null||Nt(Ee),M({type:at,event:Ee})}})}}},[L]),It=o.useCallback((te,ce)=>(Y,ne)=>{const ve=Y.nativeEvent,he=L.get(ne);if(Ce.current!==null||!he||ve.dndKit||ve.defaultPrevented)return;const ke={active:he};te(Y,ce.options,ke)===!0&&(ve.dndKit={capturedBy:ce.sensor},Ce.current=ne,_t(Y,ce))},[L,_t]),mt=Pi(m,It);Yi(m),lt(()=>{P&&T===kt.Initializing&&O(kt.Initialized)},[P,T]),o.useEffect(()=>{const{onDragMove:te}=ie.current,{active:ce,activatorEvent:Y,collisions:ne,over:ve}=fe.current;if(!ce||!Y)return;const he={active:ce,activatorEvent:Y,collisions:ne,delta:{x:qe.x,y:qe.y},over:ve};Ht.unstable_batchedUpdates(()=>{te==null||te(he),M({type:"onDragMove",event:he})})},[qe.x,qe.y]),o.useEffect(()=>{const{active:te,activatorEvent:ce,collisions:Y,droppableContainers:ne,scrollAdjustedTranslate:ve}=fe.current;if(!te||Ce.current==null||!ce||!ve)return;const{onDragOver:he}=ie.current,ke=ne.get(st),it=ke&&ke.rect.current?{id:ke.id,rect:ke.rect.current,data:ke.data,disabled:ke.disabled}:null,ee={active:te,activatorEvent:ce,collisions:Y,delta:{x:ve.x,y:ve.y},over:it};Ht.unstable_batchedUpdates(()=>{Ge(it),he==null||he(ee),M({type:"onDragOver",event:ee})})},[st]),lt(()=>{fe.current={activatorEvent:se,active:ue,activeNode:ae,collisionRect:Ae,collisions:ze,droppableRects:me,draggableNodes:L,draggingNode:Ve,draggingNodeRect:De,droppableContainers:H,over:_e,scrollableAncestors:le,scrollAdjustedTranslate:qe},ge.current={initial:De,translated:Ae}},[ue,ae,ze,Ae,L,Ve,De,me,H,_e,le,qe]),Ti({...be,delta:B,draggingRect:Ae,pointerCoordinates:vt,scrollableAncestors:le,scrollableAncestorRects:nt});const Rt=o.useMemo(()=>({active:ue,activeNode:ae,activeNodeRect:P,activatorEvent:se,collisions:ze,containerNodeRect:We,dragOverlay:ye,draggableNodes:L,droppableContainers:H,droppableRects:me,over:_e,measureDroppableContainers:Ye,scrollableAncestors:le,scrollableAncestorRects:nt,measuringConfiguration:G,measuringScheduled:$e,windowRect:ht}),[ue,ae,P,se,ze,We,ye,L,H,me,_e,Ye,le,nt,G,$e,ht]),xt=o.useMemo(()=>({activatorEvent:se,activators:mt,active:ue,activeNodeRect:P,ariaDescribedById:{draggable:et},dispatch:I,draggableNodes:L,over:_e,measureDroppableContainers:Ye}),[se,mt,ue,P,I,et,L,_e,Ye]);return q.createElement(Ur.Provider,{value:E},q.createElement(nn.Provider,{value:xt},q.createElement(rs.Provider,{value:Rt},q.createElement(_n.Provider,{value:gt},h)),q.createElement(ra,{disabled:(u==null?void 0:u.restoreFocus)===!1})),q.createElement(ri,{...u,hiddenTextDescribedById:et}));function $t(){const te=(Be==null?void 0:Be.autoScrollEnabled)===!1,ce=typeof f=="object"?f.enabled===!1:f===!1,Y=z&&!te&&!ce;return typeof f=="object"?{...f,enabled:Y}:{enabled:Y}}}),oa=o.createContext(null),Lr="button",la="Draggable";function ca(e){let{id:t,data:n,disabled:s=!1,attributes:i}=e;const l=tn(la),{activators:d,activatorEvent:u,active:f,activeNodeRect:h,ariaDescribedById:m,draggableNodes:x,over:N}=o.useContext(nn),{role:v=Lr,roleDescription:R="draggable",tabIndex:j=0}=i??{},S=(f==null?void 0:f.id)===t,I=o.useContext(S?_n:oa),[M,E]=yn(),[T,O]=yn(),z=qi(d,t),A=Jt(n);lt(()=>(x.set(t,{id:t,key:l,node:M,activatorNode:T,data:A}),()=>{const B=x.get(t);B&&B.key===l&&x.delete(t)}),[x,t]);const L=o.useMemo(()=>({role:v,tabIndex:j,"aria-disabled":s,"aria-pressed":S&&v===Lr?!0:void 0,"aria-roledescription":R,"aria-describedby":m.draggable}),[s,v,j,S,R,m.draggable]);return{active:f,activatorEvent:u,activeNodeRect:h,attributes:L,isDragging:S,listeners:s?void 0:z,node:M,over:N,setNodeRef:E,setActivatorNodeRef:O,transform:I}}function is(){return o.useContext(rs)}const da="Droppable",ua={timeout:25};function fa(e){let{data:t,disabled:n=!1,id:s,resizeObserverConfig:i}=e;const l=tn(da),{active:d,dispatch:u,over:f,measureDroppableContainers:h}=o.useContext(nn),m=o.useRef({disabled:n}),x=o.useRef(!1),N=o.useRef(null),v=o.useRef(null),{disabled:R,updateMeasurementsFor:j,timeout:S}={...ua,...i},I=Jt(j??s),M=o.useCallback(()=>{if(!x.current){x.current=!0;return}v.current!=null&&clearTimeout(v.current),v.current=setTimeout(()=>{h(Array.isArray(I.current)?I.current:[I.current]),v.current=null},S)},[S]),E=An({callback:M,disabled:R||!d}),T=o.useCallback((L,B)=>{E&&(B&&(E.unobserve(B),x.current=!1),L&&E.observe(L))},[E]),[O,z]=yn(T),A=Jt(t);return o.useEffect(()=>{!E||!O.current||(E.disconnect(),x.current=!1,E.observe(O.current))},[O,E]),o.useEffect(()=>(u({type:pe.RegisterDroppable,element:{id:s,key:l,disabled:n,node:O,rect:N,data:A}}),()=>u({type:pe.UnregisterDroppable,key:l,id:s})),[s]),o.useEffect(()=>{n!==m.current.disabled&&(u({type:pe.SetDroppableDisabled,id:s,key:l,disabled:n}),m.current.disabled=n)},[s,l,n,u]),{active:d,rect:N,isOver:(f==null?void 0:f.id)===s,node:O,over:f,setNodeRef:z}}function ha(e){let{animation:t,children:n}=e;const[s,i]=o.useState(null),[l,d]=o.useState(null),u=vn(n);return!n&&!s&&u&&i(u),lt(()=>{if(!l)return;const f=s==null?void 0:s.key,h=s==null?void 0:s.props.id;if(f==null||h==null){i(null);return}Promise.resolve(t(h,l)).then(()=>{i(null)})},[t,s,l]),q.createElement(q.Fragment,null,n,s?o.cloneElement(s,{ref:d}):null)}const ga={x:0,y:0,scaleX:1,scaleY:1};function ma(e){let{children:t}=e;return q.createElement(nn.Provider,{value:ns},q.createElement(_n.Provider,{value:ga},t))}const xa={position:"fixed",touchAction:"none"},pa=e=>Dn(e)?"transform 250ms ease":void 0,ba=o.forwardRef((e,t)=>{let{as:n,activatorEvent:s,adjustScale:i,children:l,className:d,rect:u,style:f,transform:h,transition:m=pa}=e;if(!u)return null;const x=i?h:{...h,scaleX:1,scaleY:1},N={...xa,width:u.width,height:u.height,top:u.top,left:u.left,transform:yt.Transform.toString(x),transformOrigin:i&&s?ai(s,u):void 0,transition:typeof m=="function"?m(s):m,...f};return q.createElement(n,{className:d,style:N,ref:t},l)}),ya=e=>t=>{let{active:n,dragOverlay:s}=t;const i={},{styles:l,className:d}=e;if(l!=null&&l.active)for(const[u,f]of Object.entries(l.active))f!==void 0&&(i[u]=n.node.style.getPropertyValue(u),n.node.style.setProperty(u,f));if(l!=null&&l.dragOverlay)for(const[u,f]of Object.entries(l.dragOverlay))f!==void 0&&s.node.style.setProperty(u,f);return d!=null&&d.active&&n.node.classList.add(d.active),d!=null&&d.dragOverlay&&s.node.classList.add(d.dragOverlay),function(){for(const[f,h]of Object.entries(i))n.node.style.setProperty(f,h);d!=null&&d.active&&n.node.classList.remove(d.active)}},va=e=>{let{transform:{initial:t,final:n}}=e;return[{transform:yt.Transform.toString(t)},{transform:yt.Transform.toString(n)}]},wa={duration:250,easing:"ease",keyframes:va,sideEffects:ya({styles:{active:{opacity:"0"}}})};function Na(e){let{config:t,draggableNodes:n,droppableContainers:s,measuringConfiguration:i}=e;return kn((l,d)=>{if(t===null)return;const u=n.get(l);if(!u)return;const f=u.node.current;if(!f)return;const h=ts(d);if(!h)return;const{transform:m}=Me(d).getComputedStyle(d),x=Vr(m);if(!x)return;const N=typeof t=="function"?t:ja(t);return Jr(f,i.draggable.measure),N({active:{id:l,data:u.data,node:f,rect:i.draggable.measure(f)},draggableNodes:n,dragOverlay:{node:d,rect:i.dragOverlay.measure(h)},droppableContainers:s,measuringConfiguration:i,transform:x})})}function ja(e){const{duration:t,easing:n,sideEffects:s,keyframes:i}={...wa,...e};return l=>{let{active:d,dragOverlay:u,transform:f,...h}=l;if(!t)return;const m={x:u.rect.left-d.rect.left,y:u.rect.top-d.rect.top},x={scaleX:f.scaleX!==1?d.rect.width*f.scaleX/u.rect.width:1,scaleY:f.scaleY!==1?d.rect.height*f.scaleY/u.rect.height:1},N={x:f.x-m.x,y:f.y-m.y,...x},v=i({...h,active:d,dragOverlay:u,transform:{initial:f,final:N}}),[R]=v,j=v[v.length-1];if(JSON.stringify(R)===JSON.stringify(j))return;const S=s==null?void 0:s({active:d,dragOverlay:u,...h}),I=u.node.animate(v,{duration:t,easing:n,fill:"forwards"});return new Promise(M=>{I.onfinish=()=>{S==null||S(),M()}})}}let Ir=0;function Ca(e){return o.useMemo(()=>{if(e!=null)return Ir++,Ir},[e])}const Sa=q.memo(e=>{let{adjustScale:t=!1,children:n,dropAnimation:s,style:i,transition:l,modifiers:d,wrapperElement:u="div",className:f,zIndex:h=999}=e;const{activatorEvent:m,active:x,activeNodeRect:N,containerNodeRect:v,draggableNodes:R,droppableContainers:j,dragOverlay:S,over:I,measuringConfiguration:M,scrollableAncestors:E,scrollableAncestorRects:T,windowRect:O}=is(),z=o.useContext(_n),A=Ca(x==null?void 0:x.id),L=ss(d,{activatorEvent:m,active:x,activeNodeRect:N,containerNodeRect:v,draggingNodeRect:S.rect,over:I,overlayNodeRect:S.rect,scrollableAncestors:E,scrollableAncestorRects:T,transform:z,windowRect:O}),B=fr(N),H=Na({config:s,draggableNodes:R,droppableContainers:j,measuringConfiguration:M}),F=B?S.setRef:void 0;return q.createElement(ma,null,q.createElement(ha,{animation:H},x&&A?q.createElement(ba,{key:A,id:x.id,ref:F,as:u,activatorEvent:m,adjustScale:t,className:f,transition:l,rect:B,style:{zIndex:h,...i},transform:L},n):null))});function hr(e,t,n){const s=e.slice();return s.splice(n<0?s.length+n:n,0,s.splice(t,1)[0]),s}function ka(e,t){return e.reduce((n,s,i)=>{const l=t.get(s);return l&&(n[i]=l),n},Array(e.length))}function hn(e){return e!==null&&e>=0}function Da(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function Aa(e){return typeof e=="boolean"?{draggable:e,droppable:e}:e}const gn={scaleX:1,scaleY:1},Gn=e=>{var t;let{rects:n,activeNodeRect:s,activeIndex:i,overIndex:l,index:d}=e;const u=(t=n[i])!=null?t:s;if(!u)return null;const f=_a(n,d,i);if(d===i){const h=n[l];return h?{x:i<l?h.left+h.width-(u.left+u.width):h.left-u.left,y:0,...gn}:null}return d>i&&d<=l?{x:-u.width-f,y:0,...gn}:d<i&&d>=l?{x:u.width+f,y:0,...gn}:{x:0,y:0,...gn}};function _a(e,t,n){const s=e[t],i=e[t-1],l=e[t+1];return!s||!i&&!l?0:n<t?i?s.left-(i.left+i.width):l.left-(s.left+s.width):l?l.left-(s.left+s.width):s.left-(i.left+i.width)}const as=e=>{let{rects:t,activeIndex:n,overIndex:s,index:i}=e;const l=hr(t,s,n),d=t[i],u=l[i];return!u||!d?null:{x:u.left-d.left,y:u.top-d.top,scaleX:u.width/d.width,scaleY:u.height/d.height}},mn={scaleX:1,scaleY:1},Ra=e=>{var t;let{activeIndex:n,activeNodeRect:s,index:i,rects:l,overIndex:d}=e;const u=(t=l[n])!=null?t:s;if(!u)return null;if(i===n){const h=l[d];return h?{x:0,y:n<d?h.top+h.height-(u.top+u.height):h.top-u.top,...mn}:null}const f=Ea(l,i,n);return i>n&&i<=d?{x:0,y:-u.height-f,...mn}:i<n&&i>=d?{x:0,y:u.height+f,...mn}:{x:0,y:0,...mn}};function Ea(e,t,n){const s=e[t],i=e[t-1],l=e[t+1];return s?n<t?i?s.top-(i.top+i.height):l?l.top-(s.top+s.height):0:l?l.top-(s.top+s.height):i?s.top-(i.top+i.height):0:0}const os="Sortable",ls=q.createContext({activeIndex:-1,containerId:os,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:as,disabled:{draggable:!1,droppable:!1}});function xn(e){let{children:t,id:n,items:s,strategy:i=as,disabled:l=!1}=e;const{active:d,dragOverlay:u,droppableRects:f,over:h,measureDroppableContainers:m}=is(),x=tn(os,n),N=u.rect!==null,v=o.useMemo(()=>s.map(z=>typeof z=="object"&&"id"in z?z.id:z),[s]),R=d!=null,j=d?v.indexOf(d.id):-1,S=h?v.indexOf(h.id):-1,I=o.useRef(v),M=!Da(v,I.current),E=S!==-1&&j===-1||M,T=Aa(l);lt(()=>{M&&R&&m(v)},[M,v,R,m]),o.useEffect(()=>{I.current=v},[v]);const O=o.useMemo(()=>({activeIndex:j,containerId:x,disabled:T,disableTransforms:E,items:v,overIndex:S,useDragOverlay:N,sortedRects:ka(v,f),strategy:i}),[j,x,T.draggable,T.droppable,E,v,S,f,N,i]);return q.createElement(ls.Provider,{value:O},t)}const Ma=e=>{let{id:t,items:n,activeIndex:s,overIndex:i}=e;return hr(n,s,i).indexOf(t)},La=e=>{let{containerId:t,isSorting:n,wasDragging:s,index:i,items:l,newIndex:d,previousItems:u,previousContainerId:f,transition:h}=e;return!h||!s||u!==l&&i===d?!1:n?!0:d!==i&&t===f},Ia={duration:200,easing:"ease"},cs="transform",$a=yt.Transition.toString({property:cs,duration:0,easing:"linear"}),Ta={roleDescription:"sortable"};function Oa(e){let{disabled:t,index:n,node:s,rect:i}=e;const[l,d]=o.useState(null),u=o.useRef(n);return lt(()=>{if(!t&&n!==u.current&&s.current){const f=i.current;if(f){const h=Ut(s.current,{ignoreTransform:!0}),m={x:f.left-h.left,y:f.top-h.top,scaleX:f.width/h.width,scaleY:f.height/h.height};(m.x||m.y)&&d(m)}}n!==u.current&&(u.current=n)},[t,n,s,i]),o.useEffect(()=>{l&&d(null)},[l]),l}function ds(e){let{animateLayoutChanges:t=La,attributes:n,disabled:s,data:i,getNewIndex:l=Ma,id:d,strategy:u,resizeObserverConfig:f,transition:h=Ia}=e;const{items:m,containerId:x,activeIndex:N,disabled:v,disableTransforms:R,sortedRects:j,overIndex:S,useDragOverlay:I,strategy:M}=o.useContext(ls),E=za(s,v),T=m.indexOf(d),O=o.useMemo(()=>({sortable:{containerId:x,index:T,items:m},...i}),[x,i,T,m]),z=o.useMemo(()=>m.slice(m.indexOf(d)),[m,d]),{rect:A,node:L,isOver:B,setNodeRef:H}=fa({id:d,data:O,disabled:E.droppable,resizeObserverConfig:{updateMeasurementsFor:z,...f}}),{active:F,activatorEvent:ge,activeNodeRect:ue,attributes:Ce,setNodeRef:Be,listeners:He,isDragging:se,over:Le,setActivatorNodeRef:ie,transform:et}=ca({id:d,data:O,attributes:{...Ta,...n},disabled:E.draggable}),Ie=Vs(H,Be),G=!!F,me=G&&!R&&hn(N)&&hn(S),Ye=!I&&se,$e=Ye&&me?et:null,Ue=me?$e??(u??M)({rects:j,activeNodeRect:ue,activeIndex:N,overIndex:S,index:T}):null,be=hn(N)&&hn(S)?l({id:d,items:m,activeIndex:N,overIndex:S}):T,Se=F==null?void 0:F.id,P=o.useRef({activeId:Se,items:m,newIndex:be,containerId:x}),We=m!==P.current.items,fe=t({active:F,containerId:x,isDragging:se,isSorting:G,id:d,index:T,items:m,newIndex:P.current.newIndex,previousItems:P.current.items,previousContainerId:P.current.containerId,transition:h,wasDragging:P.current.activeId!=null}),tt=Oa({disabled:!fe,index:T,node:L,rect:A});return o.useEffect(()=>{G&&P.current.newIndex!==be&&(P.current.newIndex=be),x!==P.current.containerId&&(P.current.containerId=x),m!==P.current.items&&(P.current.items=m)},[G,be,x,m]),o.useEffect(()=>{if(Se===P.current.activeId)return;if(Se!=null&&P.current.activeId==null){P.current.activeId=Se;return}const Ve=setTimeout(()=>{P.current.activeId=Se},50);return()=>clearTimeout(Ve)},[Se]),{active:F,activeIndex:N,attributes:Ce,data:O,rect:A,index:T,newIndex:be,items:m,isOver:B,isSorting:G,isDragging:se,listeners:He,node:L,overIndex:S,over:Le,setNodeRef:Ie,setActivatorNodeRef:ie,setDroppableNodeRef:H,setDraggableNodeRef:Be,transform:tt??Ue,transition:ye()};function ye(){if(tt||We&&P.current.newIndex===T)return $a;if(!(Ye&&!Dn(ge)||!h)&&(G||fe))return yt.Transition.toString({...h,property:cs})}}function za(e,t){var n,s;return typeof e=="boolean"?{draggable:e,droppable:!1}:{draggable:(n=e==null?void 0:e.draggable)!=null?n:t.draggable,droppable:(s=e==null?void 0:e.droppable)!=null?s:t.droppable}}V.Down,V.Right,V.Up,V.Left;const $r=["bg-sky-600","bg-emerald-600","bg-violet-600","bg-rose-600","bg-amber-600"];function Ft(e){if(!e)return"No date set";const t=new Date(e);if(isNaN(t.getTime()))return"Invalid date";const n=t.getDate(),s=t.toLocaleString("en-US",{month:"long"}),i=t.getFullYear();let l="th";return n===1||n===21||n===31?l="st":n===2||n===22?l="nd":(n===3||n===23)&&(l="rd"),`${n}${l} ${s} ${i}`}function Jn(e){return e?typeof e=="string"?/^\d{4}-\d{2}-\d{2}$/.test(e)?e:e.includes("T")?e.split("T")[0]:"":e instanceof Date&&!isNaN(e.getTime())?e.toISOString().split("T")[0]:"":""}function nr(e){return new Date(e).toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}function rr(e){return!e||e<=0?"":e<1024?`${e} B`:e<1024*1024?`${(e/1024).toFixed(1)} KB`:`${(e/(1024*1024)).toFixed(1)} MB`}function Fa(e){if(!e)return null;const n=e.trim().slice(0,10).match(/^(\d{4})-(\d{2})-(\d{2})$/);if(!n)return null;const s=Number(n[1]),i=Number(n[2])-1,l=Number(n[3]);return new Date(s,i,l)}function Pa(e){const t=(e.first_name||"").trim().charAt(0),n=(e.last_name||"").trim().charAt(0),s=(e.email||"").trim().charAt(0);return(`${t}${n}`.trim()||s||"U").toUpperCase()}const Kt=["Student's Phone Number:","Student's Email:","Emergency Phone Number:","Date of Birth:","","Education Background (Grades & Stream):","Gap explanation if applicable:","English Proficiency:","","Intended Level of Study:","Interested Program Of Study:","Institution/City Preference:","Maximum Budget:","","Funding Details:","Sponsor:","Source of Income:","Funds Breakdown:"].join(`
`),Ba=o.lazy(()=>bs(()=>import("./index.es-CTFh76Hg.js"),__vite__mapDeps([0,1,2,3])));function Ua({card:e,listTitle:t,profile:n,onClose:s,setSelectedCard:i,fetchBoard:l}){var Et;const[d,u]=o.useState(!1),[f,h]=o.useState([]),[m,x]=o.useState(null),[N,v]=o.useState([]),[R,j]=o.useState("country"),[S,I]=o.useState([]),[M,E]=o.useState([]),[T,O]=o.useState([]),[z,A]=o.useState(!1),[L,B]=o.useState(!1),[H,F]=o.useState((Et=e.description)!=null&&Et.trim()?e.description:Kt),[ge,ue]=o.useState(!1),Ce=o.useRef(null),[Be,He]=o.useState(!1),[se,Le]=o.useState(Jn(e.due_date)),[ie,et]=o.useState(!1),[Ie,G]=o.useState(!!e.payment_done),[me,Ye]=o.useState(!!e.dependant_payment_done),[$e,ae]=o.useState(!1),[Ue,be]=o.useState(!1),[Se,P]=o.useState(!1),[We,fe]=o.useState(!1),[tt,ye]=o.useState(!1),Ve=o.useRef(null),[De,Dt]=o.useState([]),[dt,ht]=o.useState(""),[le,nt]=o.useState(null),[Te,vt]=o.useState(0),[Oe,At]=o.useState(!1),[rt,qe]=o.useState(null),[Ae,ze]=o.useState(!1),[st,_e]=o.useState(!1),[Ge,Lt]=o.useState(!1),[gt,wt]=o.useState([]),[_t,It]=o.useState([]),[mt,Rt]=o.useState([]),[xt,$t]=o.useState(""),[te,ce]=o.useState(null),Y=Number(n==null?void 0:n.role_id)===1||Number(n==null?void 0:n.role_id)===2;o.useEffect(()=>{var k;const c=Array.isArray(e.country_label_ids)?e.country_label_ids:e.country_label_id!=null?[e.country_label_id]:[];h(c),x(e.intake_label_id??null);const y=Array.isArray(e.service_area_ids)?e.service_area_ids:e.service_area_id!=null?[e.service_area_id]:[];v(y),j("country"),F((k=e.description)!=null&&k.trim()?e.description:Kt),Le(Jn(e.due_date)),G(!!e.payment_done),Ye(!!e.dependant_payment_done),fe(!1),ye(!1),ze(!1),wt([]),It([]),Rt([]),$t(""),ce(null),ne(),ee()},[e]),o.useEffect(()=>{if(!L||!Ce.current)return;const c=Ce.current;c.style.height="0px",c.style.height=`${c.scrollHeight}px`},[L,H]),o.useEffect(()=>{Promise.all([at(),Nt(),Je()])},[e.id]),o.useEffect(()=>{const c=y=>{if(y.key==="Escape"){if(We){fe(!1);return}y.preventDefault(),s()}};return window.addEventListener("keydown",c),()=>window.removeEventListener("keydown",c)},[s,We]),o.useEffect(()=>{if(!We)return;const c=y=>{Ve.current&&(Ve.current.contains(y.target)||fe(!1))};return document.addEventListener("mousedown",c),()=>document.removeEventListener("mousedown",c)},[We]);const ne=async()=>{try{const c=await W.get(`/cards/${e.id}/activities`);Dt(c.data||[])}catch(c){console.error("Failed to fetch activities:",c)}},ve=async()=>{if(!(!dt.trim()&&!le)){At(!0);try{const c=new FormData;dt.trim()&&c.append("details",dt.trim()),le&&c.append("attachment",le),await W.post(`/cards/${e.id}/activities`,c),ht(""),nt(null),vt(y=>y+1),await ne()}catch(c){console.error("Failed to post comment:",c),alert("Could not post comment / attachment.")}finally{At(!1)}}},he=async c=>{try{qe(c.id);const y=await W.get(`/activities/${c.id}/attachment`,{responseType:"blob"}),k=new Blob([y.data],{type:c.attachment_mime||y.headers["content-type"]||"application/octet-stream"}),C=URL.createObjectURL(k);if(!window.open(C,"_blank","noopener,noreferrer")){const Qe=document.createElement("a");Qe.href=C,Qe.download=c.attachment_name||"attachment",document.body.appendChild(Qe),Qe.click(),document.body.removeChild(Qe)}window.setTimeout(()=>URL.revokeObjectURL(C),6e4)}catch(y){console.error("Failed to open attachment:",y),alert("Could not open attachment.")}finally{qe(null)}},ke=c=>`${c.first_name||""} ${c.last_name||""}`.trim()||c.email||`User #${c.id}`,it=c=>{const y=(c.first_name||"").trim().charAt(0),k=(c.last_name||"").trim().charAt(0),C=(c.email||"").trim().charAt(0);return(`${y}${k}`.trim()||C||"U").toUpperCase()},ee=async()=>{var c,y;_e(!0),ce(null);try{const k=await W.get(`/cards/${e.id}/members`),C=((c=k.data)==null?void 0:c.members)||[],Fe=Array.isArray((y=k.data)==null?void 0:y.options)?k.data.options:[],Qe=Fe.length>0?Fe:C;It(C),Rt(C.map(ut=>ut.id)),wt(Qe)}catch(k){console.error("Failed to fetch card members:",k),ce("Could not load members.")}finally{_e(!1)}},we=async()=>{ze(!0),await ee()},J=c=>{!Y||Ge||Rt(y=>y.includes(c)?y.filter(k=>k!==c):[...y,c])},Xe=async()=>{var c,y;if(Y){Lt(!0),ce(null);try{await W.put(`/cards/${e.id}/members`,{user_ids:mt}),await ee(),await ne(),await l(),ze(!1)}catch(k){console.error("Failed to save members:",k),ce(((y=(c=k==null?void 0:k.response)==null?void 0:c.data)==null?void 0:y.message)||"Could not save members.")}finally{Lt(!1)}}},Q=o.useMemo(()=>{const c=xt.trim().toLowerCase();return c?gt.filter(y=>`${y.first_name||""} ${y.last_name||""} ${y.email||""}`.toLowerCase().includes(c)):gt},[gt,xt]),Re=o.useMemo(()=>{var y;const c={total:De.length,comments:0,attachments:0,labelUpdates:0,paymentUpdates:0,latestAt:((y=De[0])==null?void 0:y.created_at)||null};for(const k of De)k.action==="commented"&&(c.comments+=1),(k.attachment_path||k.attachment_url)&&(c.attachments+=1),k.action.includes("label")&&(c.labelUpdates+=1),k.action.includes("payment")&&(c.paymentUpdates+=1);return c},[De]),Ee=c=>Array.isArray(c==null?void 0:c.data)?c.data:Array.isArray(c)?c:[],at=async()=>{A(!0);try{const c=await W.get("/country-labels");I(Ee(c.data))}catch(c){console.error("Failed to load country labels",c),alert("Could not load country labels.")}finally{A(!1)}},Nt=async()=>{A(!0);try{const c=await W.get("/intake-labels");E(Ee(c.data))}catch(c){console.error("Failed to load intake labels",c),alert("Could not load intake labels.")}finally{A(!1)}},Je=async()=>{A(!0);try{const c=await W.get("/service-areas");O(Ee(c.data))}catch(c){console.error("Failed to load service areas",c),alert("Could not load service areas.")}finally{A(!1)}},jt=async c=>{j(c),u(!0),c==="country"?await at():c==="intake"?await Nt():await Je()},rn=(c,y)=>{y(k=>k.includes(c)?k.filter(C=>C!==c):[...k,c])},Rn=async()=>{try{const c=[...new Set(f)],y=[...new Set(N)],k={country_label_id:c[0]??null,country_label_ids:c,intake_label_id:m??null,service_area_id:y[0]??null,service_area_ids:y};await W.put(`/cards/${e.id}/labels`,k),i(C=>C&&C.id===e.id?{...C,...k}:C),await l(),await ne(),u(!1)}catch(c){console.error("Failed to save labels:",c),alert("Could not save labels. Please try again.")}},En=async()=>{const c=H.trim();if(c===(e.description||"")){B(!1);return}ue(!0);try{await W.put(`/cards/${e.id}/description`,{description:c||null}),i(y=>y&&y.id===e.id?{...y,description:c||void 0}:y),await l(),await ne(),B(!1)}catch(y){console.error("Failed to save description:",y),alert("Could not save description.")}finally{ue(!1)}},sn=()=>{var c;F((c=e.description)!=null&&c.trim()?e.description:Kt),B(!0)},Mn=async()=>{et(!0);try{const c=se.trim()||null;await W.put(`/cards/${e.id}/due-date`,{due_date:c}),i(y=>y&&y.id===e.id?{...y,due_date:c??void 0}:y),await l(),await ne(),He(!1)}catch(c){console.error("Failed to save due date:",c),alert("Could not save due date."),await l()}finally{et(!1)}},Ln=()=>{He(!0)},In=async()=>{var y,k;if($e)return;ae(!0);const c=!Ie;try{await W.put(`/cards/${e.id}/payment`,{payment_done:c}),G(c),i(C=>C&&C.id===e.id?{...C,payment_done:c}:C),await l(),await ne()}catch(C){console.error("Failed to update payment status:",C),alert(((k=(y=C==null?void 0:C.response)==null?void 0:y.data)==null?void 0:k.message)||"Could not update payment status."),await l()}finally{ae(!1)}},$n=async()=>{var y,k;if(Ue)return;be(!0);const c=!me;try{await W.put(`/cards/${e.id}/dependant-payment`,{dependant_payment_done:c}),Ye(c),i(C=>C&&C.id===e.id?{...C,dependant_payment_done:c}:C),await l(),await ne()}catch(C){console.error("Failed to update dependant payment status:",C),alert(((k=(y=C==null?void 0:C.response)==null?void 0:y.data)==null?void 0:k.message)||"Could not update dependant payment status."),await l()}finally{be(!1)}},Tn=async()=>{var y,k;if(Se)return;P(!0);const c=!e.is_archived;try{if(await W.put(`/cards/${e.id}/archive`,{is_archived:c}),i(C=>C&&C.id===e.id?{...C,is_archived:c}:C),await l(),c){s();return}await ne()}catch(C){console.error("Failed to update archive status:",C),alert(((k=(y=C==null?void 0:C.response)==null?void 0:y.data)==null?void 0:k.message)||"Could not update archive status.")}finally{P(!1)}},On=()=>{if(f.length===0)return"Country";const c=f.map(y=>{var k;return(k=S.find(C=>C.id===y))==null?void 0:k.name}).filter(y=>!!y);return c.length>0?c.join(", "):"Country"},zn=()=>{var c;return((c=M.find(y=>y.id===m))==null?void 0:c.name)||"Intake"},an=()=>{if(N.length===0)return"Extra Service";const c=N.map(y=>{var k;return(k=T.find(C=>C.id===y))==null?void 0:k.name}).filter(y=>!!y);return c.length>0?c.join(", "):"Service"},Fn=/((?:https?:\/\/|www\.)[^\s]+)/gi,on=c=>/^(?:https?:\/\/|www\.)[^\s]+$/i.test(c),Pn=c=>/^https?:\/\//i.test(c)?c:`https://${c}`,Tt=c=>{if(!c)return null;const y=c.split(/\r?\n/);return y.map((k,C)=>r.jsxs(q.Fragment,{children:[k.split(Fn).map((Fe,Qe)=>{if(!Fe)return null;if(!on(Fe))return r.jsx(q.Fragment,{children:Fe},`text-${C}-${Qe}`);const ut=Fe.match(/^(.*?)([.,!?)]*)$/),ln=(ut==null?void 0:ut[1])||Fe,Wt=(ut==null?void 0:ut[2])||"";return r.jsxs(q.Fragment,{children:[r.jsx("a",{href:Pn(ln),target:"_blank",rel:"noopener noreferrer",className:"text-indigo-600 hover:text-indigo-700 underline break-all",children:ln}),Wt]},`link-${C}-${Qe}`)}),C<y.length-1?r.jsx("br",{}):null]},`line-${C}`))};return r.jsxs("div",{className:"fixed inset-0 bg-black/65 backdrop-blur-sm z-50 flex items-center justify-center p-4 sm:p-6",children:[r.jsxs("div",{className:"bg-white w-full max-w-6xl rounded-2xl shadow-2xl overflow-hidden max-h-[92vh] flex flex-col border border-gray-200/50",children:[r.jsxs("div",{className:"px-6 py-4 border-b bg-gradient-to-r from-indigo-50/60 to-white flex items-start justify-between gap-6",children:[r.jsx("div",{className:"flex-1 min-w-0 space-y-1",children:r.jsx("div",{className:"inline-flex items-center gap-2 px-4 py-1.5 bg-indigo-100/80 text-indigo-800 rounded-lg text-sm font-bold border border-indigo-200 shadow-sm",children:t})}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsxs("div",{className:"relative",ref:Ve,children:[r.jsx("button",{type:"button",onClick:()=>fe(c=>!c),className:"h-9 w-9 flex items-center justify-center rounded-lg border border-gray-200 bg-white hover:bg-gray-50",children:r.jsx(Is,{size:17,className:"text-gray-600"})}),We&&r.jsxs("div",{className:"absolute right-0 mt-2 w-60 rounded-lg border border-gray-200 bg-white shadow-lg p-1.5 z-20",children:[r.jsxs("button",{type:"button",onClick:()=>{fe(!1),In()},disabled:$e,className:`w-full flex items-center gap-2 rounded-md px-3 py-2 text-sm text-left transition ${$e?"text-gray-400 cursor-not-allowed":Ie?"text-emerald-700 hover:bg-emerald-50":"text-rose-700 hover:bg-rose-50"}`,children:[r.jsx(vr,{size:15}),$e?"Saving...":Ie?"Visa Payment Done":"Mark Visa Payment Done"]}),r.jsxs("button",{type:"button",onClick:()=>{fe(!1),$n()},disabled:Ue,className:`w-full flex items-center gap-2 rounded-md px-3 py-2 text-sm text-left transition ${Ue?"text-gray-400 cursor-not-allowed":me?"text-emerald-700 hover:bg-emerald-50":"text-amber-700 hover:bg-amber-50"}`,children:[r.jsx(vr,{size:15}),Ue?"Saving...":me?"Dependant Payment Done":"Mark Dependant Payment Done"]}),r.jsx("div",{className:"my-1 border-t border-gray-100"}),r.jsxs("button",{type:"button",onClick:()=>{fe(!1),Tn()},disabled:Se,className:`w-full flex items-center gap-2 rounded-md px-3 py-2 text-sm text-left transition ${Se?"text-gray-400 cursor-not-allowed":"text-amber-700 hover:bg-amber-50"}`,children:[r.jsx(Or,{size:15}),Se?"Saving...":e.is_archived?"Restore Card":"Archive Card"]})]})]}),r.jsx("button",{onClick:s,className:"h-9 w-9 flex items-center justify-center rounded-lg border border-red-200 bg-red-50 text-red-600 hover:bg-red-100",children:r.jsx(bt,{size:18})})]})]}),r.jsxs("div",{className:"flex flex-1 overflow-hidden",children:[r.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-7 bg-white",children:[r.jsx("div",{className:"flex items-start gap-3.5 pb-1",children:r.jsxs("h2",{className:"text-2xl font-extrabold text-gray-900 truncate leading-tight",children:[e.invoice||`ID-${e.id}`," ",e.first_name," ",e.last_name,"  ",Ft(e.created_at)]})}),r.jsxs("div",{className:"flex flex-wrap gap-1.5",children:[r.jsxs("button",{type:"button",onClick:()=>void jt("country"),className:"h-10 min-w-[100px] px-3 rounded-md bg-[#8f53c6] text-white text-sm font-bold border border-[#8f53c6] hover:brightness-95 transition flex items-center justify-center gap-1.5",children:[r.jsx(zs,{size:15,strokeWidth:2.2,className:"text-white/90"}),On()]}),r.jsxs("button",{type:"button",onClick:()=>void jt("intake"),className:"h-10 min-w-[100px] px-3 rounded-md bg-[#f2b205] text-[#4a2b00] text-sm font-bold border border-[#f2b205] hover:brightness-95 transition flex items-center justify-center gap-1.5",children:[r.jsx(Fr,{size:15,strokeWidth:2.2,className:"text-[#4a2b00]/90"}),zn()]}),r.jsxs("button",{type:"button",onClick:()=>void jt("serviceArea"),className:"h-10 px-3 rounded-md bg-[#d63a3a] text-white text-sm font-bold border border-[#d63a3a] hover:brightness-95 transition flex items-center gap-1.5",children:[r.jsx(bn,{size:14,className:"text-white/90"}),an()]}),r.jsxs("button",{type:"button",onClick:Ln,className:"h-10 px-3 rounded-md bg-[#4f46e5] text-white text-sm font-bold border border-[#4f46e5] hover:brightness-95 transition flex items-center gap-1.5",children:[r.jsx(As,{size:15,strokeWidth:2.2,className:"text-white/90"}),e.due_date?Ft(e.due_date):"Due Dates"]})]}),r.jsx("div",{className:"space-y-6",children:r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-bold text-gray-700 mb-2.5",children:"Members"}),r.jsxs("div",{className:"flex items-center gap-2",children:[_t.slice(0,3).map(c=>r.jsx("button",{type:"button",onClick:we,title:ke(c),className:"h-10 w-10 rounded-full bg-sky-600 text-white text-sm font-bold flex items-center justify-center hover:brightness-110 transition",children:it(c)},c.id)),r.jsx("button",{type:"button",onClick:we,className:"h-10 w-10 rounded-full bg-gray-200 text-gray-700 text-xl flex items-center justify-center hover:bg-gray-300 transition",title:"Manage members",children:r.jsx(bn,{size:18})})]})]})}),r.jsxs("div",{className:"bg-gray-50/70 border border-gray-200 rounded-xl overflow-hidden",children:[r.jsxs("div",{className:"flex items-center justify-between px-5 py-3.5 border-b bg-white/60",children:[r.jsxs("div",{className:"flex items-center gap-2.5",children:[r.jsx(zr,{size:18,className:"text-indigo-600"}),r.jsx("h3",{className:"font-bold text-gray-800",children:"Description"})]}),L?r.jsxs("div",{className:"flex gap-3",children:[r.jsx("button",{onClick:()=>{var c;B(!1),F((c=e.description)!=null&&c.trim()?e.description:Kt)},className:"px-4 py-1.5 text-sm text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded",disabled:ge,children:"Cancel"}),r.jsx("button",{onClick:En,className:`px-5 py-1.5 text-sm font-bold rounded text-white ${ge?"bg-indigo-400 cursor-not-allowed":"bg-indigo-600 hover:bg-indigo-700"}`,disabled:ge,children:ge?"Saving...":"Save"})]}):r.jsxs("button",{onClick:sn,className:"flex items-center gap-1.5 text-sm text-indigo-600 hover:text-indigo-800 font-bold transition",children:[r.jsx(Tr,{size:14}),"Edit"]})]}),L?r.jsx("div",{className:"p-5",children:r.jsx("textarea",{ref:Ce,value:H,onChange:c=>F(c.target.value),className:"w-full border border-gray-300 rounded-lg px-4 py-3 text-sm resize-none overflow-hidden min-h-[180px] focus:outline-none focus:ring-2 focus:ring-indigo-400 transition",placeholder:"Fill student profile details...",autoFocus:!0})}):r.jsx("div",{onClick:sn,className:"px-5 py-5 text-sm text-gray-800 space-y-2 leading-relaxed cursor-pointer hover:bg-white/40 transition",title:"Click to edit description",children:e.description&&e.description.trim()?e.description.split(`
`).map((c,y)=>r.jsx("p",{children:c},y)):Kt.split(`
`).map((c,y)=>r.jsx("p",{className:"text-gray-500",children:c||""},y))})]})]}),r.jsxs("div",{className:"w-full sm:w-[360px] bg-gray-50 border-l border-gray-200 flex flex-col overflow-hidden",children:[r.jsxs("div",{className:"px-5 py-4 border-b bg-white/80 flex items-center justify-between",children:[r.jsx("h3",{className:"font-bold text-gray-800",children:"Comments & Activity"}),r.jsxs("button",{type:"button",onClick:()=>ye(!0),className:"inline-flex items-center gap-1.5 text-sm px-3 py-1.5 bg-white border border-gray-200 rounded-lg hover:bg-gray-50 transition",children:[r.jsx(Rs,{size:14}),"Summary"]})]}),r.jsxs("div",{className:"flex-1 p-5 space-y-6 overflow-y-auto overflow-x-hidden",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx("textarea",{value:dt,onChange:c=>ht(c.target.value),placeholder:"Write a comment...",className:"w-full border border-gray-300 rounded-lg px-4 py-3 text-sm resize-none h-28 focus:outline-none focus:ring-2 focus:ring-indigo-400 focus:border-indigo-400 transition"}),r.jsxs("div",{className:"flex items-center justify-between gap-3",children:[r.jsxs("label",{className:"inline-flex items-center gap-2 px-3 py-2 text-sm border border-gray-300 rounded-lg bg-white hover:bg-gray-50 cursor-pointer",children:[r.jsx(wr,{size:14,className:"text-gray-600"}),r.jsx("span",{children:"Attach file"}),r.jsx("input",{type:"file",className:"hidden",onChange:c=>{var k;const y=((k=c.target.files)==null?void 0:k[0])||null;nt(y)}},Te)]}),le&&r.jsx("button",{type:"button",onClick:()=>{nt(null),vt(c=>c+1)},className:"text-xs text-red-600 hover:underline",children:"Remove file"})]}),le&&r.jsxs("div",{className:"text-xs text-gray-600 bg-white border border-gray-200 rounded-lg px-3 py-2",children:[r.jsx("span",{className:"font-bold",children:le.name}),r.jsx("span",{className:"ml-2 text-gray-500",children:rr(le.size)})]}),r.jsx("button",{onClick:ve,disabled:Oe||!dt.trim()&&!le,className:`w-full py-2 text-sm font-bold rounded-lg text-white ${Oe?"bg-indigo-400 cursor-not-allowed":"bg-indigo-600 hover:bg-indigo-700"}`,children:Oe?"Posting...":"Post Update"})]}),r.jsx("div",{className:"space-y-6",children:De.length===0?r.jsx("p",{className:"text-center text-gray-500",children:"No activities yet"}):De.map(c=>r.jsxs("div",{className:"flex gap-3",children:[r.jsx("div",{className:"w-9 h-9 bg-teal-600 text-white rounded-full flex items-center justify-center font-bold text-sm shrink-0",children:(c.user_name||"U").charAt(0).toUpperCase()}),r.jsxs("div",{className:"flex-1 space-y-1.5",children:[r.jsxs("p",{className:"text-sm leading-relaxed",children:[r.jsx("strong",{className:"text-gray-900",children:c.user_name||"User"})," ",c.action,c.details&&c.action!=="commented"?r.jsxs(r.Fragment,{children:[" ",Tt(c.details)]}):null]}),r.jsx("p",{className:"text-xs text-gray-500",children:nr(c.created_at)}),c.action==="commented"&&c.details&&r.jsx("div",{className:"mt-2 bg-white border border-gray-200 rounded-lg p-3 text-sm text-gray-700 whitespace-pre-wrap break-words",children:Tt(c.details)}),(c.attachment_path||c.attachment_url)&&r.jsxs("button",{type:"button",onClick:()=>void he(c),disabled:rt===c.id,className:"mt-2 inline-flex items-center gap-2 bg-white border border-gray-200 rounded-lg px-3 py-2 text-sm text-indigo-700 hover:bg-indigo-50 disabled:opacity-60",children:[r.jsx(wr,{size:14}),r.jsx("span",{children:rt===c.id?"Opening...":c.attachment_name||"Attachment"}),c.attachment_size?r.jsxs("span",{className:"text-xs text-gray-500",children:["(",rr(c.attachment_size),")"]}):null]}),r.jsx("button",{className:"text-xs text-gray-500 hover:text-gray-700 underline mt-1 transition",children:"Reply"})]})]},c.id))})]})]})]})]}),tt&&r.jsx("div",{className:"fixed inset-0 bg-black/45 z-[65] flex items-center justify-center p-4",children:r.jsxs("div",{className:"w-full max-w-md rounded-2xl border border-gray-200 bg-white shadow-2xl overflow-hidden",children:[r.jsxs("div",{className:"px-5 py-4 border-b bg-gray-50 flex items-center justify-between",children:[r.jsx("h4",{className:"text-base font-bold text-gray-900",children:"Activity Summary"}),r.jsx("button",{type:"button",onClick:()=>ye(!1),className:"h-8 w-8 rounded-md border border-gray-200 bg-white text-gray-600 hover:bg-gray-100 flex items-center justify-center",children:r.jsx(bt,{size:16})})]}),r.jsxs("div",{className:"p-5 space-y-3 text-sm text-gray-700",children:[r.jsxs("p",{children:[r.jsx("span",{className:"font-bold text-gray-900",children:"Total activities:"})," ",Re.total]}),r.jsxs("p",{children:[r.jsx("span",{className:"font-bold text-gray-900",children:"Comments:"})," ",Re.comments]}),r.jsxs("p",{children:[r.jsx("span",{className:"font-bold text-gray-900",children:"Attachments:"})," ",Re.attachments]}),r.jsxs("p",{children:[r.jsx("span",{className:"font-bold text-gray-900",children:"Label updates:"})," ",Re.labelUpdates]}),r.jsxs("p",{children:[r.jsx("span",{className:"font-bold text-gray-900",children:"Payment updates:"})," ",Re.paymentUpdates]}),r.jsxs("p",{children:[r.jsx("span",{className:"font-bold text-gray-900",children:"Last activity:"})," ",Re.latestAt?nr(Re.latestAt):"No activity yet"]})]}),r.jsx("div",{className:"px-5 py-4 border-t bg-gray-50 flex justify-end",children:r.jsx("button",{type:"button",onClick:()=>ye(!1),className:"px-4 py-2 rounded-lg bg-indigo-600 text-white text-sm font-bold hover:bg-indigo-700",children:"Close"})})]})}),Be&&r.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[60] p-4",children:r.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md p-6",children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"Select Due Date"}),r.jsx("button",{onClick:()=>He(!1),className:"text-gray-500 hover:text-gray-700",children:r.jsx(bt,{size:20})})]}),r.jsx(o.Suspense,{fallback:r.jsx("div",{className:"py-8 text-center text-gray-500",children:"Loading calendar..."}),children:r.jsx("div",{className:"flex justify-center mb-4",children:r.jsx(Ba,{inline:!0,selected:se?new Date(se):null,onChange:c=>{Le(c?c.toISOString().split("T")[0]:"")},dateFormat:"yyyy-MM-dd"})})}),se?r.jsx("div",{className:"mb-4 text-sm text-gray-600",children:`Selected: ${Ft(se)}`}):null,r.jsxs("div",{className:"flex justify-end gap-3",children:[r.jsx("button",{onClick:()=>Le(""),className:"px-5 py-2 text-sm text-gray-700 hover:bg-gray-100 rounded-lg",disabled:ie,children:"Clear"}),r.jsx("button",{onClick:()=>{He(!1),Le(Jn(e.due_date))},className:"px-5 py-2 text-sm text-gray-700 hover:bg-gray-100 rounded-lg",disabled:ie,children:"Cancel"}),r.jsx("button",{onClick:Mn,className:`px-6 py-2 text-sm font-bold text-white rounded-lg ${ie?"bg-indigo-400 cursor-not-allowed":"bg-indigo-600 hover:bg-indigo-700"}`,disabled:ie,children:ie?"Saving...":"Save Date"})]})]})}),Ae&&r.jsx("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-[60] p-4",children:r.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-xl max-h-[85vh] overflow-hidden flex flex-col",children:[r.jsxs("div",{className:"p-6 border-b flex items-center justify-between",children:[r.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Card Members"}),r.jsx("button",{onClick:()=>ze(!1),className:"text-gray-500 hover:text-gray-700",children:r.jsx(bt,{size:24})})]}),r.jsxs("div",{className:"p-6 space-y-4 flex-1 overflow-y-auto",children:[r.jsx("p",{className:"text-sm text-gray-600",children:"If no members are selected, everyone with board access can see this card."}),Y&&r.jsx("input",{value:xt,onChange:c=>$t(c.target.value),placeholder:"Search user by name or email...",className:"w-full h-10 rounded-lg border border-gray-300 px-3 text-sm focus:outline-none focus:ring-2 focus:ring-indigo-400"}),te&&r.jsx("div",{className:"text-sm text-red-600 bg-red-50 border border-red-200 rounded-lg px-3 py-2",children:te}),st?r.jsx("div",{className:"text-center py-10 text-gray-500",children:"Loading members..."}):r.jsx("div",{className:"border border-gray-200 rounded-xl overflow-hidden",children:Q.length===0?r.jsx("div",{className:"py-8 text-center text-sm text-gray-500",children:"No users found for roles 2, 3, and 4."}):r.jsx("div",{className:"max-h-[330px] overflow-y-auto divide-y",children:Q.map(c=>{const y=mt.includes(c.id);return r.jsxs("label",{className:`flex items-center gap-3 px-4 py-3 ${Y?"cursor-pointer hover:bg-gray-50":""}`,children:[r.jsx("input",{type:"checkbox",checked:y,disabled:!Y||Ge,onChange:()=>J(c.id),className:"h-4 w-4 rounded text-indigo-600"}),r.jsxs("div",{className:"min-w-0",children:[r.jsx("p",{className:"text-sm font-bold text-gray-900 truncate",children:ke(c)}),c.email?r.jsx("p",{className:"text-xs text-gray-500 truncate",children:c.email}):null]})]},c.id)})})})]}),r.jsxs("div",{className:"p-5 border-t flex justify-end gap-3",children:[r.jsx("button",{onClick:()=>ze(!1),className:"px-5 py-2.5 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:"Close"}),Y&&r.jsx("button",{onClick:Xe,disabled:Ge||st,className:`px-6 py-2.5 rounded-lg text-white font-bold ${Ge||st?"bg-indigo-400 cursor-not-allowed":"bg-indigo-600 hover:bg-indigo-700"}`,children:Ge?"Saving...":"Save Members"})]})]})}),d&&r.jsx("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-[60] p-4",children:r.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-lg max-h-[85vh] overflow-hidden flex flex-col",children:[r.jsxs("div",{className:"p-6 border-b flex items-center justify-between",children:[r.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Select Labels"}),r.jsx("button",{onClick:()=>u(!1),className:"text-gray-500 hover:text-gray-700",children:r.jsx(bt,{size:24})})]}),r.jsx("div",{className:"p-6 flex-1 overflow-y-auto space-y-8",children:z?r.jsx("div",{className:"text-center py-10 text-gray-500",children:"Loading labels..."}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("button",{type:"button",onClick:()=>void jt("country"),className:`px-3 py-1.5 rounded-md text-sm font-bold border transition ${R==="country"?"bg-[#8f53c6] text-white border-[#8f53c6]":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:"Country"}),r.jsx("button",{type:"button",onClick:()=>void jt("intake"),className:`px-3 py-1.5 rounded-md text-sm font-bold border transition ${R==="intake"?"bg-[#f2b205] text-[#4a2b00] border-[#f2b205]":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:"Intake"}),r.jsx("button",{type:"button",onClick:()=>void jt("serviceArea"),className:`px-3 py-1.5 rounded-md text-sm font-bold border transition ${R==="serviceArea"?"bg-[#d63a3a] text-white border-[#d63a3a]":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:"Service Area"})]}),R==="country"?r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Country (multi-select)"}),r.jsx("div",{className:"max-h-64 overflow-y-auto border border-gray-200 rounded-lg divide-y",children:S.length===0?r.jsx("div",{className:"px-4 py-6 text-sm text-gray-500 text-center",children:"No countries found"}):S.map(c=>{const y=f.includes(c.id);return r.jsxs("label",{className:"flex items-center gap-3 px-4 py-2.5 hover:bg-gray-50 cursor-pointer",children:[r.jsx("input",{type:"checkbox",checked:y,onChange:()=>rn(c.id,h),className:"h-4 w-4 rounded text-indigo-600"}),r.jsx("span",{className:"text-sm text-gray-800",children:c.name})]},c.id)})})]}):R==="intake"?r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Intake / Semester"}),r.jsxs("select",{value:m??"",onChange:c=>x(c.target.value?Number(c.target.value):null),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",children:[r.jsx("option",{value:"",children:"Select an intake"}),M.map(c=>r.jsx("option",{value:c.id,children:c.name},c.id))]})]}):r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Service Area (multi-select)"}),r.jsx("div",{className:"max-h-64 overflow-y-auto border border-gray-200 rounded-lg divide-y",children:T.length===0?r.jsx("div",{className:"px-4 py-6 text-sm text-gray-500 text-center",children:"No service areas found"}):T.map(c=>{const y=N.includes(c.id);return r.jsxs("label",{className:"flex items-center gap-3 px-4 py-2.5 hover:bg-gray-50 cursor-pointer",children:[r.jsx("input",{type:"checkbox",checked:y,onChange:()=>rn(c.id,v),className:"h-4 w-4 rounded text-indigo-600"}),r.jsx("span",{className:"text-sm text-gray-800",children:c.name})]},c.id)})})]})]})}),r.jsxs("div",{className:"p-5 border-t flex justify-end gap-4",children:[r.jsx("button",{onClick:()=>u(!1),className:"px-6 py-2.5 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:"Cancel"}),r.jsx("button",{onClick:Rn,className:"px-6 py-2.5 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 font-bold",children:"Save"})]})]})})]})}function Wa({card:e,onClick:t,labelBadges:n=[],dragDisabled:s=!1}){const{setNodeRef:i,attributes:l,listeners:d,transform:u,transition:f}=ds({id:e.id,disabled:s}),h={transform:yt.Transform.toString(u),transition:f},x=`${e.invoice||`ID-${e.id}`} ${e.first_name||""} ${e.last_name||""}`.trim(),N=n.filter(v=>v.kind==="country"||v.kind==="intake");return r.jsxs("div",{ref:i,style:h,...l,...d,onClick:()=>t(e),className:`relative bg-white rounded-xl border border-gray-200 px-3 py-2.5 shadow-sm transition-shadow select-none ${s?"cursor-default":"cursor-pointer hover:shadow-md"}`,children:[r.jsx("button",{className:"absolute right-2.5 top-2.5 p-1.5 rounded-md hover:bg-gray-100 shrink-0",children:r.jsx(Tr,{size:16,className:"text-gray-600"})}),r.jsxs("div",{className:"min-w-0",children:[r.jsx("div",{className:"pr-9",children:r.jsx("p",{className:"text-sm font-bold text-indigo-700",children:x})}),(N.length>0||e.members&&e.members.length>0)&&r.jsxs("div",{className:"mt-3 flex w-full items-start gap-2",children:[N.length>0?r.jsxs("div",{className:"flex min-w-0 flex-1 flex-wrap items-center gap-1.5",children:[r.jsx(Fr,{size:12,className:"text-gray-500"}),N.map((v,R)=>r.jsx("span",{className:`px-2 py-0.5 rounded-md text-[10px] font-semibold ${v.kind==="country"?"bg-[#8f53c6] text-white":"bg-[#f2b205] text-[#4a2b00]"}`,children:v.name},`${v.kind}-${v.name}-${R}`))]}):r.jsx("div",{className:"flex-1"}),e.members&&e.members.length>0?r.jsxs("div",{className:"ml-auto -mr-1 flex shrink-0 flex-row-reverse items-center justify-end -space-x-1 space-x-reverse",children:[e.members.slice(0,3).map((v,R)=>r.jsx("div",{className:`h-5 w-5 rounded-full border border-white text-white text-[9px] font-semibold flex items-center justify-center ${$r[(v.id+R)%$r.length]}`,title:`${v.first_name||""} ${v.last_name||""}`.trim()||"Member",children:Pa(v)},`card-${e.id}-member-${v.id}`)),e.members.length>3&&r.jsxs("div",{className:"mr-1 text-[10px] font-semibold text-gray-500",children:["+",e.members.length-3]})]}):null]})]})]})}function Va({list:e,children:t,dragDisabled:n=!1}){const{setNodeRef:s,transform:i,transition:l,attributes:d,listeners:u,isDragging:f}=ds({id:`list-${e.id}`,disabled:{draggable:n,droppable:!1},transition:{duration:180,easing:"cubic-bezier(0.2, 0, 0, 1)"}}),h={transform:yt.Transform.toString(i),transition:l},m=n?{}:{...d,...u};return r.jsx("div",{ref:s,style:h,className:`w-80 bg-white rounded-xl border border-gray-200 shadow-md flex flex-col min-h-[120px] will-change-transform ${f?"opacity-35":""}`,children:typeof t=="function"?t({dragHandleProps:m,isDragging:f}):t})}function eo(){const{boardId:e}=ys(),t=vs(),[n,s]=o.useState(null),[i,l]=o.useState(!0),[d,u]=o.useState(null),[f,h]=o.useState(null),[m,x]=o.useState(null),[N,v]=o.useState(null),[R,j]=o.useState(!1),[S,I]=o.useState(""),[M,E]=o.useState(0),[T,O]=o.useState(null),[z,A]=o.useState(""),[L,B]=o.useState(""),[H,F]=o.useState(""),[ge,ue]=o.useState(null),[Ce,Be]=o.useState(""),[He,se]=o.useState(null),[Le,ie]=o.useState(""),[et,Ie]=o.useState(null),[G,me]=o.useState(!1),[Ye,$e]=o.useState(!1),[ae,Ue]=o.useState(!1),[be,Se]=o.useState("all"),[P,We]=o.useState([]),[fe,tt]=o.useState(!1),[ye,Ve]=o.useState(null),[De,Dt]=o.useState([]),[dt,ht]=o.useState(!1),[le,nt]=o.useState(null),[Te,vt]=o.useState([]),[Oe,At]=o.useState([]),[rt,qe]=o.useState([]),[Ae,ze]=o.useState("all"),[st,_e]=o.useState(null),[Ge,Lt]=o.useState([]),[gt,wt]=o.useState([]),[_t,It]=o.useState([]),[mt,Rt]=o.useState({}),[xt,$t]=o.useState({}),[te,ce]=o.useState({}),Y=o.useRef(null),ne=o.useRef(null),ve=o.useRef(null),he=o.useRef(null),ke=o.useRef(null),[it,ee]=o.useState(!1),we=o.useDeferredValue(Le.trim().toLowerCase()),J=we.length>0,Xe=we==="*",Q=Te.length>0||Oe.length>0||rt.length>0||Ae!=="all",Re=Xe||Q,Ee=(a,g)=>{g(p=>p.includes(a)?p.filter(b=>b!==a):[...p,a])},at=(a,g,p)=>{if(a.length===0)return p;const b=g.filter(w=>a.includes(w.id)).map(w=>w.name);return b.length===0?`${a.length} selected`:b.length<=2?b.join(", "):`${b.slice(0,2).join(", ")} +${b.length-2}`},Nt=ii(si(ur,{activationConstraint:{distance:2}})),Je=async()=>{try{const a=await W.get(`/boards/${e}`,{params:{with:"lists.cards"}}),g=a.data.data||a.data;g.lists=[...g.lists||[]].sort((p,b)=>p.position-b.position),g.lists.forEach(p=>{p.cards=[...p.cards||[]].sort((b,w)=>b.position-w.position)}),s(g)}catch(a){console.error("Fetch board failed",a)}},jt=async()=>{if(e){ht(!0);try{const a=await W.get(`/boards/${e}/archived-cards`);Dt(Array.isArray(a.data)?a.data:[])}catch(a){console.error("Fetch archived cards failed",a),alert("Could not load archived cards.")}finally{ht(!1)}}},rn=async()=>{$e(!0),await jt()},Rn=async(a=be)=>{var g;if(e){tt(!0);try{const p=await W.get(`/boards/${e}/activities`,{params:{tab:a,limit:300}}),b=Array.isArray((g=p.data)==null?void 0:g.data)?p.data.data:Array.isArray(p.data)?p.data:[];We(b)}catch(p){console.error("Fetch board activities failed",p),alert("Could not load board activities.")}finally{tt(!1)}}},En=()=>{Ue(!0)},sn=async a=>{nt(a);try{await W.put(`/cards/${a}/archive`,{is_archived:!1}),Dt(g=>g.filter(p=>p.id!==a)),await Je()}catch(g){console.error("Restore archived card failed",g),alert("Could not restore card.")}finally{nt(null)}};o.useEffect(()=>{(async()=>{l(!0);try{const[,g]=await Promise.all([Je(),ws()]);u(g)}finally{l(!1)}})()},[e]),o.useEffect(()=>{(async()=>{try{const[g,p,b]=await Promise.all([W.get("/country-labels"),W.get("/intake-labels"),W.get("/service-areas")]),w=re=>Array.isArray(re==null?void 0:re.data)?re.data:Array.isArray(re)?re:[],_=w(g.data),Ne=w(p.data),de=w(b.data);Lt(_),wt(Ne),It(de),Rt(_.reduce((re,oe)=>(re[oe.id]=oe.name,re),{})),$t(Ne.reduce((re,oe)=>(re[oe.id]=oe.name,re),{})),ce(de.reduce((re,oe)=>(re[oe.id]=oe.name,re),{}))}catch(g){console.error("Failed to load label maps",g)}})()},[]),o.useEffect(()=>{const a=()=>{window.setTimeout(()=>{var b,w;(b=ne.current)==null||b.focus(),(w=ne.current)==null||w.select()},0)},g=b=>{if(!(b instanceof HTMLElement))return!1;const w=b.tagName.toLowerCase();return w==="input"||w==="textarea"||w==="select"||b.isContentEditable},p=b=>{var Ne,de;const w=b.key.toLowerCase(),_=g(b.target);if((b.ctrlKey||b.metaKey)&&w==="k"){b.preventDefault(),(Ne=Y.current)==null||Ne.focus(),(de=Y.current)==null||de.select();return}if(b.key==="Escape"&&document.activeElement===Y.current){ie("");return}if(b.key==="Escape"&&ae){Ue(!1);return}if(b.key==="Escape"&&G){me(!1);return}if(!(b.ctrlKey||b.metaKey||b.altKey)){if(!_&&w==="f"){b.preventDefault(),me(!0),a();return}if(b.key==="*"||b.code==="NumpadMultiply"){if(_&&document.activeElement!==ne.current)return;b.preventDefault(),me(!0),ie("*"),a()}}};return window.addEventListener("keydown",p),()=>window.removeEventListener("keydown",p)},[ae,G]),o.useEffect(()=>{if(!G)return;const a=g=>{ve.current&&(ve.current.contains(g.target)||me(!1))};return document.addEventListener("mousedown",a),()=>document.removeEventListener("mousedown",a)},[G]),o.useEffect(()=>{G||_e(null)},[G]),o.useEffect(()=>{ae&&Rn(be)},[ae,be,e]),o.useEffect(()=>{if(!it)return;const a=p=>{const b=ke.current,w=he.current;if(!b||!w)return;const _=p.clientX-b.x;w.scrollLeft=b.scrollLeft-_},g=()=>{ee(!1),ke.current=null};return window.addEventListener("mousemove",a),window.addEventListener("mouseup",g),()=>{window.removeEventListener("mousemove",a),window.removeEventListener("mouseup",g)}},[it]);const Mn=a=>{if(!n)return"Unknown";const g=n.lists.find(p=>p.id===a.board_list_id);return(g==null?void 0:g.title)||"Unknown"},Ln=a=>{const g=[];return(Array.isArray(a.country_label_ids)&&a.country_label_ids.length>0?a.country_label_ids:a.country_label_id!=null?[a.country_label_id]:[]).forEach(w=>{g.push({name:mt[w]||`Country #${w}`,kind:"country"})}),a.intake_label_id!=null&&g.push({name:xt[a.intake_label_id]||`Intake #${a.intake_label_id}`,kind:"intake"}),(Array.isArray(a.service_area_ids)&&a.service_area_ids.length>0?a.service_area_ids:a.service_area_id!=null?[a.service_area_id]:[]).forEach(w=>{g.push({name:te[w]||`Service Area #${w}`,kind:"serviceArea"})}),g},In=a=>{var w;const g=a.card;if(!g)return a.card_id?`Card #${a.card_id}`:"Card";const p=`${g.first_name||""} ${g.last_name||""}`.trim(),b=((w=g.invoice)==null?void 0:w.trim())||"";return b&&p?`${b} ${p}`:b||p||`Card #${g.id}`},$n=a=>{var g,p,b,w,_;return(g=a.list)!=null&&g.title?a.list.title:(b=(p=a.card)==null?void 0:p.boardList)!=null&&b.title?a.card.boardList.title:(_=(w=a.card)==null?void 0:w.board_list)!=null&&_.title?a.card.board_list.title:a.list_id?`List #${a.list_id}`:"Board"},Tn=/((?:https?:\/\/|www\.)[^\s]+)/gi,On=a=>/^(?:https?:\/\/|www\.)[^\s]+$/i.test(a),zn=a=>/^https?:\/\//i.test(a)?a:`https://${a}`,an=a=>{if(!a)return null;const g=a.split(/\r?\n/);return g.map((p,b)=>r.jsxs("span",{children:[p.split(Tn).map((w,_)=>{if(!w)return null;if(!On(w))return r.jsx("span",{children:w},`activity-text-${b}-${_}`);const Ne=w.match(/^(.*?)([.,!?)]*)$/),de=(Ne==null?void 0:Ne[1])||w,re=(Ne==null?void 0:Ne[2])||"";return r.jsxs("span",{children:[r.jsx("a",{href:zn(de),target:"_blank",rel:"noopener noreferrer",className:"text-indigo-600 hover:text-indigo-700 underline break-all",children:de}),re]},`activity-link-${b}-${_}`)}),b<g.length-1?r.jsx("br",{}):null]},`activity-line-${b}`))},Fn=async a=>{if(!(!a.attachment_path&&!a.attachment_url))try{Ve(a.id);const g=await W.get(`/activities/${a.id}/attachment`,{responseType:"blob"}),p=new Blob([g.data],{type:a.attachment_mime||g.headers["content-type"]||"application/octet-stream"}),b=window.URL.createObjectURL(p),w=document.createElement("a");w.href=b,w.target="_blank",a.attachment_name&&(w.download=a.attachment_name),document.body.appendChild(w),w.click(),w.remove(),window.URL.revokeObjectURL(b)}catch(g){console.error("Open board activity attachment failed",g),alert("Could not open attachment.")}finally{Ve(null)}},on=async(a,g,p,b)=>{try{await W.post("/activities",{card_id:p??null,list_id:b??null,action:a,details:g})}catch(w){console.error("Failed to log activity:",w)}},Pn=async()=>{if(!S.trim()||!n)return;const a=n.lists.length+1,g={id:Date.now(),board_id:n.id,title:S.trim(),category:M,position:a,created_at:new Date().toISOString(),updated_at:new Date().toISOString(),cards:[]};s(p=>p?{...p,lists:[...p.lists,g]}:null),I(""),E(0),j(!1);try{const b=(await W.post(`/boards/${n.id}/lists`,{title:g.title,category:g.category??0,position:a})).data.id;await on("created list",`List: ${g.title}`,void 0,b),await Je()}catch(p){console.error("Create list failed",p),await Je()}},Tt=Number(d==null?void 0:d.role_id)===1,Et=Number(d==null?void 0:d.role_id)===1,c=a=>{!Tt||He!==null||(ue(a.id),Be(a.title))},y=async a=>{if(!n)return;const g=Ce.trim();if(!g){Be(a.title),ue(null);return}if(g===a.title){ue(null);return}se(a.id);try{await W.put(`/boards/${n.id}/lists/${a.id}`,{title:g}),s(p=>p&&{...p,lists:p.lists.map(b=>b.id===a.id?{...b,title:g}:b)}),ue(null)}catch(p){console.error("Update list title failed",p),alert("Could not update list title."),Be(a.title)}finally{se(null)}},k=async a=>{if(!z.trim()){alert("Invoice is required.");return}const g={invoice:z.trim(),first_name:L.trim()||void 0,last_name:H.trim()||void 0};try{const b=(await W.post(`/board-lists/${a}/cards`,g)).data.id;await on("created card",`Card: ${g.invoice} ${g.first_name||""} ${g.last_name||""}`.trim(),b),A(""),B(""),F(""),O(null),await Je()}catch(p){console.error("Create card failed",p),alert("Could not create card. Please check invoice uniqueness.")}},C=()=>{A(""),B(""),F(""),O(null)},Fe=a=>{const g=String(a);if(!g.startsWith("list-"))return null;const p=Number(g.slice(5));return Number.isFinite(p)?p:null},Qe=a=>{if(String(a.active.id).startsWith("list-"))return di(a);const p=gi(a);return p.length>0?p:ci(a)},ut=a=>{if(!n)return;const g=Fe(a.active.id);if(g!=null){if(!Et||J||Q)return;v(g);return}if(v(null),J||Q)return;const p=Number(a.active.id);for(const b of n.lists){const w=b.cards.find(_=>_.id===p);if(w){x(w);break}}},ln=async a=>{var X,St;if(x(null),v(null),!n||!a.over)return;const g=Fe(a.active.id),p=Fe(a.over.id);if(g!=null){if(!Et||J||Q||p==null||g===p)return;const $=n.lists.find(K=>K.id===g),U=n.lists.find(K=>K.id===p);if(!$||!U)return;const xe=$.category??0,Pe=U.category??0;if(xe!==Pe)return;const ot=n.lists.filter(K=>(K.category??0)===xe).sort((K,pt)=>K.position-pt.position),Xt=ot.findIndex(K=>K.id===g),Z=ot.findIndex(K=>K.id===p);if(Xt<0||Z<0||Xt===Z)return;const fn=[...ot],[ms]=fn.splice(Xt,1);fn.splice(Z,0,ms);const pr=fn.reduce((K,pt,ps)=>(K[pt.id]=ps+1,K),{}),xs={...n,lists:n.lists.map(K=>({...K,cards:K.cards.map(pt=>({...pt}))}))};s({...n,lists:n.lists.map(K=>pr[K.id]!=null?{...K,position:pr[K.id]}:K).sort((K,pt)=>K.position-pt.position)});try{await Promise.all(fn.map((K,pt)=>W.put(`/boards/${n.id}/lists/${K.id}`,{position:pt+1}))),await Je()}catch(K){console.error("Reorder lists failed",K),s(xs),alert("Could not reorder lists.")}return}if(J||Q)return;const b=Number(a.active.id);if(!Number.isFinite(b))return;const w=n.lists.findIndex($=>$.cards.some(U=>U.id===b));if(w<0)return;const _=n.lists[w],Ne=_.cards.findIndex($=>$.id===b);if(Ne<0)return;const de=_.cards[Ne],re=String(a.over.id);let oe=-1,Mt=-1;if(re.startsWith("list-")){const $=Number(re.replace("list-",""));oe=n.lists.findIndex(U=>U.id===$),oe>=0&&(Mt=n.lists[oe].cards.length)}else{const $=Number(a.over.id);Number.isFinite($)&&(oe=n.lists.findIndex(U=>U.cards.some(xe=>xe.id===$)),oe>=0&&(Mt=n.lists[oe].cards.findIndex(U=>U.id===$)))}if(oe<0||Mt<0)return;const Ct=n.lists[oe],Ot={...n,lists:n.lists.map($=>({...$,cards:$.cards.map(U=>({...U}))}))};if(_.id===Ct.id){const $=_.cards.length-1,U=Math.min(Mt,$);if(Ne===U)return;const xe=hr(_.cards,Ne,U).map((Pe,ot)=>({...Pe,position:ot+1}));s({...n,lists:n.lists.map((Pe,ot)=>ot===w?{...Pe,cards:xe}:Pe)});try{await Promise.all(xe.map((Pe,ot)=>W.put(`/board-lists/${_.id}/cards/${Pe.id}`,{position:ot+1}))),await Je()}catch(Pe){console.error("Reorder card failed",Pe),s(Ot)}return}const cn=_.category??0,dn=Ct.category??0;if(cn!==1&&dn===1&&!de.payment_done){Ie("This card is unpaid. Mark visa payment as done before moving it to Visa.");return}if(cn!==2&&dn===2&&!de.dependant_payment_done){Ie("Dependant payment is pending. Mark dependant payment as done before moving it to Dependant Visa.");return}const ft=n.lists.map($=>({...$,cards:$.cards.map(U=>({...U}))})),un=ft[w].cards.filter($=>$.id!==de.id),Vt=ft[oe].cards,D=Math.min(Math.max(Mt,0),Vt.length);Vt.splice(D,0,{...de,board_list_id:Ct.id}),ft[w].cards=un.map(($,U)=>({...$,position:U+1})),ft[oe].cards=Vt.map(($,U)=>({...$,board_list_id:Ct.id,position:U+1})),s({...n,lists:ft});try{await W.post("/cards/move",{card_id:de.id,to_list_id:Ct.id,position:D+1})}catch($){s(Ot);const U=(St=(X=$==null?void 0:$.response)==null?void 0:X.data)==null?void 0:St.message;typeof U=="string"&&U.toLowerCase().includes("payment")&&Ie(U);return}try{const $=ft[w].cards.map((xe,Pe)=>W.put(`/board-lists/${_.id}/cards/${xe.id}`,{position:xe.position??Pe+1})),U=ft[oe].cards.filter(xe=>xe.id!==de.id).map(xe=>W.put(`/board-lists/${Ct.id}/cards/${xe.id}`,{position:xe.position??1}));await Promise.allSettled([...$,...U])}catch($){console.error("Background card position normalization failed",$)}await Je()},{admissionLists:Wt,visaLists:Bn,dependantVisaLists:Un,totalMatchedCards:gr}=o.useMemo(()=>{if(!n)return{admissionLists:[],visaLists:[],dependantVisaLists:[],totalMatchedCards:0};const a=new Date,g=new Date(a.getFullYear(),a.getMonth(),a.getDate()),b=(g.getDay()+6)%7,w=new Date(g);w.setDate(g.getDate()-b);const _=new Date(w);_.setDate(w.getDate()+6);const de=J&&!(we==="*"),re=de?we.split(/\s+/).filter(Boolean):[],oe=re.some(D=>["paid","done","unpaid","pending"].includes(D)),Mt=D=>{if(Ae==="all")return!0;const X=Fa(D.due_date);return X?Ae==="today"?X.toDateString()===g.toDateString():Ae==="this_week"?X>=w&&X<=_:Ae==="overdue"?X<g:!0:!1},Ct=D=>{const X=Array.isArray(D.country_label_ids)&&D.country_label_ids.length>0?D.country_label_ids:D.country_label_id!=null?[D.country_label_id]:[],St=Array.isArray(D.service_area_ids)&&D.service_area_ids.length>0?D.service_area_ids:D.service_area_id!=null?[D.service_area_id]:[];if(Te.length>0&&!X.some(Z=>Te.includes(Z))||Oe.length>0&&(D.intake_label_id==null||!Oe.includes(D.intake_label_id))||rt.length>0&&!St.some(Z=>rt.includes(Z))||!Mt(D))return!1;if(!de)return!0;const $=X.map(Z=>mt[Z]||"").filter(Boolean).join(" "),U=D.intake_label_id!=null&&xt[D.intake_label_id]||"",xe=St.map(Z=>te[Z]||"").filter(Boolean).join(" "),Pe=D.payment_done?"visa payment paid done":"visa payment unpaid pending",ot=D.dependant_payment_done?"dependant payment dependant-paid dependant-done":"dependant payment dependant-unpaid dependant-pending",Xt=[D.invoice,D.first_name,D.last_name,D.title,D.description,$,U,xe,Pe,ot].filter(Z=>!!Z).join(" ").toLowerCase();return re.every(Z=>Z==="paid"||Z==="done"?D.payment_done===!0:Z==="unpaid"||Z==="pending"?D.payment_done!==!0:Z==="dependant-paid"||Z==="dependent-paid"||Z==="dependant-done"?D.dependant_payment_done===!0:Z==="dependant-unpaid"||Z==="dependent-unpaid"||Z==="dependant-pending"?D.dependant_payment_done!==!0:Xt.includes(Z))},Ot=D=>D.map(X=>{const St=X.cards.length;if(!de&&!Q)return{...X,cards:[...X.cards],totalCards:St,matchedByTitle:!1};const $=de&&!Q&&!oe&&X.title.toLowerCase().includes(we),U=X.cards.filter(xe=>Ct(xe));return{...X,cards:U,totalCards:St,matchedByTitle:$}}).filter(X=>!de&&!Q?!0:Q?X.cards.length>0:X.matchedByTitle||X.cards.length>0),cn=n.lists.filter(D=>(D.category??0)===0).sort((D,X)=>D.position-X.position),dn=n.lists.filter(D=>D.category===1).sort((D,X)=>D.position-X.position),xr=n.lists.filter(D=>D.category===2).sort((D,X)=>D.position-X.position),Xn=Ot(cn),ft=Ot(dn),un=Ot(xr),Vt=[...Xn,...ft,...un];return{admissionLists:Xn,visaLists:ft,dependantVisaLists:un,totalMatchedCards:Vt.reduce((D,X)=>D+X.cards.length,0)}},[n,we,J,Q,Ae,Te,Oe,rt,mt,xt,te]),Wn=o.useMemo(()=>{if(!n||n.lists.length===0)return null;const a=[...n.lists].filter(g=>(g.category??0)===0).sort((g,p)=>g.position-p.position)[0];return(a==null?void 0:a.id)??null},[n]);if(i)return r.jsx(Ns,{message:"Loading board..."});if(!n)return null;const Vn=(a,g)=>{const p=J||Q,b=Et&&!p&&ge!==a.id;return r.jsx(Va,{list:a,dragDisabled:!Et||p,children:({dragHandleProps:w})=>r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"p-4 pb-2",children:[r.jsxs("div",{className:`flex justify-between items-center gap-2 mb-3 ${b?"cursor-grab active:cursor-grabbing select-none touch-none":""}`,...b?w:{},title:b?"Drag to reorder list":void 0,children:[ge===a.id?r.jsx("input",{autoFocus:!0,value:Ce,onChange:_=>Be(_.target.value),onBlur:()=>void y(a),onKeyDown:_=>{_.key==="Enter"&&(_.preventDefault(),y(a)),_.key==="Escape"&&(Be(a.title),ue(null))},disabled:He===a.id,className:"h-9 w-full rounded-md border border-indigo-300 bg-white px-3 text-base font-semibold text-gray-900 focus:outline-none focus:ring-2 focus:ring-indigo-400"}):r.jsx("h3",{className:`font-semibold text-lg truncate ${Tt?"cursor-text hover:underline underline-offset-4":""} ${J&&a.matchedByTitle?"text-indigo-700":""}`,onDoubleClick:()=>c(a),title:Tt?"Double-click to edit list title":void 0,children:a.title}),r.jsx("div",{className:"flex items-center gap-2 shrink-0",children:Re&&r.jsxs("span",{className:"px-2 py-0.5 rounded-full bg-indigo-50 text-indigo-700 text-xs font-semibold whitespace-nowrap",children:[a.cards.length," ",a.cards.length===1?"card":"cards"," match"]})})]}),r.jsx(xn,{items:a.cards.map(_=>_.id),strategy:Ra,children:r.jsx("div",{className:"max-h-[calc(100vh-320px)] overflow-y-auto pr-1",children:r.jsx("div",{className:"space-y-3",children:a.cards.map(_=>r.jsx(Wa,{card:_,onClick:()=>h(_),labelBadges:Ln(_),dragDisabled:J||Q},_.id))})})})]}),g?r.jsx("div",{className:"p-3 pt-0",children:T===a.id?r.jsxs("div",{className:"bg-white rounded-lg border p-3 shadow-sm",children:[r.jsx("input",{value:z,onChange:_=>A(_.target.value),placeholder:"Invoice",className:"w-full border rounded-md px-3 py-2 text-sm focus:ring-2 focus:ring-indigo-400 outline-none mb-3"}),r.jsxs("div",{className:"grid grid-cols-2 gap-2 mb-3",children:[r.jsx("input",{value:L,onChange:_=>B(_.target.value),placeholder:"First name",className:"w-full border rounded-md px-3 py-2 text-sm focus:ring-2 focus:ring-indigo-400 outline-none"}),r.jsx("input",{value:H,onChange:_=>F(_.target.value),placeholder:"Last name",className:"w-full border rounded-md px-3 py-2 text-sm focus:ring-2 focus:ring-indigo-400 outline-none"})]}),r.jsxs("div",{className:"flex gap-3 mt-4",children:[r.jsx("button",{onClick:()=>k(a.id),className:"flex-1 bg-indigo-600 text-white py-2 rounded-md text-sm font-medium",children:"Add card"}),r.jsx("button",{onClick:C,className:"flex-1 bg-gray-200 text-gray-800 py-2 rounded-md text-sm font-medium hover:bg-gray-300",children:"Cancel"})]})]}):r.jsxs("button",{onClick:()=>O(a.id),className:"w-full flex items-center gap-2 text-gray-600 hover:bg-gray-100 rounded-lg px-2 py-2 text-sm",children:[r.jsx(bn,{size:16})," Add a card"]})}):r.jsx("div",{className:"h-12"})]})},a.id)},mr=N!=null&&n.lists.find(a=>a.id===N)||null,us=a=>{const g=a.cards.slice(0,3);return r.jsx("div",{className:"w-80 rounded-xl border border-gray-200 bg-white/95 backdrop-blur-sm shadow-2xl rotate-[1.2deg]",children:r.jsxs("div",{className:"p-4 pb-2",children:[r.jsx("h3",{className:"font-semibold text-lg text-gray-900 truncate",children:a.title}),r.jsx("div",{className:"mt-3 space-y-3",children:g.length===0?r.jsx("div",{className:"h-14 rounded-lg border border-dashed border-gray-300 bg-gray-50"}):g.map(p=>{const b=`${p.invoice||`ID-${p.id}`} ${p.first_name||""} ${p.last_name||""}`.trim();return r.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white px-3 py-2",children:[r.jsx("p",{className:"text-sm font-semibold text-indigo-700 truncate",children:b}),r.jsx("p",{className:"text-xs text-gray-500 mt-1",children:Ft(p.created_at)})]},`overlay-card-${p.id}`)})})]})})},fs=a=>{const g=he.current;if(!g||!(g.scrollWidth>g.clientWidth))return;const b=g.scrollHeight>g.clientHeight;if(!a.shiftKey&&b)return;const w=a.deltaX!==0?a.deltaX:a.deltaY;w!==0&&(g.scrollLeft+=w,a.preventDefault())},hs=a=>!(!(a instanceof HTMLElement)||a.closest("button, a, input, textarea, select, label, [role='button'], [role='dialog'], [contenteditable='true']")),gs=a=>{if(a.button!==0||!hs(a.target))return;const g=he.current;g&&(ke.current={x:a.clientX,scrollLeft:g.scrollLeft},ee(!0))};return r.jsxs("div",{className:"h-screen flex flex-col bg-gray-50 overflow-hidden",children:[r.jsxs("header",{className:"h-14 bg-white border-b shadow-sm flex items-center justify-between px-4 gap-4",children:[r.jsx("div",{className:"flex items-center gap-4",children:r.jsx("button",{type:"button",onClick:()=>t("/"),className:"h-7 flex items-center cursor-pointer",title:"Go to home",children:r.jsx("img",{src:"/images/logo/connected_logo.png",alt:"Connected Logo",className:"h-7 w-auto object-contain"})})}),r.jsx("div",{className:"flex-1 max-w-2xl mx-6",children:r.jsxs("div",{className:"relative",children:[r.jsx(js,{size:15,className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 pointer-events-none"}),r.jsx("input",{ref:Y,value:Le,onChange:a=>ie(a.target.value),placeholder:"Search cards, invoice, student, list title (Ctrl+K)",className:"w-full h-9 pl-9 pr-9 rounded-lg bg-gray-100 border text-sm focus:ring-2 focus:ring-indigo-400/40 outline-none"}),Le&&r.jsx("button",{type:"button",onClick:()=>{var a;ie(""),(a=Y.current)==null||a.focus()},className:"absolute right-2.5 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600","aria-label":"Clear search",children:r.jsx(bt,{size:14})})]})}),r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsxs("div",{className:"relative",ref:ve,children:[r.jsxs("button",{type:"button",onClick:()=>me(a=>!a),className:`flex items-center gap-1.5 px-3 py-1.5 border rounded-lg text-sm font-medium transition ${Q?"bg-indigo-50 border-indigo-300 text-indigo-700":"bg-white border-gray-300 text-gray-700 hover:bg-gray-50"}`,children:[r.jsx(Ts,{size:15}),"Filter"]}),G&&r.jsxs("div",{className:"absolute right-0 mt-2 w-80 rounded-xl border border-gray-200 bg-white shadow-xl p-4 z-50 space-y-3",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("p",{className:"text-sm font-semibold text-gray-800",children:"Card Filters"}),r.jsx("button",{type:"button",onClick:()=>{ie(""),vt([]),At([]),qe([]),ze("all"),_e(null)},className:"text-xs text-indigo-600 hover:text-indigo-800 font-medium",children:"Reset"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Search"}),r.jsx("input",{ref:ne,value:Le,onChange:a=>ie(a.target.value),placeholder:"Type to filter cards, use * for all cards",className:"h-9 w-full rounded-md border border-gray-300 px-2.5 text-sm text-gray-800 focus:outline-none focus:ring-2 focus:ring-indigo-300"})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:["Country (",Te.length,")"]}),r.jsxs("div",{className:"relative",children:[r.jsxs("button",{type:"button",onClick:()=>_e(a=>a==="country"?null:"country"),className:"h-9 w-full rounded-md border border-gray-300 px-2.5 text-sm focus:outline-none focus:ring-2 focus:ring-indigo-300 bg-white text-gray-800 flex items-center justify-between",children:[r.jsx("span",{className:"truncate text-left",children:at(Te,Ge,"Select")}),r.jsx(yr,{size:15,className:`text-gray-500 transition-transform ${st==="country"?"rotate-180":""}`})]}),st==="country"&&r.jsx("div",{className:"absolute left-0 right-0 top-full mt-1 max-h-40 overflow-y-auto rounded-md border border-gray-300 bg-white shadow-lg z-50",children:Ge.length===0?r.jsx("div",{className:"px-2.5 py-2 text-xs text-gray-500",children:"No options"}):Ge.map(a=>r.jsxs("label",{className:"flex items-center gap-2 px-2.5 py-1.5 text-sm text-gray-800 hover:bg-gray-50 cursor-pointer",children:[r.jsx("input",{type:"checkbox",checked:Te.includes(a.id),onChange:()=>Ee(a.id,vt),className:"h-3.5 w-3.5 rounded text-indigo-600"}),r.jsx("span",{children:a.name})]},`country-filter-${a.id}`))})]})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:["Intake (",Oe.length,")"]}),r.jsxs("div",{className:"relative",children:[r.jsxs("button",{type:"button",onClick:()=>_e(a=>a==="intake"?null:"intake"),className:"h-9 w-full rounded-md border border-gray-300 px-2.5 text-sm focus:outline-none focus:ring-2 focus:ring-indigo-300 bg-white text-gray-800 flex items-center justify-between",children:[r.jsx("span",{className:"truncate text-left",children:at(Oe,gt,"Select")}),r.jsx(yr,{size:15,className:`text-gray-500 transition-transform ${st==="intake"?"rotate-180":""}`})]}),st==="intake"&&r.jsx("div",{className:"absolute left-0 right-0 top-full mt-1 max-h-40 overflow-y-auto rounded-md border border-gray-300 bg-white shadow-lg z-50",children:gt.length===0?r.jsx("div",{className:"px-2.5 py-2 text-xs text-gray-500",children:"No options"}):gt.map(a=>r.jsxs("label",{className:"flex items-center gap-2 px-2.5 py-1.5 text-sm text-gray-800 hover:bg-gray-50 cursor-pointer",children:[r.jsx("input",{type:"checkbox",checked:Oe.includes(a.id),onChange:()=>Ee(a.id,At),className:"h-3.5 w-3.5 rounded text-indigo-600"}),r.jsx("span",{children:a.name})]},`intake-filter-${a.id}`))})]})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:["Service (",rt.length,")"]}),r.jsx("div",{className:"max-h-28 overflow-y-auto rounded-md border border-gray-300 bg-white",children:_t.length===0?r.jsx("div",{className:"px-2.5 py-2 text-xs text-gray-500",children:"No options"}):_t.map(a=>r.jsxs("label",{className:"flex items-center gap-2 px-2.5 py-1.5 text-sm text-gray-800 hover:bg-gray-50 cursor-pointer",children:[r.jsx("input",{type:"checkbox",checked:rt.includes(a.id),onChange:()=>Ee(a.id,qe),className:"h-3.5 w-3.5 rounded text-indigo-600"}),r.jsx("span",{children:a.name})]},`service-filter-${a.id}`))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Due Date"}),r.jsxs("select",{value:Ae,onChange:a=>ze(a.target.value),className:"h-9 w-full rounded-md border border-gray-300 px-2.5 text-sm text-gray-800 focus:outline-none focus:ring-2 focus:ring-indigo-300",children:[r.jsx("option",{value:"all",children:"Select"}),r.jsx("option",{value:"this_week",children:"This Week"}),r.jsx("option",{value:"today",children:"Today"}),r.jsx("option",{value:"overdue",children:"Overdue"})]})]}),Re&&r.jsxs("div",{className:"pt-1 text-xs font-medium text-gray-600",children:[gr," ",gr===1?"card":"cards"," match current filters"]})]})]}),r.jsxs("button",{type:"button",onClick:En,className:`flex items-center gap-1.5 px-3 py-1.5 border rounded-lg text-sm font-medium transition ${ae?"bg-indigo-50 border-indigo-300 text-indigo-700":"bg-white border-gray-300 text-gray-700 hover:bg-gray-50"}`,children:[r.jsx(br,{size:15}),"Activity"]}),r.jsxs("button",{type:"button",onClick:()=>void rn(),className:"flex items-center gap-1.5 px-3 py-1.5 border border-gray-300 bg-white rounded-lg text-sm font-medium text-gray-700 hover:bg-gray-50 transition",children:[r.jsx(Or,{size:15}),"Archived"]}),r.jsxs("button",{onClick:()=>j(!0),className:"flex items-center gap-1.5 px-4 py-1.5 bg-gradient-to-r from-indigo-600 to-blue-600 text-white text-sm rounded-lg shadow-md",children:[r.jsx(bn,{size:16})," New List"]}),r.jsx("button",{type:"button",onClick:()=>t("/profile"),className:"h-8 px-3 rounded-full bg-gradient-to-r from-blue-600 to-indigo-600 text-white text-sm font-semibold flex items-center justify-center shadow-sm hover:opacity-95",title:"Edit profile",children:(d==null?void 0:d.first_name)||"User"})]})]}),r.jsxs("main",{className:"flex-1 flex flex-col overflow-hidden bg-gradient-to-br from-indigo-50 via-purple-50 to-pink-50 rounded-xl shadow-inner m-4",children:[r.jsx("div",{className:"h-16 bg-gradient-to-r from-purple-700 via-indigo-700 to-purple-800 text-white flex items-center justify-between px-6 rounded-t-xl",children:r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsx(Cs,{size:20}),r.jsx("h1",{className:"text-xl font-bold",children:n.name})]})}),r.jsxs(aa,{sensors:Nt,collisionDetection:Qe,onDragStart:ut,onDragEnd:ln,children:[r.jsx("div",{ref:he,onWheel:fs,onMouseDown:gs,className:"flex-1 min-h-0 overflow-x-auto overflow-y-auto",children:r.jsxs("div",{className:"min-h-full p-6 flex gap-6 min-w-max",children:[r.jsxs("div",{className:"min-h-0 flex gap-6",children:[r.jsxs("div",{className:"min-w-[420px] flex flex-col gap-3",children:[r.jsx("div",{className:"inline-flex items-center gap-2 px-3 py-1 rounded-full bg-emerald-100 text-emerald-800 text-xs font-semibold uppercase tracking-wide",children:"Admission"}),r.jsx("div",{className:"flex-1",children:r.jsx(xn,{items:Wt.map(a=>`list-${a.id}`),strategy:Gn,children:r.jsx("div",{className:"flex gap-6 min-w-max items-start pb-2 pr-2",children:Wt.length>0?Wt.map(a=>Vn(a,a.id===Wn)):r.jsx("div",{className:"w-80 h-28 rounded-xl border border-dashed border-emerald-300 bg-emerald-50/50 text-emerald-800 text-sm flex items-center justify-center",children:J||Q?"No matching cards in admission":"No admission lists"})})})})]}),r.jsx("div",{className:"self-stretch border-l-2 border-dotted border-indigo-300/70"}),r.jsxs("div",{className:"min-w-[420px] flex flex-col gap-3",children:[r.jsx("div",{className:"inline-flex items-center gap-2 px-3 py-1 rounded-full bg-amber-100 text-amber-800 text-xs font-semibold uppercase tracking-wide",children:"Visa"}),r.jsx("div",{className:"flex-1",children:r.jsx(xn,{items:Bn.map(a=>`list-${a.id}`),strategy:Gn,children:r.jsx("div",{className:"flex gap-6 min-w-max items-start pb-2 pr-2",children:Bn.length>0?Bn.map(a=>Vn(a,a.id===Wn)):r.jsx("div",{className:"w-80 h-28 rounded-xl border border-dashed border-amber-300 bg-amber-50/50 text-amber-800 text-sm flex items-center justify-center",children:J||Q?"No matching cards in visa":"No visa lists"})})})})]}),r.jsx("div",{className:"self-stretch border-l-2 border-dotted border-indigo-300/70"}),r.jsxs("div",{className:"min-w-[420px] flex flex-col gap-3",children:[r.jsx("div",{className:"inline-flex items-center gap-2 px-3 py-1 rounded-full bg-rose-100 text-rose-800 text-xs font-semibold uppercase tracking-wide",children:"Dependant Visa"}),r.jsx("div",{className:"flex-1",children:r.jsx(xn,{items:Un.map(a=>`list-${a.id}`),strategy:Gn,children:r.jsx("div",{className:"flex gap-6 min-w-max items-start pb-2 pr-2",children:Un.length>0?Un.map(a=>Vn(a,a.id===Wn)):r.jsx("div",{className:"w-80 h-28 rounded-xl border border-dashed border-rose-300 bg-rose-50/50 text-rose-800 text-sm flex items-center justify-center",children:J||Q?"No matching cards in dependant visa":"No dependant visa lists"})})})})]})]}),R&&r.jsx("div",{className:"w-80 shrink-0 self-start",children:r.jsxs("div",{className:"bg-white rounded-xl p-4 border shadow-md",children:[r.jsxs("div",{className:"grid grid-cols-3 gap-2 mb-3",children:[r.jsx("button",{type:"button",onClick:()=>E(0),className:`h-9 rounded-md text-sm font-semibold border transition ${M===0?"bg-emerald-600 text-white border-emerald-600":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:"Admission"}),r.jsx("button",{type:"button",onClick:()=>E(1),className:`h-9 rounded-md text-sm font-semibold border transition ${M===1?"bg-amber-600 text-white border-amber-600":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:"Visa"}),r.jsx("button",{type:"button",onClick:()=>E(2),className:`h-9 rounded-md text-sm font-semibold border transition ${M===2?"bg-rose-600 text-white border-rose-600":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:"Dependant"})]}),r.jsx("input",{autoFocus:!0,value:S,onChange:a=>I(a.target.value),placeholder:"Enter list title...",className:"w-full border rounded-md px-3 py-2 text-sm"}),r.jsxs("div",{className:"flex gap-3 mt-3",children:[r.jsx("button",{onClick:Pn,className:"bg-indigo-600 text-white px-4 py-1.5 rounded-md",children:"Add list"}),r.jsx("button",{onClick:()=>{j(!1),I(""),E(0)},className:"text-sm text-gray-600 hover:underline",children:"Cancel"})]})]})})]})}),r.jsx(Sa,{children:m?r.jsxs("div",{className:"w-80 bg-white rounded-xl p-3 shadow-2xl border border-gray-200",children:[r.jsxs("p",{className:"text-sm font-bold text-indigo-700",children:[m.invoice||`ID-${m.id}`," ",m.first_name||""," ",m.last_name||""]}),r.jsx("p",{className:"text-xs text-gray-500 mt-1",children:Ft(m.created_at)})]}):mr?us(mr):null})]}),f&&r.jsx(Ua,{card:f,listTitle:Mn(f),profile:d,onClose:()=>h(null),setSelectedCard:h,fetchBoard:Je}),Ye&&r.jsx("div",{className:"fixed inset-0 z-[70] bg-black/50 flex items-center justify-center p-4",children:r.jsxs("div",{className:"w-full max-w-3xl bg-white rounded-2xl shadow-2xl border border-gray-200 overflow-hidden",children:[r.jsxs("div",{className:"flex items-center justify-between px-5 py-4 border-b bg-gray-50",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Archived Cards"}),r.jsx("button",{onClick:()=>$e(!1),className:"h-8 w-8 rounded-lg border border-gray-200 bg-white text-gray-600 hover:bg-gray-100 flex items-center justify-center",children:r.jsx(bt,{size:16})})]}),r.jsx("div",{className:"max-h-[60vh] overflow-y-auto p-4",children:dt?r.jsx("div",{className:"py-10 text-center text-sm text-gray-500",children:"Loading archived cards..."}):De.length===0?r.jsx("div",{className:"py-10 text-center text-sm text-gray-500",children:"No archived cards found."}):r.jsx("div",{className:"space-y-3",children:De.map(a=>{var b,w;const g=((b=a.boardList)==null?void 0:b.title)||((w=a.board_list)==null?void 0:w.title)||"Unknown List",p=`${a.invoice||`ID-${a.id}`} ${a.first_name||""} ${a.last_name||""}`.trim();return r.jsxs("div",{className:"flex items-center justify-between gap-4 rounded-xl border border-gray-200 bg-white p-4",children:[r.jsxs("div",{className:"min-w-0",children:[r.jsx("p",{className:"text-sm font-semibold text-gray-900 truncate",children:p}),r.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[g,"  Archived on ",Ft(a.updated_at)]})]}),r.jsxs("button",{type:"button",onClick:()=>void sn(a.id),disabled:le===a.id,className:`inline-flex items-center gap-1.5 px-3 py-1.5 rounded-lg text-sm font-medium border transition ${le===a.id?"bg-gray-100 text-gray-400 border-gray-200 cursor-not-allowed":"bg-emerald-50 text-emerald-700 border-emerald-200 hover:bg-emerald-100"}`,children:[r.jsx(Us,{size:14}),le===a.id?"Restoring...":"Restore"]})]},a.id)})})}),r.jsx("div",{className:"px-5 py-4 border-t bg-gray-50 flex justify-end",children:r.jsx("button",{onClick:()=>$e(!1),className:"px-4 py-2 rounded-lg bg-indigo-600 text-white text-sm font-medium hover:bg-indigo-700",children:"Close"})})]})}),ae&&r.jsx("div",{className:"fixed inset-0 z-[72] bg-black/50 flex items-center justify-center p-4",children:r.jsxs("div",{className:"w-full max-w-5xl bg-white rounded-2xl shadow-2xl border border-gray-200 overflow-hidden",children:[r.jsxs("div",{className:"flex items-center justify-between px-5 py-4 border-b bg-gray-50",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(br,{size:18,className:"text-indigo-600"}),r.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Board Activity"})]}),r.jsx("button",{type:"button",onClick:()=>Ue(!1),className:"h-8 w-8 rounded-lg border border-gray-200 bg-white text-gray-600 hover:bg-gray-100 flex items-center justify-center",children:r.jsx(bt,{size:16})})]}),r.jsx("div",{className:"px-5 pt-4 pb-3 border-b bg-white",children:r.jsxs("div",{className:"inline-flex rounded-lg border border-gray-200 bg-gray-50 p-1",children:[r.jsx("button",{type:"button",onClick:()=>Se("all"),className:`px-3 py-1.5 rounded-md text-sm font-medium transition ${be==="all"?"bg-white text-gray-900 shadow-sm border border-gray-200":"text-gray-600 hover:text-gray-800"}`,children:"All"}),r.jsx("button",{type:"button",onClick:()=>Se("comment"),className:`px-3 py-1.5 rounded-md text-sm font-medium transition ${be==="comment"?"bg-white text-gray-900 shadow-sm border border-gray-200":"text-gray-600 hover:text-gray-800"}`,children:"Comment"})]})}),r.jsx("div",{className:"max-h-[65vh] overflow-y-auto px-5 py-4",children:fe?r.jsx("div",{className:"py-12 text-center text-sm text-gray-500",children:"Loading activity..."}):P.length===0?r.jsxs("div",{className:"py-12 text-center text-sm text-gray-500",children:["No ",be==="comment"?"comments":"activities"," found."]}):r.jsx("div",{className:"space-y-3",children:P.map(a=>r.jsx("div",{className:"rounded-xl border border-gray-200 bg-white p-4",children:r.jsxs("div",{className:"flex gap-3",children:[r.jsx("div",{className:"h-8 w-8 rounded-full bg-indigo-100 text-indigo-700 text-xs font-semibold flex items-center justify-center shrink-0",children:(a.user_name||"U").charAt(0).toUpperCase()}),r.jsxs("div",{className:"min-w-0 flex-1",children:[r.jsxs("div",{className:"text-sm text-gray-800",children:[r.jsx("strong",{className:"text-gray-900",children:a.user_name||"User"})," ",a.action]}),a.details?r.jsx("div",{className:`mt-1 text-sm leading-relaxed ${a.action==="commented"?"rounded-lg border border-gray-200 bg-gray-50 p-3 text-gray-700":"text-gray-700"}`,children:a.action==="commented"?r.jsxs("div",{className:"flex items-start gap-2",children:[r.jsx(zr,{size:14,className:"mt-0.5 text-gray-500 shrink-0"}),r.jsx("div",{className:"min-w-0",children:an(a.details)})]}):an(a.details)}):null,r.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-2 text-xs text-gray-500",children:[r.jsx("span",{children:nr(a.created_at)}),a.card_id?r.jsx("span",{className:"px-2 py-0.5 rounded-full bg-indigo-50 text-indigo-700 border border-indigo-100",children:In(a)}):null,r.jsx("span",{className:"px-2 py-0.5 rounded-full bg-gray-100 text-gray-700 border border-gray-200",children:$n(a)})]}),(a.attachment_path||a.attachment_url)&&r.jsxs("button",{type:"button",onClick:()=>void Fn(a),disabled:ye===a.id,className:`mt-2 inline-flex items-center gap-1 rounded-md border px-2 py-1 text-xs transition ${ye===a.id?"bg-gray-100 text-gray-400 border-gray-200 cursor-not-allowed":"bg-white text-indigo-700 border-indigo-200 hover:bg-indigo-50"}`,children:[ye===a.id?"Opening...":a.attachment_name||"Attachment",a.attachment_size?r.jsxs("span",{className:"text-gray-500",children:["(",rr(a.attachment_size),")"]}):null]})]})]})},a.id))})})]})}),et&&r.jsx("div",{className:"fixed inset-0 z-[70] bg-black/50 flex items-center justify-center p-4",children:r.jsxs("div",{className:"w-full max-w-md bg-white rounded-2xl shadow-2xl border border-gray-200 overflow-hidden",children:[r.jsxs("div",{className:"flex items-center justify-between px-5 py-4 border-b bg-rose-50",children:[r.jsx("h3",{className:"text-lg font-semibold text-rose-800",children:"Move Blocked"}),r.jsx("button",{onClick:()=>Ie(null),className:"h-8 w-8 rounded-lg border border-rose-200 bg-white text-rose-600 hover:bg-rose-100 flex items-center justify-center",children:r.jsx(bt,{size:16})})]}),r.jsx("div",{className:"px-5 py-4 text-sm text-gray-700",children:et}),r.jsx("div",{className:"px-5 py-4 border-t bg-gray-50 flex justify-end",children:r.jsx("button",{onClick:()=>Ie(null),className:"px-4 py-2 rounded-lg bg-indigo-600 text-white text-sm font-medium hover:bg-indigo-700",children:"OK"})})]})})]})]})}export{eo as default};
