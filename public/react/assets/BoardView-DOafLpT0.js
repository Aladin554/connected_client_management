const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index.es-yC5EJTii.js","assets/index-BVvtZPCr.js","assets/index-BS_C_56V.css","assets/index-7dDA0PYD.js"])))=>i.map(i=>d[i]);
import{r as o,R as G,d as W,j as r,_ as js,m as Cs,u as Ss,i as ks}from"./index-BVvtZPCr.js";import{r as Ht}from"./index-7dDA0PYD.js";import{L as Ds}from"./Loader-CnwL02bI.js";import{c as tt}from"./createLucideIcon-BB7Ogyrb.js";import{X as vt}from"./x-iYmOtNkZ.js";import{P as pn}from"./plus-DhqkdCa5.js";import{S as Or}from"./square-pen-tOlVj4sF.js";import{S as As}from"./search-DwhjARKh.js";import{C as Hn}from"./chevron-down-CekSx0RJ.js";import{L as _s}from"./layout-grid-BkJ86Ldm.js";/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rs=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],vr=tt("activity",Rs);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Es=[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]],zr=tt("archive",Es);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ms=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]],Ls=tt("calendar-days",Ms);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Is=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],$s=tt("chart-column",Is);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ts=[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]],wr=tt("credit-card",Ts);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Os=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]],zs=tt("ellipsis",Os);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ps=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],Fs=tt("funnel",Ps);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bs=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],Us=tt("globe",Bs);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ws=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]],Pr=tt("message-square",Ws);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vs=[["path",{d:"m16 6-8.414 8.586a2 2 0 0 0 2.829 2.829l8.414-8.586a4 4 0 1 0-5.657-5.657l-8.379 8.551a6 6 0 1 0 8.485 8.485l8.379-8.551",key:"1miecu"}]],Nr=tt("paperclip",Vs);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xs=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],Ks=tt("rotate-ccw",Xs);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hs=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],Fr=tt("tag",Hs);function Ys(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return o.useMemo(()=>s=>{t.forEach(a=>a(s))},t)}const Cn=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function Ft(e){const t=Object.prototype.toString.call(e);return t==="[object Window]"||t==="[object global]"}function ar(e){return"nodeType"in e}function Ee(e){var t,n;return e?Ft(e)?e:ar(e)&&(t=(n=e.ownerDocument)==null?void 0:n.defaultView)!=null?t:window:window}function or(e){const{Document:t}=Ee(e);return e instanceof t}function Zt(e){return Ft(e)?!1:e instanceof Ee(e).HTMLElement}function Br(e){return e instanceof Ee(e).SVGElement}function Bt(e){return e?Ft(e)?e.document:ar(e)?or(e)?e:Zt(e)||Br(e)?e.ownerDocument:document:document:document}const ot=Cn?o.useLayoutEffect:o.useEffect;function Sn(e){const t=o.useRef(e);return ot(()=>{t.current=e}),o.useCallback(function(){for(var n=arguments.length,s=new Array(n),a=0;a<n;a++)s[a]=arguments[a];return t.current==null?void 0:t.current(...s)},[])}function qs(){const e=o.useRef(null),t=o.useCallback((s,a)=>{e.current=setInterval(s,a)},[]),n=o.useCallback(()=>{e.current!==null&&(clearInterval(e.current),e.current=null)},[]);return[t,n]}function Jt(e,t){t===void 0&&(t=[e]);const n=o.useRef(e);return ot(()=>{n.current!==e&&(n.current=e)},t),n}function en(e,t){const n=o.useRef();return o.useMemo(()=>{const s=e(n.current);return n.current=s,s},[...t])}function bn(e){const t=Sn(e),n=o.useRef(null),s=o.useCallback(a=>{a!==n.current&&(t==null||t(a,n.current)),n.current=a},[]);return[n,s]}function yn(e){const t=o.useRef();return o.useEffect(()=>{t.current=e},[e]),t.current}let Yn={};function tn(e,t){return o.useMemo(()=>{if(t)return t;const n=Yn[e]==null?0:Yn[e]+1;return Yn[e]=n,e+"-"+n},[e,t])}function Ur(e){return function(t){for(var n=arguments.length,s=new Array(n>1?n-1:0),a=1;a<n;a++)s[a-1]=arguments[a];return s.reduce((l,d)=>{const u=Object.entries(d);for(const[f,h]of u){const m=l[f];m!=null&&(l[f]=m+e*h)}return l},{...t})}}const zt=Ur(1),vn=Ur(-1);function Gs(e){return"clientX"in e&&"clientY"in e}function kn(e){if(!e)return!1;const{KeyboardEvent:t}=Ee(e.target);return t&&e instanceof t}function Js(e){if(!e)return!1;const{TouchEvent:t}=Ee(e.target);return t&&e instanceof t}function wn(e){if(Js(e)){if(e.touches&&e.touches.length){const{clientX:t,clientY:n}=e.touches[0];return{x:t,y:n}}else if(e.changedTouches&&e.changedTouches.length){const{clientX:t,clientY:n}=e.changedTouches[0];return{x:t,y:n}}}return Gs(e)?{x:e.clientX,y:e.clientY}:null}const wt=Object.freeze({Translate:{toString(e){if(!e)return;const{x:t,y:n}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(n?Math.round(n):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;const{scaleX:t,scaleY:n}=e;return"scaleX("+t+") scaleY("+n+")"}},Transform:{toString(e){if(e)return[wt.Translate.toString(e),wt.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:n,easing:s}=e;return t+" "+n+"ms "+s}}}),jr="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function Qs(e){return e.matches(jr)?e:e.querySelector(jr)}const Zs={display:"none"};function ei(e){let{id:t,value:n}=e;return G.createElement("div",{id:t,style:Zs},n)}function ti(e){let{id:t,announcement:n,ariaLiveType:s="assertive"}=e;const a={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return G.createElement("div",{id:t,style:a,role:"status","aria-live":s,"aria-atomic":!0},n)}function ni(){const[e,t]=o.useState("");return{announce:o.useCallback(s=>{s!=null&&t(s)},[]),announcement:e}}const Wr=o.createContext(null);function ri(e){const t=o.useContext(Wr);o.useEffect(()=>{if(!t)throw new Error("useDndMonitor must be used within a children of <DndContext>");return t(e)},[e,t])}function si(){const[e]=o.useState(()=>new Set),t=o.useCallback(s=>(e.add(s),()=>e.delete(s)),[e]);return[o.useCallback(s=>{let{type:a,event:l}=s;e.forEach(d=>{var u;return(u=d[a])==null?void 0:u.call(d,l)})},[e]),t]}const ii={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},ai={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was moved over droppable area "+n.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was dropped over droppable area "+n.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function oi(e){let{announcements:t=ai,container:n,hiddenTextDescribedById:s,screenReaderInstructions:a=ii}=e;const{announce:l,announcement:d}=ni(),u=tn("DndLiveRegion"),[f,h]=o.useState(!1);if(o.useEffect(()=>{h(!0)},[]),ri(o.useMemo(()=>({onDragStart(x){let{active:N}=x;l(t.onDragStart({active:N}))},onDragMove(x){let{active:N,over:v}=x;t.onDragMove&&l(t.onDragMove({active:N,over:v}))},onDragOver(x){let{active:N,over:v}=x;l(t.onDragOver({active:N,over:v}))},onDragEnd(x){let{active:N,over:v}=x;l(t.onDragEnd({active:N,over:v}))},onDragCancel(x){let{active:N,over:v}=x;l(t.onDragCancel({active:N,over:v}))}}),[l,t])),!f)return null;const m=G.createElement(G.Fragment,null,G.createElement(ei,{id:s,value:a.draggable}),G.createElement(ti,{id:u,announcement:d}));return n?Ht.createPortal(m,n):m}var ve;(function(e){e.DragStart="dragStart",e.DragMove="dragMove",e.DragEnd="dragEnd",e.DragCancel="dragCancel",e.DragOver="dragOver",e.RegisterDroppable="registerDroppable",e.SetDroppableDisabled="setDroppableDisabled",e.UnregisterDroppable="unregisterDroppable"})(ve||(ve={}));function Nn(){}function li(e,t){return o.useMemo(()=>({sensor:e,options:t??{}}),[e,t])}function ci(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return o.useMemo(()=>[...t].filter(s=>s!=null),[...t])}const lt=Object.freeze({x:0,y:0});function lr(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function di(e,t){const n=wn(e);if(!n)return"0 0";const s={x:(n.x-t.left)/t.width*100,y:(n.y-t.top)/t.height*100};return s.x+"% "+s.y+"%"}function cr(e,t){let{data:{value:n}}=e,{data:{value:s}}=t;return n-s}function ui(e,t){let{data:{value:n}}=e,{data:{value:s}}=t;return s-n}function er(e){let{left:t,top:n,height:s,width:a}=e;return[{x:t,y:n},{x:t+a,y:n},{x:t,y:n+s},{x:t+a,y:n+s}]}function fi(e,t){if(!e||e.length===0)return null;const[n]=e;return n[t]}function Cr(e,t,n){return t===void 0&&(t=e.left),n===void 0&&(n=e.top),{x:t+e.width*.5,y:n+e.height*.5}}const hi=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:s}=e;const a=Cr(t,t.left,t.top),l=[];for(const d of s){const{id:u}=d,f=n.get(u);if(f){const h=lr(Cr(f),a);l.push({id:u,data:{droppableContainer:d,value:h}})}}return l.sort(cr)},gi=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:s}=e;const a=er(t),l=[];for(const d of s){const{id:u}=d,f=n.get(u);if(f){const h=er(f),m=a.reduce((N,v,R)=>N+lr(h[R],v),0),x=Number((m/4).toFixed(4));l.push({id:u,data:{droppableContainer:d,value:x}})}}return l.sort(cr)};function mi(e,t){const n=Math.max(t.top,e.top),s=Math.max(t.left,e.left),a=Math.min(t.left+t.width,e.left+e.width),l=Math.min(t.top+t.height,e.top+e.height),d=a-s,u=l-n;if(s<a&&n<l){const f=t.width*t.height,h=e.width*e.height,m=d*u,x=m/(f+h-m);return Number(x.toFixed(4))}return 0}const xi=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:s}=e;const a=[];for(const l of s){const{id:d}=l,u=n.get(d);if(u){const f=mi(u,t);f>0&&a.push({id:d,data:{droppableContainer:l,value:f}})}}return a.sort(ui)};function pi(e,t){const{top:n,left:s,bottom:a,right:l}=t;return n<=e.y&&e.y<=a&&s<=e.x&&e.x<=l}const bi=e=>{let{droppableContainers:t,droppableRects:n,pointerCoordinates:s}=e;if(!s)return[];const a=[];for(const l of t){const{id:d}=l,u=n.get(d);if(u&&pi(s,u)){const h=er(u).reduce((x,N)=>x+lr(s,N),0),m=Number((h/4).toFixed(4));a.push({id:d,data:{droppableContainer:l,value:m}})}}return a.sort(cr)};function yi(e,t,n){return{...e,scaleX:t&&n?t.width/n.width:1,scaleY:t&&n?t.height/n.height:1}}function Vr(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:lt}function vi(e){return function(n){for(var s=arguments.length,a=new Array(s>1?s-1:0),l=1;l<s;l++)a[l-1]=arguments[l];return a.reduce((d,u)=>({...d,top:d.top+e*u.y,bottom:d.bottom+e*u.y,left:d.left+e*u.x,right:d.right+e*u.x}),{...n})}}const wi=vi(1);function Xr(e){if(e.startsWith("matrix3d(")){const t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}else if(e.startsWith("matrix(")){const t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}function Ni(e,t,n){const s=Xr(t);if(!s)return e;const{scaleX:a,scaleY:l,x:d,y:u}=s,f=e.left-d-(1-a)*parseFloat(n),h=e.top-u-(1-l)*parseFloat(n.slice(n.indexOf(" ")+1)),m=a?e.width/a:e.width,x=l?e.height/l:e.height;return{width:m,height:x,top:h,right:f+m,bottom:h+x,left:f}}const ji={ignoreTransform:!1};function Ut(e,t){t===void 0&&(t=ji);let n=e.getBoundingClientRect();if(t.ignoreTransform){const{transform:h,transformOrigin:m}=Ee(e).getComputedStyle(e);h&&(n=Ni(n,h,m))}const{top:s,left:a,width:l,height:d,bottom:u,right:f}=n;return{top:s,left:a,width:l,height:d,bottom:u,right:f}}function Sr(e){return Ut(e,{ignoreTransform:!0})}function Ci(e){const t=e.innerWidth,n=e.innerHeight;return{top:0,left:0,right:t,bottom:n,width:t,height:n}}function Si(e,t){return t===void 0&&(t=Ee(e).getComputedStyle(e)),t.position==="fixed"}function ki(e,t){t===void 0&&(t=Ee(e).getComputedStyle(e));const n=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(a=>{const l=t[a];return typeof l=="string"?n.test(l):!1})}function dr(e,t){const n=[];function s(a){if(t!=null&&n.length>=t||!a)return n;if(or(a)&&a.scrollingElement!=null&&!n.includes(a.scrollingElement))return n.push(a.scrollingElement),n;if(!Zt(a)||Br(a)||n.includes(a))return n;const l=Ee(e).getComputedStyle(a);return a!==e&&ki(a,l)&&n.push(a),Si(a,l)?n:s(a.parentNode)}return e?s(e):n}function Kr(e){const[t]=dr(e,1);return t??null}function qn(e){return!Cn||!e?null:Ft(e)?e:ar(e)?or(e)||e===Bt(e).scrollingElement?window:Zt(e)?e:null:null}function Hr(e){return Ft(e)?e.scrollX:e.scrollLeft}function Yr(e){return Ft(e)?e.scrollY:e.scrollTop}function tr(e){return{x:Hr(e),y:Yr(e)}}var Ne;(function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"})(Ne||(Ne={}));function qr(e){return!Cn||!e?!1:e===document.scrollingElement}function Gr(e){const t={x:0,y:0},n=qr(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},s={x:e.scrollWidth-n.width,y:e.scrollHeight-n.height},a=e.scrollTop<=t.y,l=e.scrollLeft<=t.x,d=e.scrollTop>=s.y,u=e.scrollLeft>=s.x;return{isTop:a,isLeft:l,isBottom:d,isRight:u,maxScroll:s,minScroll:t}}const Di={x:.2,y:.2};function Ai(e,t,n,s,a){let{top:l,left:d,right:u,bottom:f}=n;s===void 0&&(s=10),a===void 0&&(a=Di);const{isTop:h,isBottom:m,isLeft:x,isRight:N}=Gr(e),v={x:0,y:0},R={x:0,y:0},j={height:t.height*a.y,width:t.width*a.x};return!h&&l<=t.top+j.height?(v.y=Ne.Backward,R.y=s*Math.abs((t.top+j.height-l)/j.height)):!m&&f>=t.bottom-j.height&&(v.y=Ne.Forward,R.y=s*Math.abs((t.bottom-j.height-f)/j.height)),!N&&u>=t.right-j.width?(v.x=Ne.Forward,R.x=s*Math.abs((t.right-j.width-u)/j.width)):!x&&d<=t.left+j.width&&(v.x=Ne.Backward,R.x=s*Math.abs((t.left+j.width-d)/j.width)),{direction:v,speed:R}}function _i(e){if(e===document.scrollingElement){const{innerWidth:l,innerHeight:d}=window;return{top:0,left:0,right:l,bottom:d,width:l,height:d}}const{top:t,left:n,right:s,bottom:a}=e.getBoundingClientRect();return{top:t,left:n,right:s,bottom:a,width:e.clientWidth,height:e.clientHeight}}function Jr(e){return e.reduce((t,n)=>zt(t,tr(n)),lt)}function Ri(e){return e.reduce((t,n)=>t+Hr(n),0)}function Ei(e){return e.reduce((t,n)=>t+Yr(n),0)}function Qr(e,t){if(t===void 0&&(t=Ut),!e)return;const{top:n,left:s,bottom:a,right:l}=t(e);Kr(e)&&(a<=0||l<=0||n>=window.innerHeight||s>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}const Mi=[["x",["left","right"],Ri],["y",["top","bottom"],Ei]];class ur{constructor(t,n){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const s=dr(n),a=Jr(s);this.rect={...t},this.width=t.width,this.height=t.height;for(const[l,d,u]of Mi)for(const f of d)Object.defineProperty(this,f,{get:()=>{const h=u(s),m=a[l]-h;return this.rect[f]+m},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class Yt{constructor(t){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(n=>{var s;return(s=this.target)==null?void 0:s.removeEventListener(...n)})},this.target=t}add(t,n,s){var a;(a=this.target)==null||a.addEventListener(t,n,s),this.listeners.push([t,n,s])}}function Li(e){const{EventTarget:t}=Ee(e);return e instanceof t?e:Bt(e)}function Gn(e,t){const n=Math.abs(e.x),s=Math.abs(e.y);return typeof t=="number"?Math.sqrt(n**2+s**2)>t:"x"in t&&"y"in t?n>t.x&&s>t.y:"x"in t?n>t.x:"y"in t?s>t.y:!1}var et;(function(e){e.Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange"})(et||(et={}));function kr(e){e.preventDefault()}function Ii(e){e.stopPropagation()}var V;(function(e){e.Space="Space",e.Down="ArrowDown",e.Right="ArrowRight",e.Left="ArrowLeft",e.Up="ArrowUp",e.Esc="Escape",e.Enter="Enter",e.Tab="Tab"})(V||(V={}));const Zr={start:[V.Space,V.Enter],cancel:[V.Esc],end:[V.Space,V.Enter,V.Tab]},$i=(e,t)=>{let{currentCoordinates:n}=t;switch(e.code){case V.Right:return{...n,x:n.x+25};case V.Left:return{...n,x:n.x-25};case V.Down:return{...n,y:n.y+25};case V.Up:return{...n,y:n.y-25}}};class es{constructor(t){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=t;const{event:{target:n}}=t;this.props=t,this.listeners=new Yt(Bt(n)),this.windowListeners=new Yt(Ee(n)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(et.Resize,this.handleCancel),this.windowListeners.add(et.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(et.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:t,onStart:n}=this.props,s=t.node.current;s&&Qr(s),n(lt)}handleKeyDown(t){if(kn(t)){const{active:n,context:s,options:a}=this.props,{keyboardCodes:l=Zr,coordinateGetter:d=$i,scrollBehavior:u="smooth"}=a,{code:f}=t;if(l.end.includes(f)){this.handleEnd(t);return}if(l.cancel.includes(f)){this.handleCancel(t);return}const{collisionRect:h}=s.current,m=h?{x:h.left,y:h.top}:lt;this.referenceCoordinates||(this.referenceCoordinates=m);const x=d(t,{active:n,context:s.current,currentCoordinates:m});if(x){const N=vn(x,m),v={x:0,y:0},{scrollableAncestors:R}=s.current;for(const j of R){const k=t.code,{isTop:I,isRight:M,isLeft:E,isBottom:O,maxScroll:z,minScroll:P}=Gr(j),A=_i(j),L={x:Math.min(k===V.Right?A.right-A.width/2:A.right,Math.max(k===V.Right?A.left:A.left+A.width/2,x.x)),y:Math.min(k===V.Down?A.bottom-A.height/2:A.bottom,Math.max(k===V.Down?A.top:A.top+A.height/2,x.y))},B=k===V.Right&&!M||k===V.Left&&!E,H=k===V.Down&&!O||k===V.Up&&!I;if(B&&L.x!==x.x){const F=j.scrollLeft+N.x,me=k===V.Right&&F<=z.x||k===V.Left&&F>=P.x;if(me&&!N.y){j.scrollTo({left:F,behavior:u});return}me?v.x=j.scrollLeft-F:v.x=k===V.Right?j.scrollLeft-z.x:j.scrollLeft-P.x,v.x&&j.scrollBy({left:-v.x,behavior:u});break}else if(H&&L.y!==x.y){const F=j.scrollTop+N.y,me=k===V.Down&&F<=z.y||k===V.Up&&F>=P.y;if(me&&!N.x){j.scrollTo({top:F,behavior:u});return}me?v.y=j.scrollTop-F:v.y=k===V.Down?j.scrollTop-z.y:j.scrollTop-P.y,v.y&&j.scrollBy({top:-v.y,behavior:u});break}}this.handleMove(t,zt(vn(x,this.referenceCoordinates),v))}}}handleMove(t,n){const{onMove:s}=this.props;t.preventDefault(),s(n)}handleEnd(t){const{onEnd:n}=this.props;t.preventDefault(),this.detach(),n()}handleCancel(t){const{onCancel:n}=this.props;t.preventDefault(),this.detach(),n()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}es.activators=[{eventName:"onKeyDown",handler:(e,t,n)=>{let{keyboardCodes:s=Zr,onActivation:a}=t,{active:l}=n;const{code:d}=e.nativeEvent;if(s.start.includes(d)){const u=l.activatorNode.current;return u&&e.target!==u?!1:(e.preventDefault(),a==null||a({event:e.nativeEvent}),!0)}return!1}}];function Dr(e){return!!(e&&"distance"in e)}function Ar(e){return!!(e&&"delay"in e)}class fr{constructor(t,n,s){var a;s===void 0&&(s=Li(t.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=t,this.events=n;const{event:l}=t,{target:d}=l;this.props=t,this.events=n,this.document=Bt(d),this.documentListeners=new Yt(this.document),this.listeners=new Yt(s),this.windowListeners=new Yt(Ee(d)),this.initialCoordinates=(a=wn(l))!=null?a:lt,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:t,props:{options:{activationConstraint:n,bypassActivationConstraint:s}}}=this;if(this.listeners.add(t.move.name,this.handleMove,{passive:!1}),this.listeners.add(t.end.name,this.handleEnd),t.cancel&&this.listeners.add(t.cancel.name,this.handleCancel),this.windowListeners.add(et.Resize,this.handleCancel),this.windowListeners.add(et.DragStart,kr),this.windowListeners.add(et.VisibilityChange,this.handleCancel),this.windowListeners.add(et.ContextMenu,kr),this.documentListeners.add(et.Keydown,this.handleKeydown),n){if(s!=null&&s({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(Ar(n)){this.timeoutId=setTimeout(this.handleStart,n.delay),this.handlePending(n);return}if(Dr(n)){this.handlePending(n);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(t,n){const{active:s,onPending:a}=this.props;a(s,t,this.initialCoordinates,n)}handleStart(){const{initialCoordinates:t}=this,{onStart:n}=this.props;t&&(this.activated=!0,this.documentListeners.add(et.Click,Ii,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(et.SelectionChange,this.removeTextSelection),n(t))}handleMove(t){var n;const{activated:s,initialCoordinates:a,props:l}=this,{onMove:d,options:{activationConstraint:u}}=l;if(!a)return;const f=(n=wn(t))!=null?n:lt,h=vn(a,f);if(!s&&u){if(Dr(u)){if(u.tolerance!=null&&Gn(h,u.tolerance))return this.handleCancel();if(Gn(h,u.distance))return this.handleStart()}if(Ar(u)&&Gn(h,u.tolerance))return this.handleCancel();this.handlePending(u,h);return}t.cancelable&&t.preventDefault(),d(f)}handleEnd(){const{onAbort:t,onEnd:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleCancel(){const{onAbort:t,onCancel:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleKeydown(t){t.code===V.Esc&&this.handleCancel()}removeTextSelection(){var t;(t=this.document.getSelection())==null||t.removeAllRanges()}}const Ti={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class hr extends fr{constructor(t){const{event:n}=t,s=Bt(n.target);super(t,Ti,s)}}hr.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:s}=t;return!n.isPrimary||n.button!==0?!1:(s==null||s({event:n}),!0)}}];const Oi={move:{name:"mousemove"},end:{name:"mouseup"}};var nr;(function(e){e[e.RightClick=2]="RightClick"})(nr||(nr={}));class zi extends fr{constructor(t){super(t,Oi,Bt(t.event.target))}}zi.activators=[{eventName:"onMouseDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:s}=t;return n.button===nr.RightClick?!1:(s==null||s({event:n}),!0)}}];const Jn={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class Pi extends fr{constructor(t){super(t,Jn)}static setup(){return window.addEventListener(Jn.move.name,t,{capture:!1,passive:!1}),function(){window.removeEventListener(Jn.move.name,t)};function t(){}}}Pi.activators=[{eventName:"onTouchStart",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:s}=t;const{touches:a}=n;return a.length>1?!1:(s==null||s({event:n}),!0)}}];var qt;(function(e){e[e.Pointer=0]="Pointer",e[e.DraggableRect=1]="DraggableRect"})(qt||(qt={}));var jn;(function(e){e[e.TreeOrder=0]="TreeOrder",e[e.ReversedTreeOrder=1]="ReversedTreeOrder"})(jn||(jn={}));function Fi(e){let{acceleration:t,activator:n=qt.Pointer,canScroll:s,draggingRect:a,enabled:l,interval:d=5,order:u=jn.TreeOrder,pointerCoordinates:f,scrollableAncestors:h,scrollableAncestorRects:m,delta:x,threshold:N}=e;const v=Ui({delta:x,disabled:!l}),[R,j]=qs(),k=o.useRef({x:0,y:0}),I=o.useRef({x:0,y:0}),M=o.useMemo(()=>{switch(n){case qt.Pointer:return f?{top:f.y,bottom:f.y,left:f.x,right:f.x}:null;case qt.DraggableRect:return a}},[n,a,f]),E=o.useRef(null),O=o.useCallback(()=>{const P=E.current;if(!P)return;const A=k.current.x*I.current.x,L=k.current.y*I.current.y;P.scrollBy(A,L)},[]),z=o.useMemo(()=>u===jn.TreeOrder?[...h].reverse():h,[u,h]);o.useEffect(()=>{if(!l||!h.length||!M){j();return}for(const P of z){if((s==null?void 0:s(P))===!1)continue;const A=h.indexOf(P),L=m[A];if(!L)continue;const{direction:B,speed:H}=Ai(P,L,M,t,N);for(const F of["x","y"])v[F][B[F]]||(H[F]=0,B[F]=0);if(H.x>0||H.y>0){j(),E.current=P,R(O,d),k.current=H,I.current=B;return}}k.current={x:0,y:0},I.current={x:0,y:0},j()},[t,O,s,j,l,d,JSON.stringify(M),JSON.stringify(v),R,h,z,m,JSON.stringify(N)])}const Bi={x:{[Ne.Backward]:!1,[Ne.Forward]:!1},y:{[Ne.Backward]:!1,[Ne.Forward]:!1}};function Ui(e){let{delta:t,disabled:n}=e;const s=yn(t);return en(a=>{if(n||!s||!a)return Bi;const l={x:Math.sign(t.x-s.x),y:Math.sign(t.y-s.y)};return{x:{[Ne.Backward]:a.x[Ne.Backward]||l.x===-1,[Ne.Forward]:a.x[Ne.Forward]||l.x===1},y:{[Ne.Backward]:a.y[Ne.Backward]||l.y===-1,[Ne.Forward]:a.y[Ne.Forward]||l.y===1}}},[n,t,s])}function Wi(e,t){const n=t!=null?e.get(t):void 0,s=n?n.node.current:null;return en(a=>{var l;return t==null?null:(l=s??a)!=null?l:null},[s,t])}function Vi(e,t){return o.useMemo(()=>e.reduce((n,s)=>{const{sensor:a}=s,l=a.activators.map(d=>({eventName:d.eventName,handler:t(d.handler,s)}));return[...n,...l]},[]),[e,t])}var Qt;(function(e){e[e.Always=0]="Always",e[e.BeforeDragging=1]="BeforeDragging",e[e.WhileDragging=2]="WhileDragging"})(Qt||(Qt={}));var rr;(function(e){e.Optimized="optimized"})(rr||(rr={}));const _r=new Map;function Xi(e,t){let{dragging:n,dependencies:s,config:a}=t;const[l,d]=o.useState(null),{frequency:u,measure:f,strategy:h}=a,m=o.useRef(e),x=k(),N=Jt(x),v=o.useCallback(function(I){I===void 0&&(I=[]),!N.current&&d(M=>M===null?I:M.concat(I.filter(E=>!M.includes(E))))},[N]),R=o.useRef(null),j=en(I=>{if(x&&!n)return _r;if(!I||I===_r||m.current!==e||l!=null){const M=new Map;for(let E of e){if(!E)continue;if(l&&l.length>0&&!l.includes(E.id)&&E.rect.current){M.set(E.id,E.rect.current);continue}const O=E.node.current,z=O?new ur(f(O),O):null;E.rect.current=z,z&&M.set(E.id,z)}return M}return I},[e,l,n,x,f]);return o.useEffect(()=>{m.current=e},[e]),o.useEffect(()=>{x||v()},[n,x]),o.useEffect(()=>{l&&l.length>0&&d(null)},[JSON.stringify(l)]),o.useEffect(()=>{x||typeof u!="number"||R.current!==null||(R.current=setTimeout(()=>{v(),R.current=null},u))},[u,x,v,...s]),{droppableRects:j,measureDroppableContainers:v,measuringScheduled:l!=null};function k(){switch(h){case Qt.Always:return!1;case Qt.BeforeDragging:return n;default:return!n}}}function gr(e,t){return en(n=>e?n||(typeof t=="function"?t(e):e):null,[t,e])}function Ki(e,t){return gr(e,t)}function Hi(e){let{callback:t,disabled:n}=e;const s=Sn(t),a=o.useMemo(()=>{if(n||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:l}=window;return new l(s)},[s,n]);return o.useEffect(()=>()=>a==null?void 0:a.disconnect(),[a]),a}function Dn(e){let{callback:t,disabled:n}=e;const s=Sn(t),a=o.useMemo(()=>{if(n||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:l}=window;return new l(s)},[n]);return o.useEffect(()=>()=>a==null?void 0:a.disconnect(),[a]),a}function Yi(e){return new ur(Ut(e),e)}function Rr(e,t,n){t===void 0&&(t=Yi);const[s,a]=o.useState(null);function l(){a(f=>{if(!e)return null;if(e.isConnected===!1){var h;return(h=f??n)!=null?h:null}const m=t(e);return JSON.stringify(f)===JSON.stringify(m)?f:m})}const d=Hi({callback(f){if(e)for(const h of f){const{type:m,target:x}=h;if(m==="childList"&&x instanceof HTMLElement&&x.contains(e)){l();break}}}}),u=Dn({callback:l});return ot(()=>{l(),e?(u==null||u.observe(e),d==null||d.observe(document.body,{childList:!0,subtree:!0})):(u==null||u.disconnect(),d==null||d.disconnect())},[e]),s}function qi(e){const t=gr(e);return Vr(e,t)}const Er=[];function Gi(e){const t=o.useRef(e),n=en(s=>e?s&&s!==Er&&e&&t.current&&e.parentNode===t.current.parentNode?s:dr(e):Er,[e]);return o.useEffect(()=>{t.current=e},[e]),n}function Ji(e){const[t,n]=o.useState(null),s=o.useRef(e),a=o.useCallback(l=>{const d=qn(l.target);d&&n(u=>u?(u.set(d,tr(d)),new Map(u)):null)},[]);return o.useEffect(()=>{const l=s.current;if(e!==l){d(l);const u=e.map(f=>{const h=qn(f);return h?(h.addEventListener("scroll",a,{passive:!0}),[h,tr(h)]):null}).filter(f=>f!=null);n(u.length?new Map(u):null),s.current=e}return()=>{d(e),d(l)};function d(u){u.forEach(f=>{const h=qn(f);h==null||h.removeEventListener("scroll",a)})}},[a,e]),o.useMemo(()=>e.length?t?Array.from(t.values()).reduce((l,d)=>zt(l,d),lt):Jr(e):lt,[e,t])}function Mr(e,t){t===void 0&&(t=[]);const n=o.useRef(null);return o.useEffect(()=>{n.current=null},t),o.useEffect(()=>{const s=e!==lt;s&&!n.current&&(n.current=e),!s&&n.current&&(n.current=null)},[e]),n.current?vn(e,n.current):lt}function Qi(e){o.useEffect(()=>{if(!Cn)return;const t=e.map(n=>{let{sensor:s}=n;return s.setup==null?void 0:s.setup()});return()=>{for(const n of t)n==null||n()}},e.map(t=>{let{sensor:n}=t;return n}))}function Zi(e,t){return o.useMemo(()=>e.reduce((n,s)=>{let{eventName:a,handler:l}=s;return n[a]=d=>{l(d,t)},n},{}),[e,t])}function ts(e){return o.useMemo(()=>e?Ci(e):null,[e])}const Lr=[];function ea(e,t){t===void 0&&(t=Ut);const[n]=e,s=ts(n?Ee(n):null),[a,l]=o.useState(Lr);function d(){l(()=>e.length?e.map(f=>qr(f)?s:new ur(t(f),f)):Lr)}const u=Dn({callback:d});return ot(()=>{u==null||u.disconnect(),d(),e.forEach(f=>u==null?void 0:u.observe(f))},[e]),a}function ns(e){if(!e)return null;if(e.children.length>1)return e;const t=e.children[0];return Zt(t)?t:e}function ta(e){let{measure:t}=e;const[n,s]=o.useState(null),a=o.useCallback(h=>{for(const{target:m}of h)if(Zt(m)){s(x=>{const N=t(m);return x?{...x,width:N.width,height:N.height}:N});break}},[t]),l=Dn({callback:a}),d=o.useCallback(h=>{const m=ns(h);l==null||l.disconnect(),m&&(l==null||l.observe(m)),s(m?t(m):null)},[t,l]),[u,f]=bn(d);return o.useMemo(()=>({nodeRef:u,rect:n,setRef:f}),[n,u,f])}const na=[{sensor:hr,options:{}},{sensor:es,options:{}}],ra={current:{}},xn={draggable:{measure:Sr},droppable:{measure:Sr,strategy:Qt.WhileDragging,frequency:rr.Optimized},dragOverlay:{measure:Ut}};class Gt extends Map{get(t){var n;return t!=null&&(n=super.get(t))!=null?n:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(t=>{let{disabled:n}=t;return!n})}getNodeFor(t){var n,s;return(n=(s=this.get(t))==null?void 0:s.node.current)!=null?n:void 0}}const sa={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new Gt,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:Nn},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:xn,measureDroppableContainers:Nn,windowRect:null,measuringScheduled:!1},rs={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:Nn,draggableNodes:new Map,over:null,measureDroppableContainers:Nn},nn=o.createContext(rs),ss=o.createContext(sa);function ia(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new Gt}}}function aa(e,t){switch(t.type){case ve.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case ve.DragMove:return e.draggable.active==null?e:{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}};case ve.DragEnd:case ve.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case ve.RegisterDroppable:{const{element:n}=t,{id:s}=n,a=new Gt(e.droppable.containers);return a.set(s,n),{...e,droppable:{...e.droppable,containers:a}}}case ve.SetDroppableDisabled:{const{id:n,key:s,disabled:a}=t,l=e.droppable.containers.get(n);if(!l||s!==l.key)return e;const d=new Gt(e.droppable.containers);return d.set(n,{...l,disabled:a}),{...e,droppable:{...e.droppable,containers:d}}}case ve.UnregisterDroppable:{const{id:n,key:s}=t,a=e.droppable.containers.get(n);if(!a||s!==a.key)return e;const l=new Gt(e.droppable.containers);return l.delete(n),{...e,droppable:{...e.droppable,containers:l}}}default:return e}}function oa(e){let{disabled:t}=e;const{active:n,activatorEvent:s,draggableNodes:a}=o.useContext(nn),l=yn(s),d=yn(n==null?void 0:n.id);return o.useEffect(()=>{if(!t&&!s&&l&&d!=null){if(!kn(l)||document.activeElement===l.target)return;const u=a.get(d);if(!u)return;const{activatorNode:f,node:h}=u;if(!f.current&&!h.current)return;requestAnimationFrame(()=>{for(const m of[f.current,h.current]){if(!m)continue;const x=Qs(m);if(x){x.focus();break}}})}},[s,t,a,d,l]),null}function is(e,t){let{transform:n,...s}=t;return e!=null&&e.length?e.reduce((a,l)=>l({transform:a,...s}),n):n}function la(e){return o.useMemo(()=>({draggable:{...xn.draggable,...e==null?void 0:e.draggable},droppable:{...xn.droppable,...e==null?void 0:e.droppable},dragOverlay:{...xn.dragOverlay,...e==null?void 0:e.dragOverlay}}),[e==null?void 0:e.draggable,e==null?void 0:e.droppable,e==null?void 0:e.dragOverlay])}function ca(e){let{activeNode:t,measure:n,initialRect:s,config:a=!0}=e;const l=o.useRef(!1),{x:d,y:u}=typeof a=="boolean"?{x:a,y:a}:a;ot(()=>{if(!d&&!u||!t){l.current=!1;return}if(l.current||!s)return;const h=t==null?void 0:t.node.current;if(!h||h.isConnected===!1)return;const m=n(h),x=Vr(m,s);if(d||(x.x=0),u||(x.y=0),l.current=!0,Math.abs(x.x)>0||Math.abs(x.y)>0){const N=Kr(h);N&&N.scrollBy({top:x.y,left:x.x})}},[t,d,u,s,n])}const An=o.createContext({...lt,scaleX:1,scaleY:1});var At;(function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"})(At||(At={}));const da=o.memo(function(t){var n,s,a,l;let{id:d,accessibility:u,autoScroll:f=!0,children:h,sensors:m=na,collisionDetection:x=xi,measuring:N,modifiers:v,...R}=t;const j=o.useReducer(aa,void 0,ia),[k,I]=j,[M,E]=si(),[O,z]=o.useState(At.Uninitialized),P=O===At.Initialized,{draggable:{active:A,nodes:L,translate:B},droppable:{containers:H}}=k,F=A!=null?L.get(A):null,me=o.useRef({initial:null,translated:null}),de=o.useMemo(()=>{var te;return A!=null?{id:A,data:(te=F==null?void 0:F.data)!=null?te:ra,rect:me}:null},[A,F]),je=o.useRef(null),[We,Ye]=o.useState(null),[re,Me]=o.useState(null),se=Jt(R,Object.values(R)),nt=tn("DndDescribedBy",d),Le=o.useMemo(()=>H.getEnabled(),[H]),J=la(N),{droppableRects:xe,measureDroppableContainers:qe,measuringScheduled:Ie}=Xi(Le,{dragging:P,dependencies:[B.x,B.y],config:J.droppable}),ie=Wi(L,A),Ve=o.useMemo(()=>re?wn(re):null,[re]),pe=It(),ue=Ki(ie,J.draggable.measure);ca({activeNode:A!=null?L.get(A):null,config:pe.layoutShiftCompensation,initialRect:ue,measure:J.draggable.measure});const $=Rr(ie,J.draggable.measure,ue),$e=Rr(ie?ie.parentElement:null),oe=o.useRef({activatorEvent:null,active:null,activeNode:ie,collisionRect:null,collisions:null,droppableRects:xe,draggableNodes:L,draggingNode:null,draggingNodeRect:null,droppableContainers:H,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),ct=H.getNodeFor((n=oe.current.over)==null?void 0:n.id),ke=ta({measure:J.dragOverlay.measure}),Xe=(s=ke.nodeRef.current)!=null?s:ie,Ce=P?(a=ke.rect)!=null?a:$:null,_t=!!(ke.nodeRef.current&&ke.rect),rt=qi(_t?null:$),ht=ts(Xe?Ee(Xe):null),be=Gi(P?ct??ie:null),st=ea(be),dt=is(v,{transform:{x:B.x-rt.x,y:B.y-rt.y,scaleX:1,scaleY:1},activatorEvent:re,active:de,activeNodeRect:$,containerNodeRect:$e,draggingNodeRect:Ce,over:oe.current.over,overlayNodeRect:ke.rect,scrollableAncestors:be,scrollableAncestorRects:st,windowRect:ht}),Nt=Ve?zt(Ve,B):null,Te=Ji(be),Rt=Mr(Te),Ge=Mr(Te,[$]),Je=zt(dt,Rt),De=Ce?wi(Ce,dt):null,Oe=de&&De?x({active:de,collisionRect:De,droppableRects:xe,droppableContainers:Le,pointerCoordinates:Nt}):null,ze=fi(Oe,"id"),[Pe,Ke]=o.useState(null),gt=_t?dt:zt(dt,Ge),mt=yi(gt,(l=Pe==null?void 0:Pe.rect)!=null?l:null,$),jt=o.useRef(null),Ct=o.useCallback((te,le)=>{let{sensor:ee,options:fe}=le;if(je.current==null)return;const he=L.get(je.current);if(!he)return;const ge=te.nativeEvent,Se=new ee({active:je.current,activeNode:he,event:ge,options:fe,context:oe,onAbort(Y){if(!L.get(Y))return;const{onDragAbort:_e}=se.current,Fe={id:Y};_e==null||_e(Fe),M({type:"onDragAbort",event:Fe})},onPending(Y,Ae,_e,Fe){if(!L.get(Y))return;const{onDragPending:q}=se.current,Be={id:Y,constraint:Ae,initialCoordinates:_e,offset:Fe};q==null||q(Be),M({type:"onDragPending",event:Be})},onStart(Y){const Ae=je.current;if(Ae==null)return;const _e=L.get(Ae);if(!_e)return;const{onDragStart:Fe}=se.current,Re={activatorEvent:ge,active:{id:Ae,data:_e.data,rect:me}};Ht.unstable_batchedUpdates(()=>{Fe==null||Fe(Re),z(At.Initializing),I({type:ve.DragStart,initialCoordinates:Y,active:Ae}),M({type:"onDragStart",event:Re}),Ye(jt.current),Me(ge)})},onMove(Y){I({type:ve.DragMove,coordinates:Y})},onEnd:Qe(ve.DragEnd),onCancel:Qe(ve.DragCancel)});jt.current=Se;function Qe(Y){return async function(){const{active:_e,collisions:Fe,over:Re,scrollAdjustedTranslate:q}=oe.current;let Be=null;if(_e&&q){const{cancelDrop:Q}=se.current;Be={activatorEvent:ge,active:_e,collisions:Fe,delta:q,over:Re},Y===ve.DragEnd&&typeof Q=="function"&&await Promise.resolve(Q(Be))&&(Y=ve.DragCancel)}je.current=null,Ht.unstable_batchedUpdates(()=>{I({type:Y}),z(At.Uninitialized),Ke(null),Ye(null),Me(null),jt.current=null;const Q=Y===ve.DragEnd?"onDragEnd":"onDragCancel";if(Be){const pt=se.current[Q];pt==null||pt(Be),M({type:Q,event:Be})}})}}},[L]),Lt=o.useCallback((te,le)=>(ee,fe)=>{const he=ee.nativeEvent,ge=L.get(fe);if(je.current!==null||!ge||he.dndKit||he.defaultPrevented)return;const Se={active:ge};te(ee,le.options,Se)===!0&&(he.dndKit={capturedBy:le.sensor},je.current=fe,Ct(ee,le))},[L,Ct]),St=Vi(m,Lt);Qi(m),ot(()=>{$&&O===At.Initializing&&z(At.Initialized)},[$,O]),o.useEffect(()=>{const{onDragMove:te}=se.current,{active:le,activatorEvent:ee,collisions:fe,over:he}=oe.current;if(!le||!ee)return;const ge={active:le,activatorEvent:ee,collisions:fe,delta:{x:Je.x,y:Je.y},over:he};Ht.unstable_batchedUpdates(()=>{te==null||te(ge),M({type:"onDragMove",event:ge})})},[Je.x,Je.y]),o.useEffect(()=>{const{active:te,activatorEvent:le,collisions:ee,droppableContainers:fe,scrollAdjustedTranslate:he}=oe.current;if(!te||je.current==null||!le||!he)return;const{onDragOver:ge}=se.current,Se=fe.get(ze),Qe=Se&&Se.rect.current?{id:Se.id,rect:Se.rect.current,data:Se.data,disabled:Se.disabled}:null,Y={active:te,activatorEvent:le,collisions:ee,delta:{x:he.x,y:he.y},over:Qe};Ht.unstable_batchedUpdates(()=>{Ke(Qe),ge==null||ge(Y),M({type:"onDragOver",event:Y})})},[ze]),ot(()=>{oe.current={activatorEvent:re,active:de,activeNode:ie,collisionRect:De,collisions:Oe,droppableRects:xe,draggableNodes:L,draggingNode:Xe,draggingNodeRect:Ce,droppableContainers:H,over:Pe,scrollableAncestors:be,scrollAdjustedTranslate:Je},me.current={initial:Ce,translated:De}},[de,ie,Oe,De,L,Xe,Ce,xe,H,Pe,be,Je]),Fi({...pe,delta:B,draggingRect:De,pointerCoordinates:Nt,scrollableAncestors:be,scrollableAncestorRects:st});const Et=o.useMemo(()=>({active:de,activeNode:ie,activeNodeRect:$,activatorEvent:re,collisions:Oe,containerNodeRect:$e,dragOverlay:ke,draggableNodes:L,droppableContainers:H,droppableRects:xe,over:Pe,measureDroppableContainers:qe,scrollableAncestors:be,scrollableAncestorRects:st,measuringConfiguration:J,measuringScheduled:Ie,windowRect:ht}),[de,ie,$,re,Oe,$e,ke,L,H,xe,Pe,qe,be,st,J,Ie,ht]),xt=o.useMemo(()=>({activatorEvent:re,activators:St,active:de,activeNodeRect:$,ariaDescribedById:{draggable:nt},dispatch:I,draggableNodes:L,over:Pe,measureDroppableContainers:qe}),[re,St,de,$,I,nt,L,Pe,qe]);return G.createElement(Wr.Provider,{value:E},G.createElement(nn.Provider,{value:xt},G.createElement(ss.Provider,{value:Et},G.createElement(An.Provider,{value:mt},h)),G.createElement(oa,{disabled:(u==null?void 0:u.restoreFocus)===!1})),G.createElement(oi,{...u,hiddenTextDescribedById:nt}));function It(){const te=(We==null?void 0:We.autoScrollEnabled)===!1,le=typeof f=="object"?f.enabled===!1:f===!1,ee=P&&!te&&!le;return typeof f=="object"?{...f,enabled:ee}:{enabled:ee}}}),ua=o.createContext(null),Ir="button",fa="Draggable";function ha(e){let{id:t,data:n,disabled:s=!1,attributes:a}=e;const l=tn(fa),{activators:d,activatorEvent:u,active:f,activeNodeRect:h,ariaDescribedById:m,draggableNodes:x,over:N}=o.useContext(nn),{role:v=Ir,roleDescription:R="draggable",tabIndex:j=0}=a??{},k=(f==null?void 0:f.id)===t,I=o.useContext(k?An:ua),[M,E]=bn(),[O,z]=bn(),P=Zi(d,t),A=Jt(n);ot(()=>(x.set(t,{id:t,key:l,node:M,activatorNode:O,data:A}),()=>{const B=x.get(t);B&&B.key===l&&x.delete(t)}),[x,t]);const L=o.useMemo(()=>({role:v,tabIndex:j,"aria-disabled":s,"aria-pressed":k&&v===Ir?!0:void 0,"aria-roledescription":R,"aria-describedby":m.draggable}),[s,v,j,k,R,m.draggable]);return{active:f,activatorEvent:u,activeNodeRect:h,attributes:L,isDragging:k,listeners:s?void 0:P,node:M,over:N,setNodeRef:E,setActivatorNodeRef:z,transform:I}}function as(){return o.useContext(ss)}const ga="Droppable",ma={timeout:25};function xa(e){let{data:t,disabled:n=!1,id:s,resizeObserverConfig:a}=e;const l=tn(ga),{active:d,dispatch:u,over:f,measureDroppableContainers:h}=o.useContext(nn),m=o.useRef({disabled:n}),x=o.useRef(!1),N=o.useRef(null),v=o.useRef(null),{disabled:R,updateMeasurementsFor:j,timeout:k}={...ma,...a},I=Jt(j??s),M=o.useCallback(()=>{if(!x.current){x.current=!0;return}v.current!=null&&clearTimeout(v.current),v.current=setTimeout(()=>{h(Array.isArray(I.current)?I.current:[I.current]),v.current=null},k)},[k]),E=Dn({callback:M,disabled:R||!d}),O=o.useCallback((L,B)=>{E&&(B&&(E.unobserve(B),x.current=!1),L&&E.observe(L))},[E]),[z,P]=bn(O),A=Jt(t);return o.useEffect(()=>{!E||!z.current||(E.disconnect(),x.current=!1,E.observe(z.current))},[z,E]),o.useEffect(()=>(u({type:ve.RegisterDroppable,element:{id:s,key:l,disabled:n,node:z,rect:N,data:A}}),()=>u({type:ve.UnregisterDroppable,key:l,id:s})),[s]),o.useEffect(()=>{n!==m.current.disabled&&(u({type:ve.SetDroppableDisabled,id:s,key:l,disabled:n}),m.current.disabled=n)},[s,l,n,u]),{active:d,rect:N,isOver:(f==null?void 0:f.id)===s,node:z,over:f,setNodeRef:P}}function pa(e){let{animation:t,children:n}=e;const[s,a]=o.useState(null),[l,d]=o.useState(null),u=yn(n);return!n&&!s&&u&&a(u),ot(()=>{if(!l)return;const f=s==null?void 0:s.key,h=s==null?void 0:s.props.id;if(f==null||h==null){a(null);return}Promise.resolve(t(h,l)).then(()=>{a(null)})},[t,s,l]),G.createElement(G.Fragment,null,n,s?o.cloneElement(s,{ref:d}):null)}const ba={x:0,y:0,scaleX:1,scaleY:1};function ya(e){let{children:t}=e;return G.createElement(nn.Provider,{value:rs},G.createElement(An.Provider,{value:ba},t))}const va={position:"fixed",touchAction:"none"},wa=e=>kn(e)?"transform 250ms ease":void 0,Na=o.forwardRef((e,t)=>{let{as:n,activatorEvent:s,adjustScale:a,children:l,className:d,rect:u,style:f,transform:h,transition:m=wa}=e;if(!u)return null;const x=a?h:{...h,scaleX:1,scaleY:1},N={...va,width:u.width,height:u.height,top:u.top,left:u.left,transform:wt.Transform.toString(x),transformOrigin:a&&s?di(s,u):void 0,transition:typeof m=="function"?m(s):m,...f};return G.createElement(n,{className:d,style:N,ref:t},l)}),ja=e=>t=>{let{active:n,dragOverlay:s}=t;const a={},{styles:l,className:d}=e;if(l!=null&&l.active)for(const[u,f]of Object.entries(l.active))f!==void 0&&(a[u]=n.node.style.getPropertyValue(u),n.node.style.setProperty(u,f));if(l!=null&&l.dragOverlay)for(const[u,f]of Object.entries(l.dragOverlay))f!==void 0&&s.node.style.setProperty(u,f);return d!=null&&d.active&&n.node.classList.add(d.active),d!=null&&d.dragOverlay&&s.node.classList.add(d.dragOverlay),function(){for(const[f,h]of Object.entries(a))n.node.style.setProperty(f,h);d!=null&&d.active&&n.node.classList.remove(d.active)}},Ca=e=>{let{transform:{initial:t,final:n}}=e;return[{transform:wt.Transform.toString(t)},{transform:wt.Transform.toString(n)}]},Sa={duration:250,easing:"ease",keyframes:Ca,sideEffects:ja({styles:{active:{opacity:"0"}}})};function ka(e){let{config:t,draggableNodes:n,droppableContainers:s,measuringConfiguration:a}=e;return Sn((l,d)=>{if(t===null)return;const u=n.get(l);if(!u)return;const f=u.node.current;if(!f)return;const h=ns(d);if(!h)return;const{transform:m}=Ee(d).getComputedStyle(d),x=Xr(m);if(!x)return;const N=typeof t=="function"?t:Da(t);return Qr(f,a.draggable.measure),N({active:{id:l,data:u.data,node:f,rect:a.draggable.measure(f)},draggableNodes:n,dragOverlay:{node:d,rect:a.dragOverlay.measure(h)},droppableContainers:s,measuringConfiguration:a,transform:x})})}function Da(e){const{duration:t,easing:n,sideEffects:s,keyframes:a}={...Sa,...e};return l=>{let{active:d,dragOverlay:u,transform:f,...h}=l;if(!t)return;const m={x:u.rect.left-d.rect.left,y:u.rect.top-d.rect.top},x={scaleX:f.scaleX!==1?d.rect.width*f.scaleX/u.rect.width:1,scaleY:f.scaleY!==1?d.rect.height*f.scaleY/u.rect.height:1},N={x:f.x-m.x,y:f.y-m.y,...x},v=a({...h,active:d,dragOverlay:u,transform:{initial:f,final:N}}),[R]=v,j=v[v.length-1];if(JSON.stringify(R)===JSON.stringify(j))return;const k=s==null?void 0:s({active:d,dragOverlay:u,...h}),I=u.node.animate(v,{duration:t,easing:n,fill:"forwards"});return new Promise(M=>{I.onfinish=()=>{k==null||k(),M()}})}}let $r=0;function Aa(e){return o.useMemo(()=>{if(e!=null)return $r++,$r},[e])}const _a=G.memo(e=>{let{adjustScale:t=!1,children:n,dropAnimation:s,style:a,transition:l,modifiers:d,wrapperElement:u="div",className:f,zIndex:h=999}=e;const{activatorEvent:m,active:x,activeNodeRect:N,containerNodeRect:v,draggableNodes:R,droppableContainers:j,dragOverlay:k,over:I,measuringConfiguration:M,scrollableAncestors:E,scrollableAncestorRects:O,windowRect:z}=as(),P=o.useContext(An),A=Aa(x==null?void 0:x.id),L=is(d,{activatorEvent:m,active:x,activeNodeRect:N,containerNodeRect:v,draggingNodeRect:k.rect,over:I,overlayNodeRect:k.rect,scrollableAncestors:E,scrollableAncestorRects:O,transform:P,windowRect:z}),B=gr(N),H=ka({config:s,draggableNodes:R,droppableContainers:j,measuringConfiguration:M}),F=B?k.setRef:void 0;return G.createElement(ya,null,G.createElement(pa,{animation:H},x&&A?G.createElement(Na,{key:A,id:x.id,ref:F,as:u,activatorEvent:m,adjustScale:t,className:f,transition:l,rect:B,style:{zIndex:h,...a},transform:L},n):null))});function mr(e,t,n){const s=e.slice();return s.splice(n<0?s.length+n:n,0,s.splice(t,1)[0]),s}function Ra(e,t){return e.reduce((n,s,a)=>{const l=t.get(s);return l&&(n[a]=l),n},Array(e.length))}function fn(e){return e!==null&&e>=0}function Ea(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function Ma(e){return typeof e=="boolean"?{draggable:e,droppable:e}:e}const hn={scaleX:1,scaleY:1},Qn=e=>{var t;let{rects:n,activeNodeRect:s,activeIndex:a,overIndex:l,index:d}=e;const u=(t=n[a])!=null?t:s;if(!u)return null;const f=La(n,d,a);if(d===a){const h=n[l];return h?{x:a<l?h.left+h.width-(u.left+u.width):h.left-u.left,y:0,...hn}:null}return d>a&&d<=l?{x:-u.width-f,y:0,...hn}:d<a&&d>=l?{x:u.width+f,y:0,...hn}:{x:0,y:0,...hn}};function La(e,t,n){const s=e[t],a=e[t-1],l=e[t+1];return!s||!a&&!l?0:n<t?a?s.left-(a.left+a.width):l.left-(s.left+s.width):l?l.left-(s.left+s.width):s.left-(a.left+a.width)}const os=e=>{let{rects:t,activeIndex:n,overIndex:s,index:a}=e;const l=mr(t,s,n),d=t[a],u=l[a];return!u||!d?null:{x:u.left-d.left,y:u.top-d.top,scaleX:u.width/d.width,scaleY:u.height/d.height}},gn={scaleX:1,scaleY:1},Ia=e=>{var t;let{activeIndex:n,activeNodeRect:s,index:a,rects:l,overIndex:d}=e;const u=(t=l[n])!=null?t:s;if(!u)return null;if(a===n){const h=l[d];return h?{x:0,y:n<d?h.top+h.height-(u.top+u.height):h.top-u.top,...gn}:null}const f=$a(l,a,n);return a>n&&a<=d?{x:0,y:-u.height-f,...gn}:a<n&&a>=d?{x:0,y:u.height+f,...gn}:{x:0,y:0,...gn}};function $a(e,t,n){const s=e[t],a=e[t-1],l=e[t+1];return s?n<t?a?s.top-(a.top+a.height):l?l.top-(s.top+s.height):0:l?l.top-(s.top+s.height):a?s.top-(a.top+a.height):0:0}const ls="Sortable",cs=G.createContext({activeIndex:-1,containerId:ls,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:os,disabled:{draggable:!1,droppable:!1}});function mn(e){let{children:t,id:n,items:s,strategy:a=os,disabled:l=!1}=e;const{active:d,dragOverlay:u,droppableRects:f,over:h,measureDroppableContainers:m}=as(),x=tn(ls,n),N=u.rect!==null,v=o.useMemo(()=>s.map(P=>typeof P=="object"&&"id"in P?P.id:P),[s]),R=d!=null,j=d?v.indexOf(d.id):-1,k=h?v.indexOf(h.id):-1,I=o.useRef(v),M=!Ea(v,I.current),E=k!==-1&&j===-1||M,O=Ma(l);ot(()=>{M&&R&&m(v)},[M,v,R,m]),o.useEffect(()=>{I.current=v},[v]);const z=o.useMemo(()=>({activeIndex:j,containerId:x,disabled:O,disableTransforms:E,items:v,overIndex:k,useDragOverlay:N,sortedRects:Ra(v,f),strategy:a}),[j,x,O.draggable,O.droppable,E,v,k,f,N,a]);return G.createElement(cs.Provider,{value:z},t)}const Ta=e=>{let{id:t,items:n,activeIndex:s,overIndex:a}=e;return mr(n,s,a).indexOf(t)},Oa=e=>{let{containerId:t,isSorting:n,wasDragging:s,index:a,items:l,newIndex:d,previousItems:u,previousContainerId:f,transition:h}=e;return!h||!s||u!==l&&a===d?!1:n?!0:d!==a&&t===f},za={duration:200,easing:"ease"},ds="transform",Pa=wt.Transition.toString({property:ds,duration:0,easing:"linear"}),Fa={roleDescription:"sortable"};function Ba(e){let{disabled:t,index:n,node:s,rect:a}=e;const[l,d]=o.useState(null),u=o.useRef(n);return ot(()=>{if(!t&&n!==u.current&&s.current){const f=a.current;if(f){const h=Ut(s.current,{ignoreTransform:!0}),m={x:f.left-h.left,y:f.top-h.top,scaleX:f.width/h.width,scaleY:f.height/h.height};(m.x||m.y)&&d(m)}}n!==u.current&&(u.current=n)},[t,n,s,a]),o.useEffect(()=>{l&&d(null)},[l]),l}function us(e){let{animateLayoutChanges:t=Oa,attributes:n,disabled:s,data:a,getNewIndex:l=Ta,id:d,strategy:u,resizeObserverConfig:f,transition:h=za}=e;const{items:m,containerId:x,activeIndex:N,disabled:v,disableTransforms:R,sortedRects:j,overIndex:k,useDragOverlay:I,strategy:M}=o.useContext(cs),E=Ua(s,v),O=m.indexOf(d),z=o.useMemo(()=>({sortable:{containerId:x,index:O,items:m},...a}),[x,a,O,m]),P=o.useMemo(()=>m.slice(m.indexOf(d)),[m,d]),{rect:A,node:L,isOver:B,setNodeRef:H}=xa({id:d,data:z,disabled:E.droppable,resizeObserverConfig:{updateMeasurementsFor:P,...f}}),{active:F,activatorEvent:me,activeNodeRect:de,attributes:je,setNodeRef:We,listeners:Ye,isDragging:re,over:Me,setActivatorNodeRef:se,transform:nt}=ha({id:d,data:z,attributes:{...Fa,...n},disabled:E.draggable}),Le=Ys(H,We),J=!!F,xe=J&&!R&&fn(N)&&fn(k),qe=!I&&re,Ie=qe&&xe?nt:null,Ve=xe?Ie??(u??M)({rects:j,activeNodeRect:de,activeIndex:N,overIndex:k,index:O}):null,pe=fn(N)&&fn(k)?l({id:d,items:m,activeIndex:N,overIndex:k}):O,ue=F==null?void 0:F.id,$=o.useRef({activeId:ue,items:m,newIndex:pe,containerId:x}),$e=m!==$.current.items,oe=t({active:F,containerId:x,isDragging:re,isSorting:J,id:d,index:O,items:m,newIndex:$.current.newIndex,previousItems:$.current.items,previousContainerId:$.current.containerId,transition:h,wasDragging:$.current.activeId!=null}),ct=Ba({disabled:!oe,index:O,node:L,rect:A});return o.useEffect(()=>{J&&$.current.newIndex!==pe&&($.current.newIndex=pe),x!==$.current.containerId&&($.current.containerId=x),m!==$.current.items&&($.current.items=m)},[J,pe,x,m]),o.useEffect(()=>{if(ue===$.current.activeId)return;if(ue!=null&&$.current.activeId==null){$.current.activeId=ue;return}const Xe=setTimeout(()=>{$.current.activeId=ue},50);return()=>clearTimeout(Xe)},[ue]),{active:F,activeIndex:N,attributes:je,data:z,rect:A,index:O,newIndex:pe,items:m,isOver:B,isSorting:J,isDragging:re,listeners:Ye,node:L,overIndex:k,over:Me,setNodeRef:Le,setActivatorNodeRef:se,setDroppableNodeRef:H,setDraggableNodeRef:We,transform:ct??Ve,transition:ke()};function ke(){if(ct||$e&&$.current.newIndex===O)return Pa;if(!(qe&&!kn(me)||!h)&&(J||oe))return wt.Transition.toString({...h,property:ds})}}function Ua(e,t){var n,s;return typeof e=="boolean"?{draggable:e,droppable:!1}:{draggable:(n=e==null?void 0:e.draggable)!=null?n:t.draggable,droppable:(s=e==null?void 0:e.droppable)!=null?s:t.droppable}}V.Down,V.Right,V.Up,V.Left;const Tr=["bg-sky-600","bg-emerald-600","bg-violet-600","bg-rose-600","bg-amber-600"];function Pt(e){if(!e)return"No date set";const t=new Date(e);if(isNaN(t.getTime()))return"Invalid date";const n=t.getDate(),s=t.toLocaleString("en-US",{month:"long"}),a=t.getFullYear();let l="th";return n===1||n===21||n===31?l="st":n===2||n===22?l="nd":(n===3||n===23)&&(l="rd"),`${n}${l} ${s} ${a}`}function Zn(e){return e?typeof e=="string"?/^\d{4}-\d{2}-\d{2}$/.test(e)?e:e.includes("T")?e.split("T")[0]:"":e instanceof Date&&!isNaN(e.getTime())?e.toISOString().split("T")[0]:"":""}function sr(e){return new Date(e).toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}function ir(e){return!e||e<=0?"":e<1024?`${e} B`:e<1024*1024?`${(e/1024).toFixed(1)} KB`:`${(e/(1024*1024)).toFixed(1)} MB`}function Wa(e){if(!e)return null;const n=e.trim().slice(0,10).match(/^(\d{4})-(\d{2})-(\d{2})$/);if(!n)return null;const s=Number(n[1]),a=Number(n[2])-1,l=Number(n[3]);return new Date(s,a,l)}function Va(e){const t=(e.first_name||"").trim().charAt(0),n=(e.last_name||"").trim().charAt(0),s=(e.email||"").trim().charAt(0);return(`${t}${n}`.trim()||s||"U").toUpperCase()}const Kt=["Student's Phone Number:","Student's Email:","Emergency Phone Number:","Date of Birth:","","Education Background (Grades & Stream):","Gap explanation if applicable:","English Proficiency:","","Intended Level of Study:","Interested Program Of Study:","Institution/City Preference:","Maximum Budget:","","Funding Details:","Sponsor:","Source of Income:","Funds Breakdown:"].join(`
`),Xa=o.lazy(()=>js(()=>import("./index.es-yC5EJTii.js"),__vite__mapDeps([0,1,2,3])));function Ka({card:e,listTitle:t,profile:n,onClose:s,setSelectedCard:a,fetchBoard:l}){var Wt;const[d,u]=o.useState(!1),[f,h]=o.useState([]),[m,x]=o.useState(null),[N,v]=o.useState([]),[R,j]=o.useState("country"),[k,I]=o.useState([]),[M,E]=o.useState([]),[O,z]=o.useState([]),[P,A]=o.useState(!1),[L,B]=o.useState(!1),[H,F]=o.useState((Wt=e.description)!=null&&Wt.trim()?e.description:Kt),[me,de]=o.useState(!1),je=o.useRef(null),[We,Ye]=o.useState(!1),[re,Me]=o.useState(Zn(e.due_date)),[se,nt]=o.useState(!1),[Le,J]=o.useState(!!e.payment_done),[xe,qe]=o.useState(!!e.dependant_payment_done),[Ie,ie]=o.useState(!1),[Ve,pe]=o.useState(!1),[ue,$]=o.useState(!1),[$e,oe]=o.useState(!1),[ct,ke]=o.useState(!1),Xe=o.useRef(null),[Ce,_t]=o.useState([]),[rt,ht]=o.useState(""),[be,st]=o.useState(null),[dt,Nt]=o.useState(0),[Te,Rt]=o.useState(!1),[Ge,Je]=o.useState(null),[De,Oe]=o.useState(!1),[ze,Pe]=o.useState(!1),[Ke,gt]=o.useState(!1),[mt,jt]=o.useState([]),[Ct,Lt]=o.useState([]),[St,Et]=o.useState([]),[xt,It]=o.useState(""),[te,le]=o.useState(null),ee=Number(n==null?void 0:n.role_id)===1||Number(n==null?void 0:n.role_id)===2;o.useEffect(()=>{var C;const c=Array.isArray(e.country_label_ids)?e.country_label_ids:e.country_label_id!=null?[e.country_label_id]:[];h(c),x(e.intake_label_id??null);const y=Array.isArray(e.service_area_ids)?e.service_area_ids:e.service_area_id!=null?[e.service_area_id]:[];v(y),j("country"),F((C=e.description)!=null&&C.trim()?e.description:Kt),Me(Zn(e.due_date)),J(!!e.payment_done),qe(!!e.dependant_payment_done),oe(!1),ke(!1),Oe(!1),jt([]),Lt([]),Et([]),It(""),le(null),fe(),Y()},[e]),o.useEffect(()=>{if(!L||!je.current)return;const c=je.current;c.style.height="0px",c.style.height=`${c.scrollHeight}px`},[L,H]),o.useEffect(()=>{Promise.all([Q(),pt(),$t()])},[e.id]),o.useEffect(()=>{const c=y=>{if(y.key==="Escape"){if($e){oe(!1);return}y.preventDefault(),s()}};return window.addEventListener("keydown",c),()=>window.removeEventListener("keydown",c)},[s,$e]),o.useEffect(()=>{if(!$e)return;const c=y=>{Xe.current&&(Xe.current.contains(y.target)||oe(!1))};return document.addEventListener("mousedown",c),()=>document.removeEventListener("mousedown",c)},[$e]);const fe=async()=>{try{const c=await W.get(`/cards/${e.id}/activities`);_t(c.data||[])}catch(c){console.error("Failed to fetch activities:",c)}},he=async()=>{if(!(!rt.trim()&&!be)){Rt(!0);try{const c=new FormData;rt.trim()&&c.append("details",rt.trim()),be&&c.append("attachment",be),await W.post(`/cards/${e.id}/activities`,c),ht(""),st(null),Nt(y=>y+1),await fe()}catch(c){console.error("Failed to post comment:",c),alert("Could not post comment / attachment.")}finally{Rt(!1)}}},ge=async c=>{try{Je(c.id);const y=await W.get(`/activities/${c.id}/attachment`,{responseType:"blob"}),C=new Blob([y.data],{type:c.attachment_mime||y.headers["content-type"]||"application/octet-stream"}),S=URL.createObjectURL(C);if(!window.open(S,"_blank","noopener,noreferrer")){const Ze=document.createElement("a");Ze.href=S,Ze.download=c.attachment_name||"attachment",document.body.appendChild(Ze),Ze.click(),document.body.removeChild(Ze)}window.setTimeout(()=>URL.revokeObjectURL(S),6e4)}catch(y){console.error("Failed to open attachment:",y),alert("Could not open attachment.")}finally{Je(null)}},Se=c=>`${c.first_name||""} ${c.last_name||""}`.trim()||c.email||`User #${c.id}`,Qe=c=>{const y=(c.first_name||"").trim().charAt(0),C=(c.last_name||"").trim().charAt(0),S=(c.email||"").trim().charAt(0);return(`${y}${C}`.trim()||S||"U").toUpperCase()},Y=async()=>{var c,y;Pe(!0),le(null);try{const C=await W.get(`/cards/${e.id}/members`),S=((c=C.data)==null?void 0:c.members)||[],He=Array.isArray((y=C.data)==null?void 0:y.options)?C.data.options:[],Ze=He.length>0?He:S;Lt(S),Et(S.map(ut=>ut.id)),jt(Ze)}catch(C){console.error("Failed to fetch card members:",C),le("Could not load members.")}finally{Pe(!1)}},Ae=async()=>{Oe(!0),await Y()},_e=c=>{!ee||Ke||Et(y=>y.includes(c)?y.filter(C=>C!==c):[...y,c])},Fe=async()=>{var c,y;if(ee){gt(!0),le(null);try{await W.put(`/cards/${e.id}/members`,{user_ids:St}),await Y(),await fe(),await l(),Oe(!1)}catch(C){console.error("Failed to save members:",C),le(((y=(c=C==null?void 0:C.response)==null?void 0:c.data)==null?void 0:y.message)||"Could not save members.")}finally{gt(!1)}}},Re=o.useMemo(()=>{const c=xt.trim().toLowerCase();return c?mt.filter(y=>`${y.first_name||""} ${y.last_name||""} ${y.email||""}`.toLowerCase().includes(c)):mt},[mt,xt]),q=o.useMemo(()=>{var y;const c={total:Ce.length,comments:0,attachments:0,labelUpdates:0,paymentUpdates:0,latestAt:((y=Ce[0])==null?void 0:y.created_at)||null};for(const C of Ce)C.action==="commented"&&(c.comments+=1),(C.attachment_path||C.attachment_url)&&(c.attachments+=1),C.action.includes("label")&&(c.labelUpdates+=1),C.action.includes("payment")&&(c.paymentUpdates+=1);return c},[Ce]),Be=c=>Array.isArray(c==null?void 0:c.data)?c.data:Array.isArray(c)?c:[],Q=async()=>{A(!0);try{const c=await W.get("/country-labels");I(Be(c.data))}catch(c){console.error("Failed to load country labels",c),alert("Could not load country labels.")}finally{A(!1)}},pt=async()=>{A(!0);try{const c=await W.get("/intake-labels");E(Be(c.data))}catch(c){console.error("Failed to load intake labels",c),alert("Could not load intake labels.")}finally{A(!1)}},$t=async()=>{A(!0);try{const c=await W.get("/service-areas");z(Be(c.data))}catch(c){console.error("Failed to load service areas",c),alert("Could not load service areas.")}finally{A(!1)}},bt=async c=>{j(c),u(!0),c==="country"?await Q():c==="intake"?await pt():await $t()},rn=(c,y)=>{y(C=>C.includes(c)?C.filter(S=>S!==c):[...C,c])},it=async()=>{try{const c=[...new Set(f)],y=[...new Set(N)],C={country_label_id:c[0]??null,country_label_ids:c,intake_label_id:m??null,service_area_id:y[0]??null,service_area_ids:y};await W.put(`/cards/${e.id}/labels`,C),a(S=>S&&S.id===e.id?{...S,...C}:S),await l(),await fe(),u(!1)}catch(c){console.error("Failed to save labels:",c),alert("Could not save labels. Please try again.")}},_n=async()=>{const c=H.trim();if(c===(e.description||"")){B(!1);return}de(!0);try{await W.put(`/cards/${e.id}/description`,{description:c||null}),a(y=>y&&y.id===e.id?{...y,description:c||void 0}:y),await l(),await fe(),B(!1)}catch(y){console.error("Failed to save description:",y),alert("Could not save description.")}finally{de(!1)}},sn=()=>{var c;F((c=e.description)!=null&&c.trim()?e.description:Kt),B(!0)},Rn=async()=>{nt(!0);try{const c=re.trim()||null;await W.put(`/cards/${e.id}/due-date`,{due_date:c}),a(y=>y&&y.id===e.id?{...y,due_date:c??void 0}:y),await l(),await fe(),Ye(!1)}catch(c){console.error("Failed to save due date:",c),alert("Could not save due date."),await l()}finally{nt(!1)}},En=()=>{Ye(!0)},Mn=async()=>{var y,C;if(Ie)return;ie(!0);const c=!Le;try{await W.put(`/cards/${e.id}/payment`,{payment_done:c}),J(c),a(S=>S&&S.id===e.id?{...S,payment_done:c}:S),await l(),await fe()}catch(S){console.error("Failed to update payment status:",S),alert(((C=(y=S==null?void 0:S.response)==null?void 0:y.data)==null?void 0:C.message)||"Could not update payment status."),await l()}finally{ie(!1)}},Ln=async()=>{var y,C;if(Ve)return;pe(!0);const c=!xe;try{await W.put(`/cards/${e.id}/dependant-payment`,{dependant_payment_done:c}),qe(c),a(S=>S&&S.id===e.id?{...S,dependant_payment_done:c}:S),await l(),await fe()}catch(S){console.error("Failed to update dependant payment status:",S),alert(((C=(y=S==null?void 0:S.response)==null?void 0:y.data)==null?void 0:C.message)||"Could not update dependant payment status."),await l()}finally{pe(!1)}},In=async()=>{var y,C;if(ue)return;$(!0);const c=!e.is_archived;try{if(await W.put(`/cards/${e.id}/archive`,{is_archived:c}),a(S=>S&&S.id===e.id?{...S,is_archived:c}:S),await l(),c){s();return}await fe()}catch(S){console.error("Failed to update archive status:",S),alert(((C=(y=S==null?void 0:S.response)==null?void 0:y.data)==null?void 0:C.message)||"Could not update archive status.")}finally{$(!1)}},$n=()=>{if(f.length===0)return"Country";const c=f.map(y=>{var C;return(C=k.find(S=>S.id===y))==null?void 0:C.name}).filter(y=>!!y);return c.length>0?c.join(", "):"Country"},Tn=()=>{var c;return((c=M.find(y=>y.id===m))==null?void 0:c.name)||"Intake"},On=()=>{if(N.length===0)return"Extra Service";const c=N.map(y=>{var C;return(C=O.find(S=>S.id===y))==null?void 0:C.name}).filter(y=>!!y);return c.length>0?c.join(", "):"Service"},zn=/((?:https?:\/\/|www\.)[^\s]+)/gi,Pn=c=>/^(?:https?:\/\/|www\.)[^\s]+$/i.test(c),an=c=>/^https?:\/\//i.test(c)?c:`https://${c}`,on=c=>{if(!c)return null;const y=c.split(/\r?\n/);return y.map((C,S)=>r.jsxs(G.Fragment,{children:[C.split(zn).map((He,Ze)=>{if(!He)return null;if(!Pn(He))return r.jsx(G.Fragment,{children:He},`text-${S}-${Ze}`);const ut=He.match(/^(.*?)([.,!?)]*)$/),Tt=(ut==null?void 0:ut[1])||He,Fn=(ut==null?void 0:ut[2])||"";return r.jsxs(G.Fragment,{children:[r.jsx("a",{href:an(Tt),target:"_blank",rel:"noopener noreferrer",className:"text-indigo-600 hover:text-indigo-700 underline break-all",children:Tt}),Fn]},`link-${S}-${Ze}`)}),S<y.length-1?r.jsx("br",{}):null]},`line-${S}`))};return r.jsxs("div",{className:"fixed inset-0 bg-black/65 backdrop-blur-sm z-50 flex items-center justify-center p-4 sm:p-6",children:[r.jsxs("div",{className:"bg-white w-full max-w-6xl rounded-2xl shadow-2xl overflow-hidden max-h-[92vh] flex flex-col border border-gray-200/50",children:[r.jsxs("div",{className:"px-6 py-4 border-b bg-gradient-to-r from-indigo-50/60 to-white flex items-start justify-between gap-6",children:[r.jsx("div",{className:"flex-1 min-w-0 space-y-1",children:r.jsx("div",{className:"inline-flex items-center gap-2 px-4 py-1.5 bg-indigo-100/80 text-indigo-800 rounded-lg text-sm font-bold border border-indigo-200 shadow-sm",children:t})}),r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsxs("div",{className:"relative",ref:Xe,children:[r.jsx("button",{type:"button",onClick:()=>oe(c=>!c),className:"h-9 w-9 flex items-center justify-center rounded-lg border border-gray-200 bg-white hover:bg-gray-50",children:r.jsx(zs,{size:17,className:"text-gray-600"})}),$e&&r.jsxs("div",{className:"absolute right-0 mt-2 w-60 rounded-lg border border-gray-200 bg-white shadow-lg p-1.5 z-20",children:[r.jsxs("button",{type:"button",onClick:()=>{oe(!1),Mn()},disabled:Ie,className:`w-full flex items-center gap-2 rounded-md px-3 py-2 text-sm text-left transition ${Ie?"text-gray-400 cursor-not-allowed":Le?"text-emerald-700 hover:bg-emerald-50":"text-rose-700 hover:bg-rose-50"}`,children:[r.jsx(wr,{size:15}),Ie?"Saving...":Le?"Visa Payment Done":"Mark Visa Payment Done"]}),r.jsxs("button",{type:"button",onClick:()=>{oe(!1),Ln()},disabled:Ve,className:`w-full flex items-center gap-2 rounded-md px-3 py-2 text-sm text-left transition ${Ve?"text-gray-400 cursor-not-allowed":xe?"text-emerald-700 hover:bg-emerald-50":"text-amber-700 hover:bg-amber-50"}`,children:[r.jsx(wr,{size:15}),Ve?"Saving...":xe?"Dependant Payment Done":"Mark Dependant Payment Done"]}),r.jsx("div",{className:"my-1 border-t border-gray-100"}),r.jsxs("button",{type:"button",onClick:()=>{oe(!1),In()},disabled:ue,className:`w-full flex items-center gap-2 rounded-md px-3 py-2 text-sm text-left transition ${ue?"text-gray-400 cursor-not-allowed":"text-amber-700 hover:bg-amber-50"}`,children:[r.jsx(zr,{size:15}),ue?"Saving...":e.is_archived?"Restore Card":"Archive Card"]})]})]}),r.jsx("button",{onClick:s,className:"h-9 w-9 flex items-center justify-center rounded-lg border border-red-200 bg-red-50 text-red-600 hover:bg-red-100",children:r.jsx(vt,{size:18})})]})]}),r.jsxs("div",{className:"flex flex-1 overflow-hidden",children:[r.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-7 bg-white",children:[r.jsx("div",{className:"flex items-start gap-3.5 pb-1",children:r.jsxs("h2",{className:"text-2xl font-extrabold text-gray-900 truncate leading-tight",children:[e.invoice||`ID-${e.id}`," ",e.first_name," ",e.last_name,"  ",Pt(e.created_at)]})}),r.jsxs("div",{className:"flex flex-wrap gap-1.5",children:[r.jsxs("button",{type:"button",onClick:()=>void bt("country"),className:"h-10 min-w-[100px] px-3 rounded-md bg-[#8f53c6] text-white text-sm font-bold border border-[#8f53c6] hover:brightness-95 transition flex items-center justify-center gap-1.5",children:[r.jsx(Us,{size:15,strokeWidth:2.2,className:"text-white/90"}),$n()]}),r.jsxs("button",{type:"button",onClick:()=>void bt("intake"),className:"h-10 min-w-[100px] px-3 rounded-md bg-[#f2b205] text-[#4a2b00] text-sm font-bold border border-[#f2b205] hover:brightness-95 transition flex items-center justify-center gap-1.5",children:[r.jsx(Fr,{size:15,strokeWidth:2.2,className:"text-[#4a2b00]/90"}),Tn()]}),r.jsxs("button",{type:"button",onClick:()=>void bt("serviceArea"),className:"h-10 px-3 rounded-md bg-[#d63a3a] text-white text-sm font-bold border border-[#d63a3a] hover:brightness-95 transition flex items-center gap-1.5",children:[r.jsx(pn,{size:14,className:"text-white/90"}),On()]}),r.jsxs("button",{type:"button",onClick:En,className:"h-10 px-3 rounded-md bg-[#4f46e5] text-white text-sm font-bold border border-[#4f46e5] hover:brightness-95 transition flex items-center gap-1.5",children:[r.jsx(Ls,{size:15,strokeWidth:2.2,className:"text-white/90"}),e.due_date?Pt(e.due_date):"Due Dates"]})]}),r.jsx("div",{className:"space-y-6",children:r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-bold text-gray-700 mb-2.5",children:"Members"}),r.jsxs("div",{className:"flex items-center gap-2",children:[Ct.slice(0,3).map(c=>r.jsx("button",{type:"button",onClick:Ae,title:Se(c),className:"h-10 w-10 rounded-full bg-sky-600 text-white text-sm font-bold flex items-center justify-center hover:brightness-110 transition",children:Qe(c)},c.id)),r.jsx("button",{type:"button",onClick:Ae,className:"h-10 w-10 rounded-full bg-gray-200 text-gray-700 text-xl flex items-center justify-center hover:bg-gray-300 transition",title:"Manage members",children:r.jsx(pn,{size:18})})]})]})}),r.jsxs("div",{className:"bg-gray-50/70 border border-gray-200 rounded-xl overflow-hidden",children:[r.jsxs("div",{className:"flex items-center justify-between px-5 py-3.5 border-b bg-white/60",children:[r.jsxs("div",{className:"flex items-center gap-2.5",children:[r.jsx(Pr,{size:18,className:"text-indigo-600"}),r.jsx("h3",{className:"font-bold text-gray-800",children:"Description"})]}),L?r.jsxs("div",{className:"flex gap-3",children:[r.jsx("button",{onClick:()=>{var c;B(!1),F((c=e.description)!=null&&c.trim()?e.description:Kt)},className:"px-4 py-1.5 text-sm text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded",disabled:me,children:"Cancel"}),r.jsx("button",{onClick:_n,className:`px-5 py-1.5 text-sm font-bold rounded text-white ${me?"bg-indigo-400 cursor-not-allowed":"bg-indigo-600 hover:bg-indigo-700"}`,disabled:me,children:me?"Saving...":"Save"})]}):r.jsxs("button",{onClick:sn,className:"flex items-center gap-1.5 text-sm text-indigo-600 hover:text-indigo-800 font-bold transition",children:[r.jsx(Or,{size:14}),"Edit"]})]}),L?r.jsx("div",{className:"p-5",children:r.jsx("textarea",{ref:je,value:H,onChange:c=>F(c.target.value),className:"w-full border border-gray-300 rounded-lg px-4 py-3 text-sm resize-none overflow-hidden min-h-[180px] focus:outline-none focus:ring-2 focus:ring-indigo-400 transition",placeholder:"Fill student profile details...",autoFocus:!0})}):r.jsx("div",{onClick:sn,className:"px-5 py-5 text-sm text-gray-800 space-y-2 leading-relaxed cursor-pointer hover:bg-white/40 transition",title:"Click to edit description",children:e.description&&e.description.trim()?e.description.split(`
`).map((c,y)=>r.jsx("p",{children:c},y)):Kt.split(`
`).map((c,y)=>r.jsx("p",{className:"text-gray-500",children:c||""},y))})]})]}),r.jsxs("div",{className:"w-full sm:w-[360px] bg-gray-50 border-l border-gray-200 flex flex-col overflow-hidden",children:[r.jsxs("div",{className:"px-5 py-4 border-b bg-white/80 flex items-center justify-between",children:[r.jsx("h3",{className:"font-bold text-gray-800",children:"Comments & Activity"}),r.jsxs("button",{type:"button",onClick:()=>ke(!0),className:"inline-flex items-center gap-1.5 text-sm px-3 py-1.5 bg-white border border-gray-200 rounded-lg hover:bg-gray-50 transition",children:[r.jsx($s,{size:14}),"Summary"]})]}),r.jsxs("div",{className:"flex-1 p-5 space-y-6 overflow-y-auto overflow-x-hidden",children:[r.jsxs("div",{className:"space-y-2",children:[r.jsx("textarea",{value:rt,onChange:c=>ht(c.target.value),placeholder:"Write a comment...",className:"w-full border border-gray-300 rounded-lg px-4 py-3 text-sm resize-none h-28 focus:outline-none focus:ring-2 focus:ring-indigo-400 focus:border-indigo-400 transition"}),r.jsxs("div",{className:"flex items-center justify-between gap-3",children:[r.jsxs("label",{className:"inline-flex items-center gap-2 px-3 py-2 text-sm border border-gray-300 rounded-lg bg-white hover:bg-gray-50 cursor-pointer",children:[r.jsx(Nr,{size:14,className:"text-gray-600"}),r.jsx("span",{children:"Attach file"}),r.jsx("input",{type:"file",className:"hidden",onChange:c=>{var C;const y=((C=c.target.files)==null?void 0:C[0])||null;st(y)}},dt)]}),be&&r.jsx("button",{type:"button",onClick:()=>{st(null),Nt(c=>c+1)},className:"text-xs text-red-600 hover:underline",children:"Remove file"})]}),be&&r.jsxs("div",{className:"text-xs text-gray-600 bg-white border border-gray-200 rounded-lg px-3 py-2",children:[r.jsx("span",{className:"font-bold",children:be.name}),r.jsx("span",{className:"ml-2 text-gray-500",children:ir(be.size)})]}),r.jsx("button",{onClick:he,disabled:Te||!rt.trim()&&!be,className:`w-full py-2 text-sm font-bold rounded-lg text-white ${Te?"bg-indigo-400 cursor-not-allowed":"bg-indigo-600 hover:bg-indigo-700"}`,children:Te?"Posting...":"Post Update"})]}),r.jsx("div",{className:"space-y-6",children:Ce.length===0?r.jsx("p",{className:"text-center text-gray-500",children:"No activities yet"}):Ce.map(c=>r.jsxs("div",{className:"flex gap-3",children:[r.jsx("div",{className:"w-9 h-9 bg-teal-600 text-white rounded-full flex items-center justify-center font-bold text-sm shrink-0",children:(c.user_name||"U").charAt(0).toUpperCase()}),r.jsxs("div",{className:"flex-1 space-y-1.5",children:[r.jsxs("p",{className:"text-sm leading-relaxed",children:[r.jsx("strong",{className:"text-gray-900",children:c.user_name||"User"})," ",c.action,c.details&&c.action!=="commented"?r.jsxs(r.Fragment,{children:[" ",on(c.details)]}):null]}),r.jsx("p",{className:"text-xs text-gray-500",children:sr(c.created_at)}),c.action==="commented"&&c.details&&r.jsx("div",{className:"mt-2 bg-white border border-gray-200 rounded-lg p-3 text-sm text-gray-700 whitespace-pre-wrap break-words",children:on(c.details)}),(c.attachment_path||c.attachment_url)&&r.jsxs("button",{type:"button",onClick:()=>void ge(c),disabled:Ge===c.id,className:"mt-2 inline-flex items-center gap-2 bg-white border border-gray-200 rounded-lg px-3 py-2 text-sm text-indigo-700 hover:bg-indigo-50 disabled:opacity-60",children:[r.jsx(Nr,{size:14}),r.jsx("span",{children:Ge===c.id?"Opening...":c.attachment_name||"Attachment"}),c.attachment_size?r.jsxs("span",{className:"text-xs text-gray-500",children:["(",ir(c.attachment_size),")"]}):null]}),r.jsx("button",{className:"text-xs text-gray-500 hover:text-gray-700 underline mt-1 transition",children:"Reply"})]})]},c.id))})]})]})]})]}),ct&&r.jsx("div",{className:"fixed inset-0 bg-black/45 z-[65] flex items-center justify-center p-4",children:r.jsxs("div",{className:"w-full max-w-md rounded-2xl border border-gray-200 bg-white shadow-2xl overflow-hidden",children:[r.jsxs("div",{className:"px-5 py-4 border-b bg-gray-50 flex items-center justify-between",children:[r.jsx("h4",{className:"text-base font-bold text-gray-900",children:"Activity Summary"}),r.jsx("button",{type:"button",onClick:()=>ke(!1),className:"h-8 w-8 rounded-md border border-gray-200 bg-white text-gray-600 hover:bg-gray-100 flex items-center justify-center",children:r.jsx(vt,{size:16})})]}),r.jsxs("div",{className:"p-5 space-y-3 text-sm text-gray-700",children:[r.jsxs("p",{children:[r.jsx("span",{className:"font-bold text-gray-900",children:"Total activities:"})," ",q.total]}),r.jsxs("p",{children:[r.jsx("span",{className:"font-bold text-gray-900",children:"Comments:"})," ",q.comments]}),r.jsxs("p",{children:[r.jsx("span",{className:"font-bold text-gray-900",children:"Attachments:"})," ",q.attachments]}),r.jsxs("p",{children:[r.jsx("span",{className:"font-bold text-gray-900",children:"Label updates:"})," ",q.labelUpdates]}),r.jsxs("p",{children:[r.jsx("span",{className:"font-bold text-gray-900",children:"Payment updates:"})," ",q.paymentUpdates]}),r.jsxs("p",{children:[r.jsx("span",{className:"font-bold text-gray-900",children:"Last activity:"})," ",q.latestAt?sr(q.latestAt):"No activity yet"]})]}),r.jsx("div",{className:"px-5 py-4 border-t bg-gray-50 flex justify-end",children:r.jsx("button",{type:"button",onClick:()=>ke(!1),className:"px-4 py-2 rounded-lg bg-indigo-600 text-white text-sm font-bold hover:bg-indigo-700",children:"Close"})})]})}),We&&r.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[60] p-4",children:r.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md p-6",children:[r.jsxs("div",{className:"flex items-center justify-between mb-4",children:[r.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"Select Due Date"}),r.jsx("button",{onClick:()=>Ye(!1),className:"text-gray-500 hover:text-gray-700",children:r.jsx(vt,{size:20})})]}),r.jsx(o.Suspense,{fallback:r.jsx("div",{className:"py-8 text-center text-gray-500",children:"Loading calendar..."}),children:r.jsx("div",{className:"flex justify-center mb-4",children:r.jsx(Xa,{inline:!0,selected:re?new Date(re):null,onChange:c=>{Me(c?c.toISOString().split("T")[0]:"")},dateFormat:"yyyy-MM-dd"})})}),re?r.jsx("div",{className:"mb-4 text-sm text-gray-600",children:`Selected: ${Pt(re)}`}):null,r.jsxs("div",{className:"flex justify-end gap-3",children:[r.jsx("button",{onClick:()=>Me(""),className:"px-5 py-2 text-sm text-gray-700 hover:bg-gray-100 rounded-lg",disabled:se,children:"Clear"}),r.jsx("button",{onClick:()=>{Ye(!1),Me(Zn(e.due_date))},className:"px-5 py-2 text-sm text-gray-700 hover:bg-gray-100 rounded-lg",disabled:se,children:"Cancel"}),r.jsx("button",{onClick:Rn,className:`px-6 py-2 text-sm font-bold text-white rounded-lg ${se?"bg-indigo-400 cursor-not-allowed":"bg-indigo-600 hover:bg-indigo-700"}`,disabled:se,children:se?"Saving...":"Save Date"})]})]})}),De&&r.jsx("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-[60] p-4",children:r.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-xl max-h-[85vh] overflow-hidden flex flex-col",children:[r.jsxs("div",{className:"p-6 border-b flex items-center justify-between",children:[r.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Card Members"}),r.jsx("button",{onClick:()=>Oe(!1),className:"text-gray-500 hover:text-gray-700",children:r.jsx(vt,{size:24})})]}),r.jsxs("div",{className:"p-6 space-y-4 flex-1 overflow-y-auto",children:[r.jsx("p",{className:"text-sm text-gray-600",children:"If no members are selected, everyone with board access can see this card."}),ee&&r.jsx("input",{value:xt,onChange:c=>It(c.target.value),placeholder:"Search user by name or email...",className:"w-full h-10 rounded-lg border border-gray-300 px-3 text-sm focus:outline-none focus:ring-2 focus:ring-indigo-400"}),te&&r.jsx("div",{className:"text-sm text-red-600 bg-red-50 border border-red-200 rounded-lg px-3 py-2",children:te}),ze?r.jsx("div",{className:"text-center py-10 text-gray-500",children:"Loading members..."}):r.jsx("div",{className:"border border-gray-200 rounded-xl overflow-hidden",children:Re.length===0?r.jsx("div",{className:"py-8 text-center text-sm text-gray-500",children:"No users found for roles 2, 3, and 4."}):r.jsx("div",{className:"max-h-[330px] overflow-y-auto divide-y",children:Re.map(c=>{const y=St.includes(c.id);return r.jsxs("label",{className:`flex items-center gap-3 px-4 py-3 ${ee?"cursor-pointer hover:bg-gray-50":""}`,children:[r.jsx("input",{type:"checkbox",checked:y,disabled:!ee||Ke,onChange:()=>_e(c.id),className:"h-4 w-4 rounded text-indigo-600"}),r.jsxs("div",{className:"min-w-0",children:[r.jsx("p",{className:"text-sm font-bold text-gray-900 truncate",children:Se(c)}),c.email?r.jsx("p",{className:"text-xs text-gray-500 truncate",children:c.email}):null]})]},c.id)})})})]}),r.jsxs("div",{className:"p-5 border-t flex justify-end gap-3",children:[r.jsx("button",{onClick:()=>Oe(!1),className:"px-5 py-2.5 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:"Close"}),ee&&r.jsx("button",{onClick:Fe,disabled:Ke||ze,className:`px-6 py-2.5 rounded-lg text-white font-bold ${Ke||ze?"bg-indigo-400 cursor-not-allowed":"bg-indigo-600 hover:bg-indigo-700"}`,children:Ke?"Saving...":"Save Members"})]})]})}),d&&r.jsx("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-[60] p-4",children:r.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-lg max-h-[85vh] overflow-hidden flex flex-col",children:[r.jsxs("div",{className:"p-6 border-b flex items-center justify-between",children:[r.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Select Labels"}),r.jsx("button",{onClick:()=>u(!1),className:"text-gray-500 hover:text-gray-700",children:r.jsx(vt,{size:24})})]}),r.jsx("div",{className:"p-6 flex-1 overflow-y-auto space-y-8",children:P?r.jsx("div",{className:"text-center py-10 text-gray-500",children:"Loading labels..."}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx("button",{type:"button",onClick:()=>void bt("country"),className:`px-3 py-1.5 rounded-md text-sm font-bold border transition ${R==="country"?"bg-[#8f53c6] text-white border-[#8f53c6]":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:"Country"}),r.jsx("button",{type:"button",onClick:()=>void bt("intake"),className:`px-3 py-1.5 rounded-md text-sm font-bold border transition ${R==="intake"?"bg-[#f2b205] text-[#4a2b00] border-[#f2b205]":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:"Intake"}),r.jsx("button",{type:"button",onClick:()=>void bt("serviceArea"),className:`px-3 py-1.5 rounded-md text-sm font-bold border transition ${R==="serviceArea"?"bg-[#d63a3a] text-white border-[#d63a3a]":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:"Service Area"})]}),R==="country"?r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Country (multi-select)"}),r.jsx("div",{className:"max-h-64 overflow-y-auto border border-gray-200 rounded-lg divide-y",children:k.length===0?r.jsx("div",{className:"px-4 py-6 text-sm text-gray-500 text-center",children:"No countries found"}):k.map(c=>{const y=f.includes(c.id);return r.jsxs("label",{className:"flex items-center gap-3 px-4 py-2.5 hover:bg-gray-50 cursor-pointer",children:[r.jsx("input",{type:"checkbox",checked:y,onChange:()=>rn(c.id,h),className:"h-4 w-4 rounded text-indigo-600"}),r.jsx("span",{className:"text-sm text-gray-800",children:c.name})]},c.id)})})]}):R==="intake"?r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Intake / Semester"}),r.jsxs("select",{value:m??"",onChange:c=>x(c.target.value?Number(c.target.value):null),className:"w-full px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",children:[r.jsx("option",{value:"",children:"Select an intake"}),M.map(c=>r.jsx("option",{value:c.id,children:c.name},c.id))]})]}):r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-2",children:"Service Area (multi-select)"}),r.jsx("div",{className:"max-h-64 overflow-y-auto border border-gray-200 rounded-lg divide-y",children:O.length===0?r.jsx("div",{className:"px-4 py-6 text-sm text-gray-500 text-center",children:"No service areas found"}):O.map(c=>{const y=N.includes(c.id);return r.jsxs("label",{className:"flex items-center gap-3 px-4 py-2.5 hover:bg-gray-50 cursor-pointer",children:[r.jsx("input",{type:"checkbox",checked:y,onChange:()=>rn(c.id,v),className:"h-4 w-4 rounded text-indigo-600"}),r.jsx("span",{className:"text-sm text-gray-800",children:c.name})]},c.id)})})]})]})}),r.jsxs("div",{className:"p-5 border-t flex justify-end gap-4",children:[r.jsx("button",{onClick:()=>u(!1),className:"px-6 py-2.5 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:"Cancel"}),r.jsx("button",{onClick:it,className:"px-6 py-2.5 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 font-bold",children:"Save"})]})]})})]})}function Ha({card:e,onClick:t,labelBadges:n=[],dragDisabled:s=!1}){const{setNodeRef:a,attributes:l,listeners:d,transform:u,transition:f}=us({id:e.id,disabled:s}),h={transform:wt.Transform.toString(u),transition:f},x=`${e.invoice||`ID-${e.id}`} ${e.first_name||""} ${e.last_name||""}`.trim(),N=n.filter(v=>v.kind==="country"||v.kind==="intake");return r.jsxs("div",{ref:a,style:h,...l,...d,onClick:()=>t(e),className:`relative bg-white rounded-xl border border-gray-200 px-4 py-4 shadow-sm transition-shadow select-none ${s?"cursor-default":"cursor-pointer hover:shadow-md"}`,children:[r.jsx("button",{className:"absolute right-3 top-3 p-1.5 rounded-md hover:bg-gray-100 shrink-0",children:r.jsx(Or,{size:16,className:"text-gray-600"})}),r.jsxs("div",{className:"min-w-0",children:[r.jsx("div",{className:"pr-9",children:r.jsx("p",{className:"text-sm font-bold text-indigo-700",children:x})}),(N.length>0||e.members&&e.members.length>0)&&r.jsxs("div",{className:"mt-4 flex w-full items-start gap-2",children:[N.length>0?r.jsxs("div",{className:"flex min-w-0 flex-1 flex-wrap items-center gap-1.5",children:[r.jsx(Fr,{size:12,className:"text-gray-500"}),N.map((v,R)=>r.jsx("span",{className:`px-2 py-0.5 rounded-md text-[10px] font-semibold ${v.kind==="country"?"bg-[#8f53c6] text-white":"bg-[#f2b205] text-[#4a2b00]"}`,children:v.name},`${v.kind}-${v.name}-${R}`))]}):r.jsx("div",{className:"flex-1"}),e.members&&e.members.length>0?r.jsxs("div",{className:"ml-auto -mr-1 flex shrink-0 flex-row-reverse items-center justify-end -space-x-1 space-x-reverse",children:[e.members.slice(0,3).map((v,R)=>r.jsx("div",{className:`h-5 w-5 rounded-full border border-white text-white text-[9px] font-semibold flex items-center justify-center ${Tr[(v.id+R)%Tr.length]}`,title:`${v.first_name||""} ${v.last_name||""}`.trim()||"Member",children:Va(v)},`card-${e.id}-member-${v.id}`)),e.members.length>3&&r.jsxs("div",{className:"mr-1 text-[10px] font-semibold text-gray-500",children:["+",e.members.length-3]})]}):null]})]})]})}function Ya({list:e,children:t,dragDisabled:n=!1}){const{setNodeRef:s,transform:a,transition:l,attributes:d,listeners:u,isDragging:f}=us({id:`list-${e.id}`,disabled:{draggable:n,droppable:!1},transition:{duration:180,easing:"cubic-bezier(0.2, 0, 0, 1)"}}),h={transform:wt.Transform.toString(a),transition:l},m=n?{}:{...d,...u};return r.jsx("div",{ref:s,style:h,className:`w-80 bg-white rounded-xl border border-gray-200 shadow-md flex flex-col min-h-[120px] will-change-transform ${f?"opacity-35":""}`,children:typeof t=="function"?t({dragHandleProps:m,isDragging:f}):t})}function io(){const{boardId:e}=Cs(),t=Ss(),[n,s]=o.useState(null),[a,l]=o.useState(!0),[d,u]=o.useState(null),[f,h]=o.useState(null),[m,x]=o.useState(null),[N,v]=o.useState(null),[R,j]=o.useState(!1),[k,I]=o.useState(""),[M,E]=o.useState(0),[O,z]=o.useState(null),[P,A]=o.useState(""),[L,B]=o.useState(""),[H,F]=o.useState(""),[me,de]=o.useState(null),[je,We]=o.useState(""),[Ye,re]=o.useState(null),[Me,se]=o.useState(""),[nt,Le]=o.useState(null),[J,xe]=o.useState(!1),[qe,Ie]=o.useState(!1),[ie,Ve]=o.useState(!1),[pe,ue]=o.useState(!1),[$,$e]=o.useState("all"),[oe,ct]=o.useState([]),[ke,Xe]=o.useState(!1),[Ce,_t]=o.useState(null),[rt,ht]=o.useState([]),[be,st]=o.useState(!1),[dt,Nt]=o.useState(null),[Te,Rt]=o.useState([]),[Ge,Je]=o.useState([]),[De,Oe]=o.useState([]),[ze,Pe]=o.useState("all"),[Ke,gt]=o.useState(null),[mt,jt]=o.useState([]),[Ct,Lt]=o.useState([]),[St,Et]=o.useState([]),[xt,It]=o.useState({}),[te,le]=o.useState({}),[ee,fe]=o.useState({}),he=o.useRef(null),ge=o.useRef(null),Se=o.useRef(null),Qe=o.useRef(null),Y=o.useRef(null),Ae=o.useRef(null),[_e,Fe]=o.useState(!1),Re=o.useDeferredValue(Me.trim().toLowerCase()),q=Re.length>0,Be=Re==="*",Q=Te.length>0||Ge.length>0||De.length>0||ze!=="all",pt=Be||Q,$t=(i,g)=>{g(p=>p.includes(i)?p.filter(b=>b!==i):[...p,i])},bt=(i,g,p)=>{if(i.length===0)return p;const b=g.filter(w=>i.includes(w.id)).map(w=>w.name);return b.length===0?`${i.length} selected`:b.length<=2?b.join(", "):`${b.slice(0,2).join(", ")} +${b.length-2}`},rn=ci(li(hr,{activationConstraint:{distance:2}})),it=async()=>{try{const i=await W.get(`/boards/${e}`,{params:{with:"lists.cards"}}),g=i.data.data||i.data;g.lists=[...g.lists||[]].sort((p,b)=>p.position-b.position),g.lists.forEach(p=>{p.cards=[...p.cards||[]].sort((b,w)=>b.position-w.position)}),s(g)}catch(i){console.error("Fetch board failed",i)}},_n=async()=>{if(e){st(!0);try{const i=await W.get(`/boards/${e}/archived-cards`);ht(Array.isArray(i.data)?i.data:[])}catch(i){console.error("Fetch archived cards failed",i),alert("Could not load archived cards.")}finally{st(!1)}}},sn=async()=>{Ie(!0),await _n()},Rn=async(i=$)=>{var g;if(e){Xe(!0);try{const p=await W.get(`/boards/${e}/activities`,{params:{tab:i,limit:300}}),b=Array.isArray((g=p.data)==null?void 0:g.data)?p.data.data:Array.isArray(p.data)?p.data:[];ct(b)}catch(p){console.error("Fetch board activities failed",p),alert("Could not load board activities.")}finally{Xe(!1)}}},En=()=>{Ve(!0)},Mn=async i=>{Nt(i);try{await W.put(`/cards/${i}/archive`,{is_archived:!1}),ht(g=>g.filter(p=>p.id!==i)),await it()}catch(g){console.error("Restore archived card failed",g),alert("Could not restore card.")}finally{Nt(null)}};o.useEffect(()=>{(async()=>{l(!0);try{const[,g]=await Promise.all([it(),ks()]);u(g)}finally{l(!1)}})()},[e]),o.useEffect(()=>{(async()=>{try{const[g,p,b]=await Promise.all([W.get("/country-labels"),W.get("/intake-labels"),W.get("/service-areas")]),w=ne=>Array.isArray(ne==null?void 0:ne.data)?ne.data:Array.isArray(ne)?ne:[],_=w(g.data),we=w(p.data),ce=w(b.data);jt(_),Lt(we),Et(ce),It(_.reduce((ne,ae)=>(ne[ae.id]=ae.name,ne),{})),le(we.reduce((ne,ae)=>(ne[ae.id]=ae.name,ne),{})),fe(ce.reduce((ne,ae)=>(ne[ae.id]=ae.name,ne),{}))}catch(g){console.error("Failed to load label maps",g)}})()},[]),o.useEffect(()=>{const i=()=>{window.setTimeout(()=>{var b,w;(b=ge.current)==null||b.focus(),(w=ge.current)==null||w.select()},0)},g=b=>{if(!(b instanceof HTMLElement))return!1;const w=b.tagName.toLowerCase();return w==="input"||w==="textarea"||w==="select"||b.isContentEditable},p=b=>{var we,ce;const w=b.key.toLowerCase(),_=g(b.target);if((b.ctrlKey||b.metaKey)&&w==="k"){b.preventDefault(),(we=he.current)==null||we.focus(),(ce=he.current)==null||ce.select();return}if(b.key==="Escape"&&document.activeElement===he.current){se("");return}if(b.key==="Escape"&&ie){Ve(!1);return}if(b.key==="Escape"&&J){xe(!1);return}if(b.key==="Escape"&&pe){ue(!1);return}if(!(b.ctrlKey||b.metaKey||b.altKey)){if(!_&&w==="f"){b.preventDefault(),xe(!0),i();return}if(b.key==="*"||b.code==="NumpadMultiply"){if(_&&document.activeElement!==ge.current)return;b.preventDefault(),xe(!0),se("*"),i()}}};return window.addEventListener("keydown",p),()=>window.removeEventListener("keydown",p)},[ie,J,pe]),o.useEffect(()=>{if(!J)return;const i=g=>{Se.current&&(Se.current.contains(g.target)||xe(!1))};return document.addEventListener("mousedown",i),()=>document.removeEventListener("mousedown",i)},[J]),o.useEffect(()=>{J||gt(null)},[J]),o.useEffect(()=>{if(!pe)return;const i=g=>{Qe.current&&(Qe.current.contains(g.target)||ue(!1))};return document.addEventListener("mousedown",i),()=>document.removeEventListener("mousedown",i)},[pe]),o.useEffect(()=>{ie&&Rn($)},[ie,$,e]),o.useEffect(()=>{if(!_e)return;const i=p=>{const b=Ae.current,w=Y.current;if(!b||!w)return;const _=p.clientX-b.x;w.scrollLeft=b.scrollLeft-_},g=()=>{Fe(!1),Ae.current=null};return window.addEventListener("mousemove",i),window.addEventListener("mouseup",g),()=>{window.removeEventListener("mousemove",i),window.removeEventListener("mouseup",g)}},[_e]);const Ln=i=>{if(!n)return"Unknown";const g=n.lists.find(p=>p.id===i.board_list_id);return(g==null?void 0:g.title)||"Unknown"},In=i=>{const g=[];return(Array.isArray(i.country_label_ids)&&i.country_label_ids.length>0?i.country_label_ids:i.country_label_id!=null?[i.country_label_id]:[]).forEach(w=>{g.push({name:xt[w]||`Country #${w}`,kind:"country"})}),i.intake_label_id!=null&&g.push({name:te[i.intake_label_id]||`Intake #${i.intake_label_id}`,kind:"intake"}),(Array.isArray(i.service_area_ids)&&i.service_area_ids.length>0?i.service_area_ids:i.service_area_id!=null?[i.service_area_id]:[]).forEach(w=>{g.push({name:ee[w]||`Service Area #${w}`,kind:"serviceArea"})}),g},$n=i=>{var w;const g=i.card;if(!g)return i.card_id?`Card #${i.card_id}`:"Card";const p=`${g.first_name||""} ${g.last_name||""}`.trim(),b=((w=g.invoice)==null?void 0:w.trim())||"";return b&&p?`${b} ${p}`:b||p||`Card #${g.id}`},Tn=i=>{var g,p,b,w,_;return(g=i.list)!=null&&g.title?i.list.title:(b=(p=i.card)==null?void 0:p.boardList)!=null&&b.title?i.card.boardList.title:(_=(w=i.card)==null?void 0:w.board_list)!=null&&_.title?i.card.board_list.title:i.list_id?`List #${i.list_id}`:"Board"},On=/((?:https?:\/\/|www\.)[^\s]+)/gi,zn=i=>/^(?:https?:\/\/|www\.)[^\s]+$/i.test(i),Pn=i=>/^https?:\/\//i.test(i)?i:`https://${i}`,an=i=>{if(!i)return null;const g=i.split(/\r?\n/);return g.map((p,b)=>r.jsxs("span",{children:[p.split(On).map((w,_)=>{if(!w)return null;if(!zn(w))return r.jsx("span",{children:w},`activity-text-${b}-${_}`);const we=w.match(/^(.*?)([.,!?)]*)$/),ce=(we==null?void 0:we[1])||w,ne=(we==null?void 0:we[2])||"";return r.jsxs("span",{children:[r.jsx("a",{href:Pn(ce),target:"_blank",rel:"noopener noreferrer",className:"text-indigo-600 hover:text-indigo-700 underline break-all",children:ce}),ne]},`activity-link-${b}-${_}`)}),b<g.length-1?r.jsx("br",{}):null]},`activity-line-${b}`))},on=async i=>{if(!(!i.attachment_path&&!i.attachment_url))try{_t(i.id);const g=await W.get(`/activities/${i.id}/attachment`,{responseType:"blob"}),p=new Blob([g.data],{type:i.attachment_mime||g.headers["content-type"]||"application/octet-stream"}),b=window.URL.createObjectURL(p),w=document.createElement("a");w.href=b,w.target="_blank",i.attachment_name&&(w.download=i.attachment_name),document.body.appendChild(w),w.click(),w.remove(),window.URL.revokeObjectURL(b)}catch(g){console.error("Open board activity attachment failed",g),alert("Could not open attachment.")}finally{_t(null)}},Wt=async(i,g,p,b)=>{try{await W.post("/activities",{card_id:p??null,list_id:b??null,action:i,details:g})}catch(w){console.error("Failed to log activity:",w)}},c=async()=>{if(!k.trim()||!n)return;const i=n.lists.length+1,g={id:Date.now(),board_id:n.id,title:k.trim(),category:M,position:i,created_at:new Date().toISOString(),updated_at:new Date().toISOString(),cards:[]};s(p=>p?{...p,lists:[...p.lists,g]}:null),I(""),E(0),j(!1);try{const b=(await W.post(`/boards/${n.id}/lists`,{title:g.title,category:g.category??0,position:i})).data.id;await Wt("created list",`List: ${g.title}`,void 0,b),await it()}catch(p){console.error("Create list failed",p),await it()}},y=Number(d==null?void 0:d.role_id)===1,C=Number(d==null?void 0:d.role_id)===1,S=i=>{!y||Ye!==null||(de(i.id),We(i.title))},He=async i=>{if(!n)return;const g=je.trim();if(!g){We(i.title),de(null);return}if(g===i.title){de(null);return}re(i.id);try{await W.put(`/boards/${n.id}/lists/${i.id}`,{title:g}),s(p=>p&&{...p,lists:p.lists.map(b=>b.id===i.id?{...b,title:g}:b)}),de(null)}catch(p){console.error("Update list title failed",p),alert("Could not update list title."),We(i.title)}finally{re(null)}},Ze=async i=>{if(!P.trim()){alert("Invoice is required.");return}const g={invoice:P.trim(),first_name:L.trim()||void 0,last_name:H.trim()||void 0};try{const b=(await W.post(`/board-lists/${i}/cards`,g)).data.id;await Wt("created card",`Card: ${g.invoice} ${g.first_name||""} ${g.last_name||""}`.trim(),b),A(""),B(""),F(""),z(null),await it()}catch(p){console.error("Create card failed",p),alert("Could not create card. Please check invoice uniqueness.")}},ut=()=>{A(""),B(""),F(""),z(null)},Tt=i=>{const g=String(i);if(!g.startsWith("list-"))return null;const p=Number(g.slice(5));return Number.isFinite(p)?p:null},Fn=i=>{if(String(i.active.id).startsWith("list-"))return gi(i);const p=bi(i);return p.length>0?p:hi(i)},fs=i=>{if(!n)return;const g=Tt(i.active.id);if(g!=null){if(!C||q||Q)return;v(g);return}if(v(null),q||Q)return;const p=Number(i.active.id);for(const b of n.lists){const w=b.cards.find(_=>_.id===p);if(w){x(w);break}}},hs=async i=>{var X,Dt;if(x(null),v(null),!n||!i.over)return;const g=Tt(i.active.id),p=Tt(i.over.id);if(g!=null){if(!C||q||Q||p==null||g===p)return;const T=n.lists.find(K=>K.id===g),U=n.lists.find(K=>K.id===p);if(!T||!U)return;const ye=T.category??0,Ue=U.category??0;if(ye!==Ue)return;const at=n.lists.filter(K=>(K.category??0)===ye).sort((K,yt)=>K.position-yt.position),Xt=at.findIndex(K=>K.id===g),Z=at.findIndex(K=>K.id===p);if(Xt<0||Z<0||Xt===Z)return;const un=[...at],[vs]=un.splice(Xt,1);un.splice(Z,0,vs);const yr=un.reduce((K,yt,Ns)=>(K[yt.id]=Ns+1,K),{}),ws={...n,lists:n.lists.map(K=>({...K,cards:K.cards.map(yt=>({...yt}))}))};s({...n,lists:n.lists.map(K=>yr[K.id]!=null?{...K,position:yr[K.id]}:K).sort((K,yt)=>K.position-yt.position)});try{await Promise.all(un.map((K,yt)=>W.put(`/boards/${n.id}/lists/${K.id}`,{position:yt+1}))),await it()}catch(K){console.error("Reorder lists failed",K),s(ws),alert("Could not reorder lists.")}return}if(q||Q)return;const b=Number(i.active.id);if(!Number.isFinite(b))return;const w=n.lists.findIndex(T=>T.cards.some(U=>U.id===b));if(w<0)return;const _=n.lists[w],we=_.cards.findIndex(T=>T.id===b);if(we<0)return;const ce=_.cards[we],ne=String(i.over.id);let ae=-1,Mt=-1;if(ne.startsWith("list-")){const T=Number(ne.replace("list-",""));ae=n.lists.findIndex(U=>U.id===T),ae>=0&&(Mt=n.lists[ae].cards.length)}else{const T=Number(i.over.id);Number.isFinite(T)&&(ae=n.lists.findIndex(U=>U.cards.some(ye=>ye.id===T)),ae>=0&&(Mt=n.lists[ae].cards.findIndex(U=>U.id===T)))}if(ae<0||Mt<0)return;const kt=n.lists[ae],Ot={...n,lists:n.lists.map(T=>({...T,cards:T.cards.map(U=>({...U}))}))};if(_.id===kt.id){const T=_.cards.length-1,U=Math.min(Mt,T);if(we===U)return;const ye=mr(_.cards,we,U).map((Ue,at)=>({...Ue,position:at+1}));s({...n,lists:n.lists.map((Ue,at)=>at===w?{...Ue,cards:ye}:Ue)});try{await Promise.all(ye.map((Ue,at)=>W.put(`/board-lists/${_.id}/cards/${Ue.id}`,{position:at+1}))),await it()}catch(Ue){console.error("Reorder card failed",Ue),s(Ot)}return}const ln=_.category??0,cn=kt.category??0;if(ln!==1&&cn===1&&!ce.payment_done){Le("This card is unpaid. Mark visa payment as done before moving it to Visa.");return}if(ln!==2&&cn===2&&!ce.dependant_payment_done){Le("Dependant payment is pending. Mark dependant payment as done before moving it to Dependant Visa.");return}const ft=n.lists.map(T=>({...T,cards:T.cards.map(U=>({...U}))})),dn=ft[w].cards.filter(T=>T.id!==ce.id),Vt=ft[ae].cards,D=Math.min(Math.max(Mt,0),Vt.length);Vt.splice(D,0,{...ce,board_list_id:kt.id}),ft[w].cards=dn.map((T,U)=>({...T,position:U+1})),ft[ae].cards=Vt.map((T,U)=>({...T,board_list_id:kt.id,position:U+1})),s({...n,lists:ft});try{await W.post("/cards/move",{card_id:ce.id,to_list_id:kt.id,position:D+1})}catch(T){s(Ot);const U=(Dt=(X=T==null?void 0:T.response)==null?void 0:X.data)==null?void 0:Dt.message;typeof U=="string"&&U.toLowerCase().includes("payment")&&Le(U);return}try{const T=ft[w].cards.map((ye,Ue)=>W.put(`/board-lists/${_.id}/cards/${ye.id}`,{position:ye.position??Ue+1})),U=ft[ae].cards.filter(ye=>ye.id!==ce.id).map(ye=>W.put(`/board-lists/${kt.id}/cards/${ye.id}`,{position:ye.position??1}));await Promise.allSettled([...T,...U])}catch(T){console.error("Background card position normalization failed",T)}await it()},{admissionLists:Bn,visaLists:Un,dependantVisaLists:Wn,totalMatchedCards:xr}=o.useMemo(()=>{if(!n)return{admissionLists:[],visaLists:[],dependantVisaLists:[],totalMatchedCards:0};const i=new Date,g=new Date(i.getFullYear(),i.getMonth(),i.getDate()),b=(g.getDay()+6)%7,w=new Date(g);w.setDate(g.getDate()-b);const _=new Date(w);_.setDate(w.getDate()+6);const ce=q&&!(Re==="*"),ne=ce?Re.split(/\s+/).filter(Boolean):[],ae=ne.some(D=>["paid","done","unpaid","pending"].includes(D)),Mt=D=>{if(ze==="all")return!0;const X=Wa(D.due_date);return X?ze==="today"?X.toDateString()===g.toDateString():ze==="this_week"?X>=w&&X<=_:ze==="overdue"?X<g:!0:!1},kt=D=>{const X=Array.isArray(D.country_label_ids)&&D.country_label_ids.length>0?D.country_label_ids:D.country_label_id!=null?[D.country_label_id]:[],Dt=Array.isArray(D.service_area_ids)&&D.service_area_ids.length>0?D.service_area_ids:D.service_area_id!=null?[D.service_area_id]:[];if(Te.length>0&&!X.some(Z=>Te.includes(Z))||Ge.length>0&&(D.intake_label_id==null||!Ge.includes(D.intake_label_id))||De.length>0&&!Dt.some(Z=>De.includes(Z))||!Mt(D))return!1;if(!ce)return!0;const T=X.map(Z=>xt[Z]||"").filter(Boolean).join(" "),U=D.intake_label_id!=null&&te[D.intake_label_id]||"",ye=Dt.map(Z=>ee[Z]||"").filter(Boolean).join(" "),Ue=D.payment_done?"visa payment paid done":"visa payment unpaid pending",at=D.dependant_payment_done?"dependant payment dependant-paid dependant-done":"dependant payment dependant-unpaid dependant-pending",Xt=[D.invoice,D.first_name,D.last_name,D.title,D.description,T,U,ye,Ue,at].filter(Z=>!!Z).join(" ").toLowerCase();return ne.every(Z=>Z==="paid"||Z==="done"?D.payment_done===!0:Z==="unpaid"||Z==="pending"?D.payment_done!==!0:Z==="dependant-paid"||Z==="dependent-paid"||Z==="dependant-done"?D.dependant_payment_done===!0:Z==="dependant-unpaid"||Z==="dependent-unpaid"||Z==="dependant-pending"?D.dependant_payment_done!==!0:Xt.includes(Z))},Ot=D=>D.map(X=>{const Dt=X.cards.length;if(!ce&&!Q)return{...X,cards:[...X.cards],totalCards:Dt,matchedByTitle:!1};const T=ce&&!Q&&!ae&&X.title.toLowerCase().includes(Re),U=X.cards.filter(ye=>kt(ye));return{...X,cards:U,totalCards:Dt,matchedByTitle:T}}).filter(X=>!ce&&!Q?!0:Q?X.cards.length>0:X.matchedByTitle||X.cards.length>0),ln=n.lists.filter(D=>(D.category??0)===0).sort((D,X)=>D.position-X.position),cn=n.lists.filter(D=>D.category===1).sort((D,X)=>D.position-X.position),br=n.lists.filter(D=>D.category===2).sort((D,X)=>D.position-X.position),Kn=Ot(ln),ft=Ot(cn),dn=Ot(br),Vt=[...Kn,...ft,...dn];return{admissionLists:Kn,visaLists:ft,dependantVisaLists:dn,totalMatchedCards:Vt.reduce((D,X)=>D+X.cards.length,0)}},[n,Re,q,Q,ze,Te,Ge,De,xt,te,ee]),Vn=o.useMemo(()=>{if(!n||n.lists.length===0)return null;const i=[...n.lists].filter(g=>(g.category??0)===0).sort((g,p)=>g.position-p.position)[0];return(i==null?void 0:i.id)??null},[n]);if(a)return r.jsx(Ds,{message:"Loading board..."});if(!n)return null;const Xn=(i,g)=>{const p=q||Q,b=C&&!p&&me!==i.id;return r.jsx(Ya,{list:i,dragDisabled:!C||p,children:({dragHandleProps:w})=>r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"p-4 pb-2",children:[r.jsxs("div",{className:`flex justify-between items-center gap-2 mb-3 ${b?"cursor-grab active:cursor-grabbing select-none touch-none":""}`,...b?w:{},title:b?"Drag to reorder list":void 0,children:[me===i.id?r.jsx("input",{autoFocus:!0,value:je,onChange:_=>We(_.target.value),onBlur:()=>void He(i),onKeyDown:_=>{_.key==="Enter"&&(_.preventDefault(),He(i)),_.key==="Escape"&&(We(i.title),de(null))},disabled:Ye===i.id,className:"h-9 w-full rounded-md border border-indigo-300 bg-white px-3 text-base font-semibold text-gray-900 focus:outline-none focus:ring-2 focus:ring-indigo-400"}):r.jsx("h3",{className:`font-semibold text-lg truncate ${y?"cursor-text hover:underline underline-offset-4":""} ${q&&i.matchedByTitle?"text-indigo-700":""}`,onDoubleClick:()=>S(i),title:y?"Double-click to edit list title":void 0,children:i.title}),r.jsx("div",{className:"flex items-center gap-2 shrink-0",children:pt&&r.jsxs("span",{className:"px-2 py-0.5 rounded-full bg-indigo-50 text-indigo-700 text-xs font-semibold whitespace-nowrap",children:[i.cards.length," ",i.cards.length===1?"card":"cards"," match"]})})]}),r.jsx(mn,{items:i.cards.map(_=>_.id),strategy:Ia,children:r.jsx("div",{className:"max-h-[calc(100vh-320px)] overflow-y-auto pr-1",children:r.jsx("div",{className:"space-y-3",children:i.cards.map(_=>r.jsx(Ha,{card:_,onClick:()=>h(_),labelBadges:In(_),dragDisabled:q||Q},_.id))})})})]}),g?r.jsx("div",{className:"p-3 pt-0",children:O===i.id?r.jsxs("div",{className:"bg-white rounded-lg border p-3 shadow-sm",children:[r.jsx("input",{value:P,onChange:_=>A(_.target.value),placeholder:"Invoice",className:"w-full border rounded-md px-3 py-2 text-sm focus:ring-2 focus:ring-indigo-400 outline-none mb-3"}),r.jsxs("div",{className:"grid grid-cols-2 gap-2 mb-3",children:[r.jsx("input",{value:L,onChange:_=>B(_.target.value),placeholder:"First name",className:"w-full border rounded-md px-3 py-2 text-sm focus:ring-2 focus:ring-indigo-400 outline-none"}),r.jsx("input",{value:H,onChange:_=>F(_.target.value),placeholder:"Last name",className:"w-full border rounded-md px-3 py-2 text-sm focus:ring-2 focus:ring-indigo-400 outline-none"})]}),r.jsxs("div",{className:"flex gap-3 mt-4",children:[r.jsx("button",{onClick:()=>Ze(i.id),className:"flex-1 bg-indigo-600 text-white py-2 rounded-md text-sm font-medium",children:"Add card"}),r.jsx("button",{onClick:ut,className:"flex-1 bg-gray-200 text-gray-800 py-2 rounded-md text-sm font-medium hover:bg-gray-300",children:"Cancel"})]})]}):r.jsxs("button",{onClick:()=>z(i.id),className:"w-full flex items-center gap-2 text-gray-600 hover:bg-gray-100 rounded-lg px-2 py-2 text-sm",children:[r.jsx(pn,{size:16})," Add a card"]})}):r.jsx("div",{className:"h-12"})]})},i.id)},pr=N!=null&&n.lists.find(i=>i.id===N)||null,gs=i=>{const g=i.cards.slice(0,3);return r.jsx("div",{className:"w-80 rounded-xl border border-gray-200 bg-white/95 backdrop-blur-sm shadow-2xl rotate-[1.2deg]",children:r.jsxs("div",{className:"p-4 pb-2",children:[r.jsx("h3",{className:"font-semibold text-lg text-gray-900 truncate",children:i.title}),r.jsx("div",{className:"mt-3 space-y-3",children:g.length===0?r.jsx("div",{className:"h-14 rounded-lg border border-dashed border-gray-300 bg-gray-50"}):g.map(p=>{const b=`${p.invoice||`ID-${p.id}`} ${p.first_name||""} ${p.last_name||""}`.trim();return r.jsxs("div",{className:"rounded-lg border border-gray-200 bg-white px-3 py-2",children:[r.jsx("p",{className:"text-sm font-semibold text-indigo-700 truncate",children:b}),r.jsx("p",{className:"text-xs text-gray-500 mt-1",children:Pt(p.created_at)})]},`overlay-card-${p.id}`)})})]})})},ms=i=>{const g=Y.current;if(!g||!(g.scrollWidth>g.clientWidth))return;const b=g.scrollHeight>g.clientHeight;if(!i.shiftKey&&b)return;const w=i.deltaX!==0?i.deltaX:i.deltaY;w!==0&&(g.scrollLeft+=w,i.preventDefault())},xs=i=>!(!(i instanceof HTMLElement)||i.closest("button, a, input, textarea, select, label, [role='button'], [role='dialog'], [contenteditable='true']")),ps=i=>{if(i.button!==0||!xs(i.target))return;const g=Y.current;g&&(Ae.current={x:i.clientX,scrollLeft:g.scrollLeft},Fe(!0))},bs=()=>{ue(!1),t("/profile")},ys=()=>{ue(!1),sessionStorage.removeItem("token"),sessionStorage.removeItem("role_id"),sessionStorage.removeItem("panel_permission"),sessionStorage.removeItem("user"),sessionStorage.removeItem("auth"),localStorage.removeItem("token"),localStorage.removeItem("user"),t("/signin")};return r.jsxs("div",{className:"h-screen flex flex-col bg-gray-50 overflow-hidden",children:[r.jsxs("header",{className:"h-14 bg-white border-b shadow-sm flex items-center justify-between px-4 gap-4",children:[r.jsx("div",{className:"flex items-center gap-4",children:r.jsx("button",{type:"button",onClick:()=>t("/"),className:"h-7 flex items-center cursor-pointer",title:"Go to home",children:r.jsx("img",{src:"/images/logo/connected_logo.png",alt:"Connected Logo",className:"h-7 w-auto object-contain"})})}),r.jsx("div",{className:"flex-1 max-w-2xl mx-6",children:r.jsxs("div",{className:"relative",children:[r.jsx(As,{size:15,className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 pointer-events-none"}),r.jsx("input",{ref:he,value:Me,onChange:i=>se(i.target.value),placeholder:"Search cards, invoice, student, list title (Ctrl+K)",className:"w-full h-9 pl-9 pr-9 rounded-lg bg-gray-100 border text-sm focus:ring-2 focus:ring-indigo-400/40 outline-none"}),Me&&r.jsx("button",{type:"button",onClick:()=>{var i;se(""),(i=he.current)==null||i.focus()},className:"absolute right-2.5 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600","aria-label":"Clear search",children:r.jsx(vt,{size:14})})]})}),r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsxs("div",{className:"relative",ref:Se,children:[r.jsxs("button",{type:"button",onClick:()=>xe(i=>!i),className:`flex items-center gap-1.5 px-3 py-1.5 border rounded-lg text-sm font-medium transition ${Q?"bg-indigo-50 border-indigo-300 text-indigo-700":"bg-white border-gray-300 text-gray-700 hover:bg-gray-50"}`,children:[r.jsx(Fs,{size:15}),"Filter"]}),J&&r.jsxs("div",{className:"absolute right-0 mt-2 w-80 rounded-xl border border-gray-200 bg-white shadow-xl p-4 z-50 space-y-3",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("p",{className:"text-sm font-semibold text-gray-800",children:"Card Filters"}),r.jsx("button",{type:"button",onClick:()=>{se(""),Rt([]),Je([]),Oe([]),Pe("all"),gt(null)},className:"text-xs text-indigo-600 hover:text-indigo-800 font-medium",children:"Reset"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Search"}),r.jsx("input",{ref:ge,value:Me,onChange:i=>se(i.target.value),placeholder:"Type to filter cards, use * for all cards",className:"h-9 w-full rounded-md border border-gray-300 px-2.5 text-sm text-gray-800 focus:outline-none focus:ring-2 focus:ring-indigo-300"})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:["Country (",Te.length,")"]}),r.jsxs("div",{className:"relative",children:[r.jsxs("button",{type:"button",onClick:()=>gt(i=>i==="country"?null:"country"),className:"h-9 w-full rounded-md border border-gray-300 px-2.5 text-sm focus:outline-none focus:ring-2 focus:ring-indigo-300 bg-white text-gray-800 flex items-center justify-between",children:[r.jsx("span",{className:"truncate text-left",children:bt(Te,mt,"Select")}),r.jsx(Hn,{size:15,className:`text-gray-500 transition-transform ${Ke==="country"?"rotate-180":""}`})]}),Ke==="country"&&r.jsx("div",{className:"absolute left-0 right-0 top-full mt-1 max-h-40 overflow-y-auto rounded-md border border-gray-300 bg-white shadow-lg z-50",children:mt.length===0?r.jsx("div",{className:"px-2.5 py-2 text-xs text-gray-500",children:"No options"}):mt.map(i=>r.jsxs("label",{className:"flex items-center gap-2 px-2.5 py-1.5 text-sm text-gray-800 hover:bg-gray-50 cursor-pointer",children:[r.jsx("input",{type:"checkbox",checked:Te.includes(i.id),onChange:()=>$t(i.id,Rt),className:"h-3.5 w-3.5 rounded text-indigo-600"}),r.jsx("span",{children:i.name})]},`country-filter-${i.id}`))})]})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:["Intake (",Ge.length,")"]}),r.jsxs("div",{className:"relative",children:[r.jsxs("button",{type:"button",onClick:()=>gt(i=>i==="intake"?null:"intake"),className:"h-9 w-full rounded-md border border-gray-300 px-2.5 text-sm focus:outline-none focus:ring-2 focus:ring-indigo-300 bg-white text-gray-800 flex items-center justify-between",children:[r.jsx("span",{className:"truncate text-left",children:bt(Ge,Ct,"Select")}),r.jsx(Hn,{size:15,className:`text-gray-500 transition-transform ${Ke==="intake"?"rotate-180":""}`})]}),Ke==="intake"&&r.jsx("div",{className:"absolute left-0 right-0 top-full mt-1 max-h-40 overflow-y-auto rounded-md border border-gray-300 bg-white shadow-lg z-50",children:Ct.length===0?r.jsx("div",{className:"px-2.5 py-2 text-xs text-gray-500",children:"No options"}):Ct.map(i=>r.jsxs("label",{className:"flex items-center gap-2 px-2.5 py-1.5 text-sm text-gray-800 hover:bg-gray-50 cursor-pointer",children:[r.jsx("input",{type:"checkbox",checked:Ge.includes(i.id),onChange:()=>$t(i.id,Je),className:"h-3.5 w-3.5 rounded text-indigo-600"}),r.jsx("span",{children:i.name})]},`intake-filter-${i.id}`))})]})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:["Service (",De.length,")"]}),r.jsx("div",{className:"max-h-28 overflow-y-auto rounded-md border border-gray-300 bg-white",children:St.length===0?r.jsx("div",{className:"px-2.5 py-2 text-xs text-gray-500",children:"No options"}):St.map(i=>r.jsxs("label",{className:"flex items-center gap-2 px-2.5 py-1.5 text-sm text-gray-800 hover:bg-gray-50 cursor-pointer",children:[r.jsx("input",{type:"checkbox",checked:De.includes(i.id),onChange:()=>$t(i.id,Oe),className:"h-3.5 w-3.5 rounded text-indigo-600"}),r.jsx("span",{children:i.name})]},`service-filter-${i.id}`))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Due Date"}),r.jsxs("select",{value:ze,onChange:i=>Pe(i.target.value),className:"h-9 w-full rounded-md border border-gray-300 px-2.5 text-sm text-gray-800 focus:outline-none focus:ring-2 focus:ring-indigo-300",children:[r.jsx("option",{value:"all",children:"Select"}),r.jsx("option",{value:"this_week",children:"This Week"}),r.jsx("option",{value:"today",children:"Today"}),r.jsx("option",{value:"overdue",children:"Overdue"})]})]}),pt&&r.jsxs("div",{className:"pt-1 text-xs font-medium text-gray-600",children:[xr," ",xr===1?"card":"cards"," match current filters"]})]})]}),r.jsxs("button",{type:"button",onClick:En,className:`flex items-center gap-1.5 px-3 py-1.5 border rounded-lg text-sm font-medium transition ${ie?"bg-indigo-50 border-indigo-300 text-indigo-700":"bg-white border-gray-300 text-gray-700 hover:bg-gray-50"}`,children:[r.jsx(vr,{size:15}),"Activity"]}),r.jsxs("button",{type:"button",onClick:()=>void sn(),className:"flex items-center gap-1.5 px-3 py-1.5 border border-gray-300 bg-white rounded-lg text-sm font-medium text-gray-700 hover:bg-gray-50 transition",children:[r.jsx(zr,{size:15}),"Archived"]}),r.jsxs("button",{onClick:()=>j(!0),className:"flex items-center gap-1.5 px-4 py-1.5 bg-gradient-to-r from-indigo-600 to-blue-600 text-white text-sm rounded-lg shadow-md",children:[r.jsx(pn,{size:16})," New List"]}),r.jsxs("div",{className:"relative",ref:Qe,children:[r.jsxs("button",{type:"button",onClick:()=>ue(i=>!i),className:"h-8 px-3 rounded-full bg-gradient-to-r from-blue-600 to-indigo-600 text-white text-sm font-semibold flex items-center justify-center gap-1.5 shadow-sm hover:opacity-95",title:"Open user menu","aria-expanded":pe,"aria-haspopup":"menu",children:[(d==null?void 0:d.first_name)||"User",r.jsx(Hn,{size:14,className:`transition-transform ${pe?"rotate-180":""}`})]}),pe&&r.jsxs("div",{className:"absolute right-0 mt-2 w-44 rounded-lg border border-gray-200 bg-white py-1.5 shadow-lg z-40",children:[r.jsx("button",{type:"button",onClick:bs,className:"w-full px-3 py-2 text-left text-sm text-gray-700 hover:bg-gray-50",children:"Profile Settings"}),r.jsx("button",{type:"button",onClick:ys,className:"w-full px-3 py-2 text-left text-sm text-red-600 hover:bg-red-50",children:"Logout"})]})]})]})]}),r.jsxs("main",{className:"flex-1 flex flex-col overflow-hidden bg-gradient-to-br from-indigo-50 via-purple-50 to-pink-50 rounded-xl shadow-inner m-4",children:[r.jsx("div",{className:"h-16 bg-gradient-to-r from-purple-700 via-indigo-700 to-purple-800 text-white flex items-center justify-between px-6 rounded-t-xl",children:r.jsxs("div",{className:"flex items-center gap-4",children:[r.jsx(_s,{size:20}),r.jsx("h1",{className:"text-xl font-bold",children:n.name})]})}),r.jsxs(da,{sensors:rn,collisionDetection:Fn,onDragStart:fs,onDragEnd:hs,children:[r.jsx("div",{ref:Y,onWheel:ms,onMouseDown:ps,className:"flex-1 min-h-0 overflow-x-auto overflow-y-auto",children:r.jsxs("div",{className:"min-h-full p-6 flex gap-6 min-w-max",children:[r.jsxs("div",{className:"min-h-0 flex gap-6",children:[r.jsxs("div",{className:"min-w-[420px] flex flex-col gap-3",children:[r.jsx("div",{className:"inline-flex items-center gap-2 px-3 py-1 rounded-full bg-emerald-100 text-emerald-800 text-xs font-semibold uppercase tracking-wide",children:"Admission"}),r.jsx("div",{className:"flex-1",children:r.jsx(mn,{items:Bn.map(i=>`list-${i.id}`),strategy:Qn,children:r.jsx("div",{className:"flex gap-6 min-w-max items-start pb-2 pr-2",children:Bn.length>0?Bn.map(i=>Xn(i,i.id===Vn)):r.jsx("div",{className:"w-80 h-28 rounded-xl border border-dashed border-emerald-300 bg-emerald-50/50 text-emerald-800 text-sm flex items-center justify-center",children:q||Q?"No matching cards in admission":"No admission lists"})})})})]}),r.jsx("div",{className:"self-stretch border-l-2 border-dotted border-indigo-300/70"}),r.jsxs("div",{className:"min-w-[420px] flex flex-col gap-3",children:[r.jsx("div",{className:"inline-flex items-center gap-2 px-3 py-1 rounded-full bg-amber-100 text-amber-800 text-xs font-semibold uppercase tracking-wide",children:"Visa"}),r.jsx("div",{className:"flex-1",children:r.jsx(mn,{items:Un.map(i=>`list-${i.id}`),strategy:Qn,children:r.jsx("div",{className:"flex gap-6 min-w-max items-start pb-2 pr-2",children:Un.length>0?Un.map(i=>Xn(i,i.id===Vn)):r.jsx("div",{className:"w-80 h-28 rounded-xl border border-dashed border-amber-300 bg-amber-50/50 text-amber-800 text-sm flex items-center justify-center",children:q||Q?"No matching cards in visa":"No visa lists"})})})})]}),r.jsx("div",{className:"self-stretch border-l-2 border-dotted border-indigo-300/70"}),r.jsxs("div",{className:"min-w-[420px] flex flex-col gap-3",children:[r.jsx("div",{className:"inline-flex items-center gap-2 px-3 py-1 rounded-full bg-rose-100 text-rose-800 text-xs font-semibold uppercase tracking-wide",children:"Dependant Visa"}),r.jsx("div",{className:"flex-1",children:r.jsx(mn,{items:Wn.map(i=>`list-${i.id}`),strategy:Qn,children:r.jsx("div",{className:"flex gap-6 min-w-max items-start pb-2 pr-2",children:Wn.length>0?Wn.map(i=>Xn(i,i.id===Vn)):r.jsx("div",{className:"w-80 h-28 rounded-xl border border-dashed border-rose-300 bg-rose-50/50 text-rose-800 text-sm flex items-center justify-center",children:q||Q?"No matching cards in dependant visa":"No dependant visa lists"})})})})]})]}),R&&r.jsx("div",{className:"w-80 shrink-0 self-start",children:r.jsxs("div",{className:"bg-white rounded-xl p-4 border shadow-md",children:[r.jsxs("div",{className:"grid grid-cols-3 gap-2 mb-3",children:[r.jsx("button",{type:"button",onClick:()=>E(0),className:`h-9 rounded-md text-sm font-semibold border transition ${M===0?"bg-emerald-600 text-white border-emerald-600":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:"Admission"}),r.jsx("button",{type:"button",onClick:()=>E(1),className:`h-9 rounded-md text-sm font-semibold border transition ${M===1?"bg-amber-600 text-white border-amber-600":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:"Visa"}),r.jsx("button",{type:"button",onClick:()=>E(2),className:`h-9 rounded-md text-sm font-semibold border transition ${M===2?"bg-rose-600 text-white border-rose-600":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:"Dependant"})]}),r.jsx("input",{autoFocus:!0,value:k,onChange:i=>I(i.target.value),placeholder:"Enter list title...",className:"w-full border rounded-md px-3 py-2 text-sm"}),r.jsxs("div",{className:"flex gap-3 mt-3",children:[r.jsx("button",{onClick:c,className:"bg-indigo-600 text-white px-4 py-1.5 rounded-md",children:"Add list"}),r.jsx("button",{onClick:()=>{j(!1),I(""),E(0)},className:"text-sm text-gray-600 hover:underline",children:"Cancel"})]})]})})]})}),r.jsx(_a,{children:m?r.jsxs("div",{className:"w-80 bg-white rounded-xl p-3 shadow-2xl border border-gray-200",children:[r.jsxs("p",{className:"text-sm font-bold text-indigo-700",children:[m.invoice||`ID-${m.id}`," ",m.first_name||""," ",m.last_name||""]}),r.jsx("p",{className:"text-xs text-gray-500 mt-1",children:Pt(m.created_at)})]}):pr?gs(pr):null})]}),f&&r.jsx(Ka,{card:f,listTitle:Ln(f),profile:d,onClose:()=>h(null),setSelectedCard:h,fetchBoard:it}),qe&&r.jsx("div",{className:"fixed inset-0 z-[70] bg-black/50 flex items-center justify-center p-4",children:r.jsxs("div",{className:"w-full max-w-3xl bg-white rounded-2xl shadow-2xl border border-gray-200 overflow-hidden",children:[r.jsxs("div",{className:"flex items-center justify-between px-5 py-4 border-b bg-gray-50",children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Archived Cards"}),r.jsx("button",{onClick:()=>Ie(!1),className:"h-8 w-8 rounded-lg border border-gray-200 bg-white text-gray-600 hover:bg-gray-100 flex items-center justify-center",children:r.jsx(vt,{size:16})})]}),r.jsx("div",{className:"max-h-[60vh] overflow-y-auto p-4",children:be?r.jsx("div",{className:"py-10 text-center text-sm text-gray-500",children:"Loading archived cards..."}):rt.length===0?r.jsx("div",{className:"py-10 text-center text-sm text-gray-500",children:"No archived cards found."}):r.jsx("div",{className:"space-y-3",children:rt.map(i=>{var b,w;const g=((b=i.boardList)==null?void 0:b.title)||((w=i.board_list)==null?void 0:w.title)||"Unknown List",p=`${i.invoice||`ID-${i.id}`} ${i.first_name||""} ${i.last_name||""}`.trim();return r.jsxs("div",{className:"flex items-center justify-between gap-4 rounded-xl border border-gray-200 bg-white p-4",children:[r.jsxs("div",{className:"min-w-0",children:[r.jsx("p",{className:"text-sm font-semibold text-gray-900 truncate",children:p}),r.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[g,"  Archived on ",Pt(i.updated_at)]})]}),r.jsxs("button",{type:"button",onClick:()=>void Mn(i.id),disabled:dt===i.id,className:`inline-flex items-center gap-1.5 px-3 py-1.5 rounded-lg text-sm font-medium border transition ${dt===i.id?"bg-gray-100 text-gray-400 border-gray-200 cursor-not-allowed":"bg-emerald-50 text-emerald-700 border-emerald-200 hover:bg-emerald-100"}`,children:[r.jsx(Ks,{size:14}),dt===i.id?"Restoring...":"Restore"]})]},i.id)})})}),r.jsx("div",{className:"px-5 py-4 border-t bg-gray-50 flex justify-end",children:r.jsx("button",{onClick:()=>Ie(!1),className:"px-4 py-2 rounded-lg bg-indigo-600 text-white text-sm font-medium hover:bg-indigo-700",children:"Close"})})]})}),ie&&r.jsx("div",{className:"fixed inset-0 z-[72] bg-black/50 flex items-center justify-center p-4",children:r.jsxs("div",{className:"w-full max-w-5xl bg-white rounded-2xl shadow-2xl border border-gray-200 overflow-hidden",children:[r.jsxs("div",{className:"flex items-center justify-between px-5 py-4 border-b bg-gray-50",children:[r.jsxs("div",{className:"flex items-center gap-2",children:[r.jsx(vr,{size:18,className:"text-indigo-600"}),r.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Board Activity"})]}),r.jsx("button",{type:"button",onClick:()=>Ve(!1),className:"h-8 w-8 rounded-lg border border-gray-200 bg-white text-gray-600 hover:bg-gray-100 flex items-center justify-center",children:r.jsx(vt,{size:16})})]}),r.jsx("div",{className:"px-5 pt-4 pb-3 border-b bg-white",children:r.jsxs("div",{className:"inline-flex rounded-lg border border-gray-200 bg-gray-50 p-1",children:[r.jsx("button",{type:"button",onClick:()=>$e("all"),className:`px-3 py-1.5 rounded-md text-sm font-medium transition ${$==="all"?"bg-white text-gray-900 shadow-sm border border-gray-200":"text-gray-600 hover:text-gray-800"}`,children:"All"}),r.jsx("button",{type:"button",onClick:()=>$e("comment"),className:`px-3 py-1.5 rounded-md text-sm font-medium transition ${$==="comment"?"bg-white text-gray-900 shadow-sm border border-gray-200":"text-gray-600 hover:text-gray-800"}`,children:"Comment"})]})}),r.jsx("div",{className:"max-h-[65vh] overflow-y-auto px-5 py-4",children:ke?r.jsx("div",{className:"py-12 text-center text-sm text-gray-500",children:"Loading activity..."}):oe.length===0?r.jsxs("div",{className:"py-12 text-center text-sm text-gray-500",children:["No ",$==="comment"?"comments":"activities"," found."]}):r.jsx("div",{className:"space-y-3",children:oe.map(i=>r.jsx("div",{className:"rounded-xl border border-gray-200 bg-white p-4",children:r.jsxs("div",{className:"flex gap-3",children:[r.jsx("div",{className:"h-8 w-8 rounded-full bg-indigo-100 text-indigo-700 text-xs font-semibold flex items-center justify-center shrink-0",children:(i.user_name||"U").charAt(0).toUpperCase()}),r.jsxs("div",{className:"min-w-0 flex-1",children:[r.jsxs("div",{className:"text-sm text-gray-800",children:[r.jsx("strong",{className:"text-gray-900",children:i.user_name||"User"})," ",i.action]}),i.details?r.jsx("div",{className:`mt-1 text-sm leading-relaxed ${i.action==="commented"?"rounded-lg border border-gray-200 bg-gray-50 p-3 text-gray-700":"text-gray-700"}`,children:i.action==="commented"?r.jsxs("div",{className:"flex items-start gap-2",children:[r.jsx(Pr,{size:14,className:"mt-0.5 text-gray-500 shrink-0"}),r.jsx("div",{className:"min-w-0",children:an(i.details)})]}):an(i.details)}):null,r.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-2 text-xs text-gray-500",children:[r.jsx("span",{children:sr(i.created_at)}),i.card_id?r.jsx("span",{className:"px-2 py-0.5 rounded-full bg-indigo-50 text-indigo-700 border border-indigo-100",children:$n(i)}):null,r.jsx("span",{className:"px-2 py-0.5 rounded-full bg-gray-100 text-gray-700 border border-gray-200",children:Tn(i)})]}),(i.attachment_path||i.attachment_url)&&r.jsxs("button",{type:"button",onClick:()=>void on(i),disabled:Ce===i.id,className:`mt-2 inline-flex items-center gap-1 rounded-md border px-2 py-1 text-xs transition ${Ce===i.id?"bg-gray-100 text-gray-400 border-gray-200 cursor-not-allowed":"bg-white text-indigo-700 border-indigo-200 hover:bg-indigo-50"}`,children:[Ce===i.id?"Opening...":i.attachment_name||"Attachment",i.attachment_size?r.jsxs("span",{className:"text-gray-500",children:["(",ir(i.attachment_size),")"]}):null]})]})]})},i.id))})})]})}),nt&&r.jsx("div",{className:"fixed inset-0 z-[70] bg-black/50 flex items-center justify-center p-4",children:r.jsxs("div",{className:"w-full max-w-md bg-white rounded-2xl shadow-2xl border border-gray-200 overflow-hidden",children:[r.jsxs("div",{className:"flex items-center justify-between px-5 py-4 border-b bg-rose-50",children:[r.jsx("h3",{className:"text-lg font-semibold text-rose-800",children:"Move Blocked"}),r.jsx("button",{onClick:()=>Le(null),className:"h-8 w-8 rounded-lg border border-rose-200 bg-white text-rose-600 hover:bg-rose-100 flex items-center justify-center",children:r.jsx(vt,{size:16})})]}),r.jsx("div",{className:"px-5 py-4 text-sm text-gray-700",children:nt}),r.jsx("div",{className:"px-5 py-4 border-t bg-gray-50 flex justify-end",children:r.jsx("button",{onClick:()=>Le(null),className:"px-4 py-2 rounded-lg bg-indigo-600 text-white text-sm font-medium hover:bg-indigo-700",children:"OK"})})]})})]})]})}export{io as default};
