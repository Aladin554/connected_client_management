import{u as C,r as n,j as e,d as N}from"./index-Cq981t_5.js";import{A as F}from"./arrow-left-BI1HadNm.js";import{c as j}from"./createLucideIcon-DDMrqLFZ.js";import{S as L}from"./save-CEjFNOIN.js";/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],z=j("lock",P);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],$=j("mail",A);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],v=j("user",q);function Z(){const o=C(),[s,x]=n.useState({first_name:"",last_name:"",email:"",password:""}),[l,f]=n.useState({}),[b,y]=n.useState(!0),[d,w]=n.useState(!1),[_,g]=n.useState(null);n.useEffect(()=>{(async()=>{try{const a=await N.get("/profile");x({first_name:a.data.first_name||"",last_name:a.data.last_name||"",email:a.data.email||"",password:""})}catch(a){console.error("Failed to fetch profile:",a),g("Could not load profile. Please try again.")}finally{y(!1)}})()},[]);const k=n.useMemo(()=>{var i,t;const r=((i=s.first_name)==null?void 0:i.trim().charAt(0))||"",a=((t=s.last_name)==null?void 0:t.trim().charAt(0))||"";return`${r}${a}`.toUpperCase()||"U"},[s.first_name,s.last_name]),c=(r,a)=>{switch(r){case"first_name":return a.trim()?"":"First name is required";case"last_name":return a.trim()?"":"Last name is required";case"email":return a.trim()?/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i.test(a)?"":"Invalid email address":"Email is required";case"password":return a&&a.length<6?"Password must be at least 6 characters":"";default:return""}},p=r=>{const{name:a,value:i}=r.target;x(t=>({...t,[a]:i})),f(t=>({...t,[a]:c(a,i)})),_&&g(null)},S=()=>{const r={},a=c("first_name",s.first_name||""),i=c("last_name",s.last_name||""),t=c("email",s.email||""),m=c("password",s.password||"");return a&&(r.first_name=a),i&&(r.last_name=i),t&&(r.email=t),m&&(r.password=m),f(r),Object.keys(r).length===0},E=async r=>{var a,i;if(r.preventDefault(),!!S()){w(!0),g(null);try{const t={...s};t.password||delete t.password,await N.put("/profile",t);const m=sessionStorage.getItem("user");if(m)try{const u=JSON.parse(m);u.first_name=t.first_name,u.last_name=t.last_name,u.email=t.email,sessionStorage.setItem("user",JSON.stringify(u))}catch{}o("/",{replace:!0})}catch(t){console.error("Profile update failed:",t),g(((i=(a=t==null?void 0:t.response)==null?void 0:a.data)==null?void 0:i.message)||"Failed to update profile.")}finally{w(!1)}}};return e.jsx("div",{className:"min-h-screen bg-[radial-gradient(circle_at_top,_#e7ecff_0%,_#edf1f8_40%,_#f3f4f6_100%)] px-4 py-8 text-gray-900 md:px-8",children:e.jsxs("div",{className:"mx-auto w-full max-w-4xl",children:[e.jsxs("button",{type:"button",onClick:()=>o("/",{replace:!0}),className:"mb-5 inline-flex items-center gap-2 rounded-lg border border-gray-300 bg-gray-200 px-3 py-2 text-sm font-medium text-gray-900 shadow-sm hover:bg-gray-300",children:[e.jsx(F,{size:16}),"Back To Home"]}),e.jsx("div",{className:"overflow-hidden rounded-3xl border border-gray-300 bg-gray-100 shadow-xl",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-[280px_1fr]",children:[e.jsx("aside",{className:"bg-gradient-to-br from-[#d8dbe8] via-[#cfd6e8] to-[#bcc8de] p-6 text-gray-900 md:p-8",children:e.jsxs("div",{className:"flex flex-col items-start gap-4",children:[e.jsx("div",{className:"grid h-16 w-16 place-items-center rounded-2xl bg-gray-200 text-2xl font-bold text-gray-900",children:k}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm uppercase tracking-wide text-gray-700",children:"Profile Settings"}),e.jsxs("h1",{className:"mt-1 text-2xl font-semibold leading-tight",children:[s.first_name||"Your"," ",s.last_name||"Account"]}),e.jsx("p",{className:"mt-2 text-sm text-gray-800",children:s.email||"No email loaded"})]})]})}),e.jsxs("section",{className:"bg-gray-100 p-6 md:p-8",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Edit Profile"}),e.jsx("p",{className:"mt-1 text-sm text-gray-600",children:"Update your basic account information and optional password."}),_&&e.jsx("div",{className:"mt-4 rounded-lg border border-red-200 bg-red-50 px-3 py-2 text-sm text-red-800",children:_}),b?e.jsx("div",{className:"mt-6 rounded-xl border border-gray-200 bg-gray-50 px-4 py-5 text-sm text-gray-600",children:"Loading profile..."}):e.jsxs("form",{onSubmit:E,className:"mt-6 space-y-5",children:[e.jsxs("div",{className:"grid grid-cols-1 gap-5 md:grid-cols-2",children:[e.jsx(h,{label:"First Name",name:"first_name",value:s.first_name,error:l.first_name,onChange:p,icon:e.jsx(v,{size:16})}),e.jsx(h,{label:"Last Name",name:"last_name",value:s.last_name,error:l.last_name,onChange:p,icon:e.jsx(v,{size:16})})]}),e.jsx(h,{label:"Email",name:"email",type:"email",value:s.email,error:l.email,onChange:p,icon:e.jsx($,{size:16})}),e.jsx(h,{label:"New Password (Optional)",name:"password",type:"password",value:s.password||"",error:l.password,onChange:p,placeholder:"Leave blank to keep current password",icon:e.jsx(z,{size:16})}),e.jsxs("div",{className:"flex flex-col gap-3 pt-2 sm:flex-row",children:[e.jsxs("button",{type:"submit",disabled:d,className:"inline-flex h-11 items-center justify-center gap-2 rounded-xl border border-gray-400 bg-gray-200 px-5 text-sm font-semibold text-gray-800 hover:bg-gray-300 disabled:cursor-not-allowed disabled:bg-gray-700 disabled:text-gray-300",children:[e.jsx(L,{size:16}),d?"Saving...":"Save Changes"]}),e.jsx("button",{type:"button",onClick:()=>o("/",{replace:!0}),className:"h-11 rounded-xl border border-gray-400 bg-gray-200 px-5 text-sm font-semibold text-gray-800 hover:bg-gray-300",children:"Cancel"})]})]})]})]})})]})})}function h({label:o,name:s,value:x,error:l,onChange:f,type:b="text",placeholder:y,icon:d}){return e.jsxs("div",{children:[e.jsx("label",{htmlFor:s,className:"mb-1 block text-sm font-semibold text-gray-800",children:o}),e.jsxs("div",{className:`flex h-11 items-center gap-2 rounded-xl border bg-gray-50 px-3 transition ${l?"border-red-400":"border-gray-300 focus-within:border-[#af4687]"}`,children:[d&&e.jsx("span",{className:"text-gray-500",children:d}),e.jsx("input",{id:s,name:s,type:b,value:x,onChange:f,placeholder:y,className:"w-full border-0 bg-transparent text-sm text-gray-900 placeholder:text-gray-500 outline-none",autoComplete:"off"})]}),l&&e.jsx("p",{className:"mt-1 text-xs text-red-600",children:l})]})}export{Z as default};
